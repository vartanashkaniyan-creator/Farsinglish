<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª XSS Ùˆ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒ - Farsinglish</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Tahoma', 'Vazir', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        .header { background: rgba(255,255,255,0.95); padding: 25px; border-radius: 20px; margin-bottom: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.2); text-align: center; }
        .header h1 { color: #2c3e50; font-size: 28px; margin-bottom: 10px; }
        .header p { color: #34495e; font-size: 16px; }
        .warning-box { background: #fff3cd; border: 2px solid #ffc107; padding: 15px; border-radius: 12px; margin-bottom: 25px; color: #856404; }
        .test-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .test-card { background: white; border-radius: 20px; padding: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); transition: transform 0.3s ease; }
        .test-card:hover { transform: translateY(-5px); }
        .test-card h3 { color: #2c3e50; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #f0f0f0; display: flex; align-items: center; gap: 10px; }
        .test-card h3 .badge { background: #e74c3c; color: white; padding: 5px 10px; border-radius: 20px; font-size: 12px; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; margin-bottom: 8px; color: #34495e; font-weight: bold; }
        .input-group input, .input-group textarea { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 12px; font-size: 14px; transition: all 0.3s; }
        .input-group input:focus, .input-group textarea:focus { border-color: #667eea; outline: none; box-shadow: 0 0 0 3px rgba(102,126,234,0.1); }
        textarea { min-height: 80px; resize: vertical; }
        .btn-group { display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap; }
        .btn { padding: 12px 20px; border: none; border-radius: 12px; font-size: 14px; cursor: pointer; transition: all 0.3s; flex: 1; font-weight: bold; }
        .btn-primary { background: #667eea; color: white; }
        .btn-primary:hover { background: #5a67d8; transform: scale(1.02); }
        .btn-danger { background: #e74c3c; color: white; }
        .btn-danger:hover { background: #c0392b; }
        .btn-success { background: #2ecc71; color: white; }
        .btn-success:hover { background: #27ae60; }
        .btn-warning { background: #f39c12; color: white; }
        .btn-warning:hover { background: #e67e22; }
        .result-box { background: #f8f9fa; border-radius: 15px; padding: 15px; margin-top: 20px; }
        .result-box h4 { color: #2c3e50; margin-bottom: 10px; }
        .output { background: white; border: 2px solid #e0e0e0; border-radius: 10px; padding: 15px; min-height: 60px; font-family: monospace; white-space: pre-wrap; word-break: break-all; }
        .sanitized { background: #d4edda; border-color: #c3e6cb; color: #155724; }
        .danger { background: #f8d7da; border-color: #f5c6cb; color: #721c24; }
        .security-tip { background: #d1ecf1; border: 2px solid #bee5eb; border-radius: 12px; padding: 15px; margin-top: 25px; color: #0c5460; }
        .counter { background: #2c3e50; color: white; padding: 5px 10px; border-radius: 20px; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ›¡ï¸ ØªØ³Øª Ø§Ù…Ù†ÛŒØªÛŒ XSS Ùˆ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒ</h1>
            <p>Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø­Ù…Ù„Ø§Øª XSS Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ù…Ú©Ø§Ù†ÛŒØ²Ù…â€ŒÙ‡Ø§ÛŒ Ø¯ÙØ§Ø¹ÛŒ</p>
        </div>

        <div class="warning-box">
            âš ï¸ <strong>Ù‡Ø´Ø¯Ø§Ø±:</strong> Ø§ÛŒÙ† ØµÙØ­Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø§Ù…Ù†ÛŒØªÛŒ Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡. ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø®Ø±Ø¨ ÙÙ‚Ø· Ø¯Ø± Ø§ÛŒÙ† ØµÙØ­Ù‡ ØªØ³Øª Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ Ùˆ Ø¯Ø± Ø³ÛŒØ³ØªÙ… Ø§ØµÙ„ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù†Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ù†Ø¯.
        </div>

        <!-- ØªØ³Øª Ø´Ù…Ø§Ø±Ù‡ 1: XSS Ø¯Ø± ÙˆØ±ÙˆØ¯ÛŒ Ù…ØªÙ† -->
        <div class="test-grid">
            <div class="test-card">
                <h3>
                    <span>ğŸ“ ØªØ³Øª Û±: XSS Ø¯Ø± ÙˆØ±ÙˆØ¯ÛŒ Ù…ØªÙ†</span>
                    <span class="badge">é«˜å±</span>
                </h3>
                <div class="input-group">
                    <label>ÙˆØ±ÙˆØ¯ÛŒ Ú©Ø§Ø±Ø¨Ø± (Ù…ØªÙ†):</label>
                    <input type="text" id="xssInput1" placeholder="Ù…Ø«Ø§Ù„: <script>alert('XSS')</script>" dir="ltr">
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="testXSSBasic()">â–¶ Ø§Ø¬Ø±Ø§ (Ø¨Ø¯ÙˆÙ† ÙÛŒÙ„ØªØ±)</button>
                    <button class="btn btn-success" onclick="testXSSWithSanitize()">ğŸ›¡ï¸ Ø§Ø¬Ø±Ø§ Ø¨Ø§ ÙÛŒÙ„ØªØ±</button>
                    <button class="btn btn-warning" onclick="resetXSSBasic()">ğŸ”„ Ø±ÛŒØ³Øª</button>
                </div>
                <div class="result-box">
                    <h4>Ø®Ø±ÙˆØ¬ÛŒ:</h4>
                    <div class="output" id="xssOutput1">Ù…Ù†ØªØ¸Ø± ÙˆØ±ÙˆØ¯ÛŒ...</div>
                </div>
                <div class="security-tip" style="margin-top: 15px;">
                    ğŸ’¡ ØªØ²Ø±ÛŒÙ‚ <code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code> Ø±Ø§ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯
                </div>
            </div>

            <!-- ØªØ³Øª Ø´Ù…Ø§Ø±Ù‡ 2: XSS Ø¯Ø± Event Handler -->
            <div class="test-card">
                <h3>
                    <span>ğŸ¯ ØªØ³Øª Û²: XSS Ø¯Ø± Event Handler</span>
                    <span class="badge">é«˜å±</span>
                </h3>
                <div class="input-group">
                    <label>ÙˆØ±ÙˆØ¯ÛŒ (Ø­Ù…Ù„Ø§Øª event):</label>
                    <input type="text" id="xssInput2" value='" onmouseover="alert(1)"' dir="ltr">
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="testXSSEvent()">â–¶ ØªØ³Øª ØªØ²Ø±ÛŒÙ‚ event</button>
                    <button class="btn btn-success" onclick="testXSSEventSafe()">ğŸ›¡ï¸ Ù†Ø³Ø®Ù‡ Ø§Ù…Ù†</button>
                </div>
                <div class="result-box">
                    <h4>Ø®Ø±ÙˆØ¬ÛŒ (mouseover):</h4>
                    <div class="output" id="xssOutput2" style="cursor: pointer;">Ù…Ø§ÙˆØ³ Ø±Ø§ Ø­Ø±Ú©Øª Ø¯Ù‡ÛŒØ¯</div>
                </div>
            </div>

            <!-- ØªØ³Øª Ø´Ù…Ø§Ø±Ù‡ 3: XSS Ø¯Ø± URL/Ù„ÛŒÙ†Ú© -->
            <div class="test-card">
                <h3>
                    <span>ğŸ”— ØªØ³Øª Û³: XSS Ø¯Ø± URL</span>
                    <span class="badge">Ù…ØªÙˆØ³Ø·</span>
                </h3>
                <div class="input-group">
                    <label>Ù„ÛŒÙ†Ú© Ù…Ø®Ø±Ø¨:</label>
                    <input type="text" id="xssInput3" value='javascript:alert("XSS")' dir="ltr">
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="testXSSURL()">â–¶ Ø§ÛŒØ¬Ø§Ø¯ Ù„ÛŒÙ†Ú©</button>
                    <button class="btn btn-success" onclick="testXSSURLSafe()">ğŸ›¡ï¸ Ù„ÛŒÙ†Ú© Ø§Ù…Ù†</button>
                </div>
                <div class="result-box">
                    <h4>Ù„ÛŒÙ†Ú© Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù‡:</h4>
                    <div class="output" id="xssOutput3"></div>
                </div>
            </div>

            <!-- ØªØ³Øª Ø´Ù…Ø§Ø±Ù‡ 4: HTML Injection -->
            <div class="test-card">
                <h3>
                    <span>ğŸ·ï¸ ØªØ³Øª Û´: ØªØ²Ø±ÛŒÙ‚ HTML</span>
                    <span class="badge">Ù…ØªÙˆØ³Ø·</span>
                </h3>
                <div class="input-group">
                    <label>HTML Ù…Ø®Ø±Ø¨:</label>
                    <textarea id="xssInput4" dir="ltr">&lt;img src=x onerror=alert('XSS')&gt;</textarea>
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="testHTMLInjection()">â–¶ ØªØ²Ø±ÛŒÙ‚ HTML</button>
                    <button class="btn btn-success" onclick="testHTMLInjectionSafe()">ğŸ›¡ï¸ HTML Ø§Ù…Ù†</button>
                </div>
                <div class="result-box">
                    <h4>Ù†ØªÛŒØ¬Ù‡:</h4>
                    <div class="output" id="xssOutput4"></div>
                </div>
            </div>
        </div>

        <!-- Ø¨Ø®Ø´ Ø¯ÙˆÙ…: ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ -->
        <div class="test-grid">
            <!-- ØªØ³Øª Ø´Ù…Ø§Ø±Ù‡ 5: XSS Ø¯Ø± localStorage -->
            <div class="test-card">
                <h3>
                    <span>ğŸ’¾ ØªØ³Øª Ûµ: XSS Ø¯Ø± localStorage</span>
                    <span class="badge">Ù¾ÛŒØ´Ø±ÙØªÙ‡</span>
                </h3>
                <div class="input-group">
                    <label>Ø¯Ø§Ø¯Ù‡ Ù…Ø®Ø±Ø¨:</label>
                    <input type="text" id="xssInput5" value='&lt;script&gt;alert("Stored XSS")&lt;/script&gt;' dir="ltr">
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="saveToStorage()">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡</button>
                    <button class="btn btn-danger" onclick="loadFromStorage()">ğŸ“¤ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ (Ø®Ø·Ø±Ù†Ø§Ú©)</button>
                    <button class="btn btn-success" onclick="loadFromStorageSafe()">ğŸ›¡ï¸ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ù…Ù†</button>
                </div>
                <div class="result-box">
                    <h4>Ù†ØªÛŒØ¬Ù‡:</h4>
                    <div class="output" id="xssOutput5"></div>
                </div>
            </div>

            <!-- ØªØ³Øª Ø´Ù…Ø§Ø±Ù‡ 6: Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒ -->
            <div class="test-card">
                <h3>
                    <span>âœ… ØªØ³Øª Û¶: Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒ</span>
                    <span class="badge">Ø§Ø³Ø§Ø³ÛŒ</span>
                </h3>
                <div class="input-group">
                    <label>ÙˆØ±ÙˆØ¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ:</label>
                    <input type="text" id="xssInput6" value='<script>alert(1)</script>' dir="ltr">
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="validateInput()">ğŸ” Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ</button>
                    <button class="btn btn-warning" onclick="sanitizeInput()">ğŸ§¹ Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ</button>
                </div>
                <div class="result-box">
                    <h4>Ù†ØªÛŒØ¬Ù‡ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ:</h4>
                    <div class="output" id="xssOutput6"></div>
                </div>
            </div>

            <!-- ØªØ³Øª Ø´Ù…Ø§Ø±Ù‡ 7: ØªØ²Ø±ÛŒÙ‚ JSON -->
            <div class="test-card">
                <h3>
                    <span>ğŸ“¦ ØªØ³Øª Û·: XSS Ø¯Ø± JSON</span>
                    <span class="badge">Ù¾ÛŒØ´Ø±ÙØªÙ‡</span>
                </h3>
                <div class="input-group">
                    <label>JSON Ù…Ø®Ø±Ø¨:</label>
                    <textarea id="xssInput7" dir="ltr">{"name": "&lt;script&gt;alert('XSS')&lt;/script&gt;", "age": 25}</textarea>
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="parseJSON()">ğŸ”„ Ù¾Ø§Ø±Ø³ (Ø®Ø·Ø±Ù†Ø§Ú©)</button>
                    <button class="btn btn-success" onclick="parseJSONSafe()">ğŸ›¡ï¸ Ù¾Ø§Ø±Ø³ Ø§Ù…Ù†</button>
                </div>
                <div class="result-box">
                    <h4>Ù†ØªÛŒØ¬Ù‡:</h4>
                    <div class="output" id="xssOutput7"></div>
                </div>
            </div>

            <!-- ØªØ³Øª Ø´Ù…Ø§Ø±Ù‡ 8: Ø­Ù…Ù„Ø§Øª XSS Ú©Ù„ÛŒ -->
            <div class="test-card">
                <h3>
                    <span>âš¡ ØªØ³Øª Û¸: Ø­Ù…Ù„Ø§Øª ØªØ±Ú©ÛŒØ¨ÛŒ</span>
                    <span class="badge">Ú©Ø§Ù…Ù„</span>
                </h3>
                <div class="btn-group" style="flex-direction: column;">
                    <button class="btn btn-danger" onclick="testAllAttacks()">ğŸ”¥ Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…Ù‡ Ø­Ù…Ù„Ø§Øª</button>
                    <button class="btn btn-success" onclick="testAllDefenses()">ğŸ›¡ï¸ ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù‡Ù…Ù‡ Ø¯ÙØ§Ø¹â€ŒÙ‡Ø§</button>
                    <button class="btn btn-warning" onclick="resetAll()">ğŸ”„ Ø±ÛŒØ³Øª Ù‡Ù…Ù‡</button>
                </div>
                <div class="result-box">
                    <h4>Ú¯Ø²Ø§Ø±Ø´ Ú©Ù„ÛŒ:</h4>
                    <div class="output" id="xssOutput8">Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ø­Ù…Ù„Ø§Øª Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯</div>
                </div>
            </div>
        </div>

        <!-- Ø¢Ù…Ø§Ø± Ùˆ Ú¯Ø²Ø§Ø±Ø´ -->
        <div class="header" style="margin-top: 30px;">
            <h2>ğŸ“Š Ø¢Ù…Ø§Ø± ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ XSS</h2>
            <div style="display: flex; justify-content: space-around; margin: 20px 0; flex-wrap: wrap;">
                <div style="text-align: center;">
                    <div style="font-size: 36px; font-weight: bold; color: #e74c3c;" id="attackCount">0</div>
                    <div>Ø­Ù…Ù„Ø§Øª Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù‡</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 36px; font-weight: bold; color: #2ecc71;" id="defenseCount">0</div>
                    <div>Ø¯ÙØ§Ø¹â€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙÙ‚</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 36px; font-weight: bold; color: #f39c12;" id="blockedCount">0</div>
                    <div>Ø­Ù…Ù„Ø§Øª Ù…Ø³Ø¯ÙˆØ¯ Ø´Ø¯Ù‡</div>
                </div>
            </div>
            <button class="btn btn-primary" onclick="showSecurityReport()" style="width: auto; margin: 0 auto;">ğŸ“‹ Ù†Ù…Ø§ÛŒØ´ Ú¯Ø²Ø§Ø±Ø´ Ø§Ù…Ù†ÛŒØªÛŒ</button>
        </div>
    </div>

    <script>
        // ØªÙˆØ§Ø¨Ø¹ Ø§Ù…Ù†ÛŒØªÛŒ
        function sanitizeHTML(str) {
            if (!str) return '';
            return String(str)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;')
                .replace(/\//g, '&#x2F;')
                .replace(/`/g, '&#96;');
        }

        function validateAgainstXSS(str) {
            if (!str) return { valid: true, message: 'ÙˆØ±ÙˆØ¯ÛŒ Ø®Ø§Ù„ÛŒ' };
            
            const patterns = [
                { pattern: /<script/i, type: 'Script tag' },
                { pattern: /javascript:/i, type: 'JavaScript protocol' },
                { pattern: /onerror\s*=/i, type: 'onerror event' },
                { pattern: /onload\s*=/i, type: 'onload event' },
                { pattern: /onclick\s*=/i, type: 'onclick event' },
                { pattern: /onmouseover\s*=/i, type: 'onmouseover event' },
                { pattern: /eval\s*\(/i, type: 'eval function' },
                { pattern: /<img/i, type: 'Image tag' },
                { pattern: /<iframe/i, type: 'Iframe tag' },
                { pattern: /<svg/i, type: 'SVG tag' },
                { pattern: /alert\s*\(/i, type: 'alert function' },
                { pattern: /prompt\s*\(/i, type: 'prompt function' },
                { pattern: /confirm\s*\(/i, type: 'confirm function' }
            ];

            for (let p of patterns) {
                if (p.pattern.test(str)) {
                    return { valid: false, message: `Ø§Ù„Ú¯ÙˆÛŒ Ù…Ø®Ø±Ø¨ ÛŒØ§ÙØª Ø´Ø¯: ${p.type}` };
                }
            }
            
            return { valid: true, message: 'ÙˆØ±ÙˆØ¯ÛŒ Ø§Ù…Ù† Ø§Ø³Øª' };
        }

        // ØªØ³Øª 1: XSS Ù¾Ø§ÛŒÙ‡
        function testXSSBasic() {
            const input = document.getElementById('xssInput1').value;
            const output = document.getElementById('xssOutput1');
            output.innerHTML = input;
            output.className = 'output danger';
            updateAttackCount();
        }

        function testXSSWithSanitize() {
            const input = document.getElementById('xssInput1').value;
            const output = document.getElementById('xssOutput1');
            output.innerHTML = sanitizeHTML(input);
            output.className = 'output sanitized';
            updateDefenseCount();
        }

        function resetXSSBasic() {
            document.getElementById('xssOutput1').innerHTML = 'Ù…Ù†ØªØ¸Ø± ÙˆØ±ÙˆØ¯ÛŒ...';
            document.getElementById('xssOutput1').className = 'output';
        }

        // ØªØ³Øª 2: Event Handler
        function testXSSEvent() {
            const input = document.getElementById('xssInput2').value;
            const output = document.getElementById('xssOutput2');
            output.setAttribute('onmouseover', input);
            output.innerHTML = 'Ù…Ø§ÙˆØ³ Ø±Ø§ Ø­Ø±Ú©Øª Ø¯Ù‡ÛŒØ¯ (Ø¨Ø¯ÙˆÙ† ÙÛŒÙ„ØªØ±)';
            updateAttackCount();
        }

        function testXSSEventSafe() {
            const input = document.getElementById('xssInput2').value;
            const output = document.getElementById('xssOutput2');
            output.setAttribute('onmouseover', sanitizeHTML(input));
            output.innerHTML = 'Ù…Ø§ÙˆØ³ Ø±Ø§ Ø­Ø±Ú©Øª Ø¯Ù‡ÛŒØ¯ (Ø§Ù…Ù†)';
            updateDefenseCount();
        }

        // ØªØ³Øª 3: URL XSS
        function testXSSURL() {
            const input = document.getElementById('xssInput3').value;
            const output = document.getElementById('xssOutput3');
            output.innerHTML = `<a href="${input}" target="_blank" style="color: #e74c3c;">ğŸ”— Ù„ÛŒÙ†Ú© Ù…Ø®Ø±Ø¨ (Ú©Ù„ÛŒÚ© Ù†Ú©Ù†ÛŒØ¯!)</a>`;
            updateAttackCount();
        }

        function testXSSURLSafe() {
            const input = document.getElementById('xssInput3').value;
            const output = document.getElementById('xssOutput3');
            const safeURL = input.replace(/^javascript:/i, '#');
            output.innerHTML = `<a href="${safeURL}" style="color: #2ecc71;">ğŸ”— Ù„ÛŒÙ†Ú© Ø§Ù…Ù†</a>`;
            updateDefenseCount();
        }

        // ØªØ³Øª 4: HTML Injection
        function testHTMLInjection() {
            const input = document.getElementById('xssInput4').value;
            const output = document.getElementById('xssOutput4');
            output.innerHTML = input;
            updateAttackCount();
        }

        function testHTMLInjectionSafe() {
            const input = document.getElementById('xssInput4').value;
            const output = document.getElementById('xssOutput4');
            output.textContent = input;
            output.className = 'output sanitized';
            updateDefenseCount();
        }

        // ØªØ³Øª 5: localStorage XSS
        let storageAttacks = 0;
        function saveToStorage() {
            const input = document.getElementById('xssInput5').value;
            localStorage.setItem('xssTestData', input);
            document.getElementById('xssOutput5').innerHTML = 'âœ… Ø¯Ø§Ø¯Ù‡ Ø¯Ø± localStorage Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯';
        }

        function loadFromStorage() {
            const data = localStorage.getItem('xssTestData') || '';
            const output = document.getElementById('xssOutput5');
            output.innerHTML = data;
            storageAttacks++;
            updateAttackCount();
        }

        function loadFromStorageSafe() {
            const data = localStorage.getItem('xssTestData') || '';
            const output = document.getElementById('xssOutput5');
            output.innerHTML = sanitizeHTML(data);
            output.className = 'output sanitized';
            updateDefenseCount();
        }

        // ØªØ³Øª 6: Validation
        function validateInput() {
            const input = document.getElementById('xssInput6').value;
            const result = validateAgainstXSS(input);
            const output = document.getElementById('xssOutput6');
            output.innerHTML = result.valid ? 
                `âœ… ${result.message}` : 
                `âŒ ${result.message}`;
            output.className = result.valid ? 'output sanitized' : 'output danger';
        }

        function sanitizeInput() {
            const input = document.getElementById('xssInput6').value;
            const output = document.getElementById('xssOutput6');
            output.innerHTML = sanitizeHTML(input);
            output.className = 'output sanitized';
            updateDefenseCount();
        }

        // ØªØ³Øª 7: JSON XSS
        function parseJSON() {
            try {
                const input = document.getElementById('xssInput7').value;
                const data = JSON.parse(input);
                const output = document.getElementById('xssOutput7');
                output.innerHTML = data.name;
                updateAttackCount();
            } catch(e) {
                document.getElementById('xssOutput7').innerHTML = 'âŒ JSON Ù†Ø§Ù…Ø¹ØªØ¨Ø±';
            }
        }

        function parseJSONSafe() {
            try {
                const input = document.getElementById('xssInput7').value;
                const data = JSON.parse(input);
                const output = document.getElementById('xssOutput7');
                output.innerHTML = sanitizeHTML(data.name);
                output.className = 'output sanitized';
                updateDefenseCount();
            } catch(e) {
                document.getElementById('xssOutput7').innerHTML = 'âŒ JSON Ù†Ø§Ù…Ø¹ØªØ¨Ø±';
            }
        }

        // ØªØ³Øª 8: All attacks
        let attackCount = 0, defenseCount = 0;
        
        function updateAttackCount() {
            attackCount++;
            document.getElementById('attackCount').innerText = attackCount;
        }
        
        function updateDefenseCount() {
            defenseCount++;
            document.getElementById('defenseCount').innerText = defenseCount;
            document.getElementById('blockedCount').innerText = defenseCount;
        }

        function testAllAttacks() {
            testXSSBasic();
            testXSSEvent();
            testXSSURL();
            testHTMLInjection();
            document.getElementById('xssOutput8').innerHTML = 'âœ… ØªÙ…Ø§Ù… Ø­Ù…Ù„Ø§Øª Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù†Ø¯';
        }

        function testAllDefenses() {
            testXSSWithSanitize();
            testXSSEventSafe();
            testXSSURLSafe();
            testHTMLInjectionSafe();
            document.getElementById('xssOutput8').innerHTML = 'ğŸ›¡ï¸ ØªÙ…Ø§Ù… Ø¯ÙØ§Ø¹â€ŒÙ‡Ø§ ÙØ¹Ø§Ù„ Ø´Ø¯Ù†Ø¯';
        }

        function resetAll() {
            resetXSSBasic();
            document.getElementById('xssOutput2').innerHTML = 'Ù…Ø§ÙˆØ³ Ø±Ø§ Ø­Ø±Ú©Øª Ø¯Ù‡ÛŒØ¯';
            document.getElementById('xssOutput3').innerHTML = '';
            document.getElementById('xssOutput4').innerHTML = '';
            document.getElementById('xssOutput5').innerHTML = '';
            document.getElementById('xssOutput6').innerHTML = '';
            document.getElementById('xssOutput7').innerHTML = '';
            document.getElementById('xssOutput8').innerHTML = 'Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ø­Ù…Ù„Ø§Øª Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯';
        }

        function showSecurityReport() {
            const report = `
Ú¯Ø²Ø§Ø±Ø´ Ø§Ù…Ù†ÛŒØªÛŒ XSS:
ğŸ“Š Ø­Ù…Ù„Ø§Øª Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù‡: ${attackCount}
ğŸ›¡ï¸ Ø¯ÙØ§Ø¹â€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙÙ‚: ${defenseCount}
âš ï¸ Ø®Ø·Ø±Ø§Øª Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ø¯Ù‡: ${attackCount - defenseCount}
âœ… ØªÙˆØµÛŒÙ‡: Ù‡Ù…ÛŒØ´Ù‡ ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§ Ø±Ø§ sanitize Ú©Ù†ÛŒØ¯
            `;
            alert(report);
        }

        // Ù¾ÛŒØ´Ú¯ÛŒØ±ÛŒ Ø§Ø² Ø§Ø¬Ø±Ø§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ XSS
        document.addEventListener('mouseover', function(e) {
            if(e.target.hasAttribute('onmouseover') && !e.target.classList.contains('safe')) {
                console.log('âš ï¸ Event handler Ù…Ø®Ø±Ø¨ Ù…Ø³Ø¯ÙˆØ¯ Ø´Ø¯');
                e.preventDefault();
            }
        }, true);
    </script>
</body>
</html>
