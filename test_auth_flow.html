<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ù…Ù„ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #1e3c72;
        }
        
        h1 {
            color: #1e3c72;
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #4a5568;
            font-size: 1.1rem;
        }
        
        .test-panel {
            background: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border-right: 5px solid #4299e1;
        }
        
        .test-title {
            color: #2d3748;
            font-size: 1.3rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .test-title::before {
            content: "ğŸ”";
            font-size: 1.2rem;
        }
        
        .flow-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 12px;
            border: 2px dashed #cbd5e0;
        }
        
        .flow-step {
            display: flex;
            align-items: center;
            margin: 10px 0;
            width: 100%;
            max-width: 400px;
        }
        
        .step-number {
            background: #4299e1;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-left: 15px;
            flex-shrink: 0;
        }
        
        .step-text {
            background: #edf2f7;
            padding: 12px 20px;
            border-radius: 10px;
            flex-grow: 1;
            font-weight: 500;
        }
        
        .step-arrow {
            color: #a0aec0;
            margin: 0 10px;
            font-size: 1.2rem;
        }
        
        .test-controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #4299e1, #3182ce);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(45deg, #3182ce, #2c5282);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(49, 130, 206, 0.3);
        }
        
        .btn-secondary {
            background: #edf2f7;
            color: #4a5568;
        }
        
        .btn-secondary:hover {
            background: #e2e8f0;
        }
        
        .btn-success {
            background: linear-gradient(45deg, #48bb78, #38a169);
            color: white;
        }
        
        .btn-success:hover {
            background: linear-gradient(45deg, #38a169, #2f855a);
        }
        
        .btn-danger {
            background: linear-gradient(45deg, #f56565, #e53e3e);
            color: white;
        }
        
        .btn-danger:hover {
            background: linear-gradient(45deg, #e53e3e, #c53030);
        }
        
        .results-container {
            margin-top: 30px;
            max-height: 400px;
            overflow-y: auto;
            background: #1a202c;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #2d3748;
        }
        
        .result-item {
            padding: 12px 15px;
            margin: 10px 0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideIn 0.5s ease;
            background: rgba(255, 255, 255, 0.05);
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .result-item.success {
            border-right: 4px solid #48bb78;
            background: rgba(72, 187, 120, 0.1);
            color: #9ae6b4;
        }
        
        .result-item.error {
            border-right: 4px solid #f56565;
            background: rgba(245, 101, 101, 0.1);
            color: #fc8181;
        }
        
        .result-item.info {
            border-right: 4px solid #4299e1;
            background: rgba(66, 153, 225, 0.1);
            color: #90cdf4;
        }
        
        .result-item.warning {
            border-right: 4px solid #ed8936;
            background: rgba(237, 137, 54, 0.1);
            color: #fbd38d;
        }
        
        .status-icon {
            font-size: 1.3rem;
            width: 30px;
            text-align: center;
            flex-shrink: 0;
        }
        
        .result-content {
            flex-grow: 1;
        }
        
        .result-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: white;
        }
        
        .result-details {
            font-size: 0.9rem;
            color: #cbd5e0;
        }
        
        .timestamp {
            font-size: 0.8rem;
            color: #a0aec0;
            text-align: left;
            flex-shrink: 0;
        }
        
        .state-display {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #e2e8f0;
        }
        
        .state-title {
            color: #2d3748;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .state-title::before {
            content: "ğŸ“Š";
        }
        
        .state-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .state-item {
            background: #f7fafc;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }
        
        .state-label {
            color: #4a5568;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .state-value {
            color: #2d3748;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .state-value.authenticated {
            color: #38a169;
        }
        
        .state-value.not-authenticated {
            color: #e53e3e;
        }
        
        .summary-panel {
            background: linear-gradient(45deg, #4fd1c5, #38b2ac);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
            text-align: center;
        }
        
        .summary-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: white;
            width: 0%;
            transition: width 1s ease;
            border-radius: 10px;
        }
        
        .user-simulator {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #e2e8f0;
        }
        
        .simulator-title {
            color: #2d3748;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .user-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
        }
        
        .input-label {
            color: #4a5568;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .input-field {
            padding: 10px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            color: #718096;
            font-size: 0.9rem;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .test-controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .flow-step {
                flex-direction: column;
                text-align: center;
            }
            
            .step-arrow {
                transform: rotate(90deg);
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ” ØªØ³Øª Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ù…Ù„ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª</h1>
            <p class="subtitle">Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…ØŒ Ù„Ø§Ú¯ÛŒÙ†ØŒ Ù„Ø§Ú¯Ø§ÙˆØª Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ¶Ø¹ÛŒØª Ú©Ø§Ø±Ø¨Ø±</p>
        </header>

        <!-- Ø¨Ø®Ø´ Ù†Ù…ÙˆØ¯Ø§Ø± Ø¬Ø±ÛŒØ§Ù† -->
        <div class="test-panel">
            <h2 class="test-title">Ù†Ù…ÙˆØ¯Ø§Ø± Ø¬Ø±ÛŒØ§Ù† Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª</h2>
            <div class="flow-diagram">
                <div class="flow-step">
                    <div class="step-number">Û±</div>
                    <div class="step-text">ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡ Ø¨Ø±Ù†Ø§Ù…Ù‡</div>
                </div>
                <div class="step-arrow">â†“</div>
                <div class="flow-step">
                    <div class="step-number">Û²</div>
                    <div class="step-text">Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù‚Ø¨Ù„ÛŒ (Token Ù…Ø¹ØªØ¨Ø±)</div>
                </div>
                <div class="step-arrow">â†“</div>
                <div class="flow-step">
                    <div class="step-number">Û³</div>
                    <div class="step-text">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… / Ù„Ø§Ú¯ÛŒÙ† Ú©Ø§Ø±Ø¨Ø±</div>
                </div>
                <div class="step-arrow">â†“</div>
                <div class="flow-step">
                    <div class="step-number">Û´</div>
                    <div class="step-text">Ø°Ø®ÛŒØ±Ù‡ Token Ùˆ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±</div>
                </div>
                <div class="step-arrow">â†“</div>
                <div class="flow-step">
                    <div class="step-number">Ûµ</div>
                    <div class="step-text">Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ù…Ø­ØªÙˆØ§ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ</div>
                </div>
                <div class="step-arrow">â†“</div>
                <div class="flow-step">
                    <div class="step-number">Û¶</div>
                    <div class="step-text">Ù„Ø§Ú¯Ø§ÙˆØª / Ø§Ù†Ù‚Ø¶Ø§ÛŒ Token</div>
                </div>
            </div>
        </div>

        <!-- Ø¨Ø®Ø´ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ø±Ø¨Ø± -->
        <div class="user-simulator">
            <h3 class="simulator-title">Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ø±Ø¨Ø±</h3>
            <div class="user-inputs">
                <div class="input-group">
                    <label class="input-label">Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ</label>
                    <input type="text" id="username" class="input-field" placeholder="Ù…Ø«Ø§Ù„: user123" value="test_user">
                </div>
                <div class="input-group">
                    <label class="input-label">Ø§ÛŒÙ…ÛŒÙ„</label>
                    <input type="email" id="email" class="input-field" placeholder="example@domain.com" value="test@example.com">
                </div>
                <div class="input-group">
                    <label class="input-label">Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</label>
                    <input type="password" id="password" class="input-field" placeholder="Ø­Ø¯Ø§Ù‚Ù„ Û¶ Ú©Ø§Ø±Ø§Ú©ØªØ±" value="Password123!">
                </div>
            </div>
        </div>

        <!-- Ø¨Ø®Ø´ Ú©Ù†ØªØ±Ù„ ØªØ³Øªâ€ŒÙ‡Ø§ -->
        <div class="test-panel">
            <h2 class="test-title">Ú©Ù†ØªØ±Ù„ ØªØ³Øªâ€ŒÙ‡Ø§</h2>
            <div class="test-controls">
                <button class="btn btn-primary" onclick="runFullFlowTest()">
                    <span>ğŸ”„</span> Ø§Ø¬Ø±Ø§ÛŒ Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ù…Ù„
                </button>
                <button class="btn btn-success" onclick="runRegisterTest()">
                    <span>ğŸ“</span> ØªØ³Øª Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…
                </button>
                <button class="btn btn-primary" onclick="runLoginTest()">
                    <span>ğŸ”‘</span> ØªØ³Øª Ù„Ø§Ú¯ÛŒÙ†
                </button>
                <button class="btn btn-danger" onclick="runLogoutTest()">
                    <span>ğŸšª</span> ØªØ³Øª Ù„Ø§Ú¯Ø§ÙˆØª
                </button>
                <button class="btn btn-secondary" onclick="runStatePersistenceTest()">
                    <span>ğŸ’¾</span> ØªØ³Øª Ø­ÙØ¸ ÙˆØ¶Ø¹ÛŒØª
                </button>
                <button class="btn btn-secondary" onclick="runErrorHandlingTest()">
                    <span>âš ï¸</span> ØªØ³Øª Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§
                </button>
            </div>
        </div>

        <!-- Ù†Ù…Ø§ÛŒØ´ ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ -->
        <div class="state-display">
            <h3 class="state-title">ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ Ø³ÛŒØ³ØªÙ… Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª</h3>
            <div class="state-grid">
                <div class="state-item">
                    <div class="state-label">ÙˆØ¶Ø¹ÛŒØª Ø§Ø­Ø±Ø§Ø²</div>
                    <div id="authStatus" class="state-value not-authenticated">âŒ Ø§Ø­Ø±Ø§Ø² Ù†Ø´Ø¯Ù‡</div>
                </div>
                <div class="state-item">
                    <div class="state-label">Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ù„ÛŒ</div>
                    <div id="currentUser" class="state-value">---</div>
                </div>
                <div class="state-item">
                    <div class="state-label">Token ÙØ¹Ø§Ù„</div>
                    <div id="tokenStatus" class="state-value">âŒ Ù†Ø¯Ø§Ø±Ø¯</div>
                </div>
                <div class="state-item">
                    <div class="state-label">Ø²Ù…Ø§Ù† Ø§Ù†Ù‚Ø¶Ø§</div>
                    <div id="tokenExpiry" class="state-value">---</div>
                </div>
            </div>
        </div>

        <!-- Ù†ØªØ§ÛŒØ¬ ØªØ³Øªâ€ŒÙ‡Ø§ -->
        <div class="test-panel">
            <h2 class="test-title">Ù†ØªØ§ÛŒØ¬ ØªØ³Øªâ€ŒÙ‡Ø§</h2>
            <div class="results-container" id="resultsContainer">
                <div class="result-item info">
                    <div class="status-icon">â„¹ï¸</div>
                    <div class="result-content">
                        <div class="result-title">Ø³ÛŒØ³ØªÙ… ØªØ³Øª Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª</div>
                        <div class="result-details">Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ ÛŒÚ©ÛŒ Ø§Ø² ØªØ³Øªâ€ŒÙ‡Ø§ Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯</div>
                    </div>
                    <div class="timestamp" id="initialTimestamp"></div>
                </div>
            </div>
        </div>

        <!-- Ø®Ù„Ø§ØµÙ‡ Ø¢Ù…Ø§Ø± -->
        <div class="summary-panel">
            <h3 class="summary-title">Ø¢Ù…Ø§Ø± ØªØ³Øªâ€ŒÙ‡Ø§</h3>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="totalTests">0</div>
                    <div class="stat-label">ØªØ³Øª Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù‡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="passedTests">0</div>
                    <div class="stat-label">Ù…ÙˆÙÙ‚</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="failedTests">0</div>
                    <div class="stat-label">Ù†Ø§Ù…ÙˆÙÙ‚</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="successRate">0%</div>
                    <div class="stat-label">Ù†Ø±Ø® Ù…ÙˆÙÙ‚ÛŒØª</div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <button class="btn" style="background: white; color: #2d3748; margin-top: 15px;" 
                    onclick="clearResults()">
                ğŸ—‘ï¸ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù†ØªØ§ÛŒØ¬
            </button>
        </div>

        <footer>
            <p>ØªØ³Øª Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ù…Ù„ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª | Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„</p>
            <p style="margin-top: 10px; font-size: 0.8rem; color: #a0aec0;">
                ØªÙ…Ø§Ù…ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
            </p>
        </footer>
    </div>

    <script>
        // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…
        let authState = {
            isAuthenticated: false,
            currentUser: null,
            token: null,
            tokenExpiry: null,
            refreshToken: null
        };

        // Ø¢Ù…Ø§Ø± ØªØ³Øªâ€ŒÙ‡Ø§
        const testStats = {
            total: 0,
            passed: 0,
            failed: 0,
            results: []
        };

        // ØªØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÙØ²ÙˆØ¯Ù† Ù†ØªÛŒØ¬Ù‡ Ø¬Ø¯ÛŒØ¯
        function addResult(type, title, details) {
            const resultsContainer = document.getElementById('resultsContainer');
            const resultItem = document.createElement('div');
            
            const types = {
                success: { class: 'success', icon: 'âœ…' },
                error: { class: 'error', icon: 'âŒ' },
                info: { class: 'info', icon: 'â„¹ï¸' },
                warning: { class: 'warning', icon: 'âš ï¸' }
            };
            
            const now = new Date();
            const timeString = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;
            
            resultItem.className = `result-item ${types[type].class}`;
            resultItem.innerHTML = `
                <div class="status-icon">${types[type].icon}</div>
                <div class="result-content">
                    <div class="result-title">${title}</div>
                    <div class="result-details">${details}</div>
                </div>
                <div class="timestamp">${timeString}</div>
            `;
            
            resultsContainer.appendChild(resultItem);
            resultsContainer.scrollTop = resultsContainer.scrollHeight;
            
            // Ø¢Ù¾Ø¯ÛŒØª Ø¢Ù…Ø§Ø±
            if (type === 'success') {
                testStats.passed++;
                testStats.total++;
            } else if (type === 'error') {
                testStats.failed++;
                testStats.total++;
            }
            
            testStats.results.push({ type, title, time: timeString });
            updateStats();
        }

        // Ø¢Ù¾Ø¯ÛŒØª Ø¢Ù…Ø§Ø±
        function updateStats() {
            document.getElementById('totalTests').textContent = testStats.total;
            document.getElementById('passedTests').textContent = testStats.passed;
            document.getElementById('failedTests').textContent = testStats.failed;
            
            const successRate = testStats.total > 0 ? 
                Math.round((testStats.passed / testStats.total) * 100) : 0;
            document.getElementById('successRate').textContent = `${successRate}%`;
            document.getElementById('progressFill').style.width = `${successRate}%`;
        }

        // Ø¢Ù¾Ø¯ÛŒØª ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…
        function updateAuthDisplay() {
            const authStatus = document.getElementById('authStatus');
            const currentUser = document.getElementById('currentUser');
            const tokenStatus = document.getElementById('tokenStatus');
            const tokenExpiry = document.getElementById('tokenExpiry');
            
            if (authState.isAuthenticated && authState.currentUser) {
                authStatus.className = 'state-value authenticated';
                authStatus.textContent = 'âœ… Ø§Ø­Ø±Ø§Ø² Ø´Ø¯Ù‡';
                currentUser.textContent = authState.currentUser.username || 'Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ø´Ù†Ø§Ø³';
                tokenStatus.textContent = authState.token ? 'âœ… Ø¯Ø§Ø±Ø¯' : 'âŒ Ù†Ø¯Ø§Ø±Ø¯';
                
                if (authState.tokenExpiry) {
                    const expiryTime = new Date(authState.tokenExpiry);
                    const now = new Date();
                    const diffMinutes = Math.round((expiryTime - now) / 60000);
                    
                    if (diffMinutes > 0) {
                        tokenExpiry.textContent = `${diffMinutes} Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¯ÛŒÚ¯Ø±`;
                    } else {
                        tokenExpiry.textContent = 'Ù…Ù†Ù‚Ø¶ÛŒ Ø´Ø¯Ù‡';
                    }
                } else {
                    tokenExpiry.textContent = '---';
                }
            } else {
                authStatus.className = 'state-value not-authenticated';
                authStatus.textContent = 'âŒ Ø§Ø­Ø±Ø§Ø² Ù†Ø´Ø¯Ù‡';
                currentUser.textContent = '---';
                tokenStatus.textContent = 'âŒ Ù†Ø¯Ø§Ø±Ø¯';
                tokenExpiry.textContent = '---';
            }
        }

        // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªÙˆÙ„ÛŒØ¯ JWT
        function generateMockJWT(userData, expiresInMinutes = 60) {
            const header = btoa(JSON.stringify({ alg: 'HS256', typ: 'JWT' }));
            const payload = btoa(JSON.stringify({
                userId: userData.id || Date.now(),
                username: userData.username,
                email: userData.email,
                iat: Math.floor(Date.now() / 1000),
                exp: Math.floor(Date.now() / 1000) + (expiresInMinutes * 60)
            }));
            
            return `${header}.${payload}.mock_signature`;
        }

        // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…
        function mockRegister(username, email, password) {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø³Ø§Ø¯Ù‡
                    if (!username || username.length < 3) {
                        reject(new Error('Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û³ Ú©Ø§Ø±Ø§Ú©ØªØ± Ø¨Ø§Ø´Ø¯'));
                        return;
                    }
                    
                    if (!email.includes('@')) {
                        reject(new Error('Ø§ÛŒÙ…ÛŒÙ„ Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª'));
                        return;
                    }
                    
                    if (!password || password.length < 6) {
                        reject(new Error('Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û¶ Ú©Ø§Ø±Ø§Ú©ØªØ± Ø¨Ø§Ø´Ø¯'));
                        return;
                    }
                    
                    const userData = {
                        id: Date.now(),
                        username,
                        email,
                        createdAt: new Date().toISOString()
                    };
                    
                    resolve({
                        success: true,
                        user: userData,
                        token: generateMockJWT(userData),
                        message: 'Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø¨ÙˆØ¯'
                    });
                }, 800); // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ§Ø®ÛŒØ± Ø´Ø¨Ú©Ù‡
            });
        }

        // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù„Ø§Ú¯ÛŒÙ†
        function mockLogin(email, password) {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø³Ø§Ø¯Ù‡
                    if (!email || !password) {
                        reject(new Error('Ø§ÛŒÙ…ÛŒÙ„ Ùˆ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ù„Ø²Ø§Ù…ÛŒ Ø§Ø³Øª'));
                        return;
                    }
                    
                    if (password !== 'Password123!') {
                        reject(new Error('Ø§ÛŒÙ…ÛŒÙ„ ÛŒØ§ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª'));
                        return;
                    }
                    
                    const userData = {
                        id: 12345,
                        username: email.split('@')[0],
                        email,
                        lastLogin: new Date().toISOString()
                    };
                    
                    resolve({
                        success: true,
                        user: userData,
                        token: generateMockJWT(userData),
                        refreshToken: 'mock_refresh_token_' + Date.now()
                    });
                }, 600);
            });
        }

        // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù„Ø§Ú¯Ø§ÙˆØª
        function mockLogout() {
            return new Promise((resolve) => {
                setTimeout(() => {
                    resolve({
                        success: true,
                        message: 'Ø®Ø±ÙˆØ¬ Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø¨ÙˆØ¯'
                    });
                }, 300);
            });
        }

        // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª
        function mockRestoreSession() {
            return new Promise((resolve) => {
                setTimeout(() => {
                    // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø±Ø±Ø³ÛŒ localStorage
                    const savedAuth = localStorage.getItem('farsinglish_auth_state');
                    
                    if (savedAuth) {
                        try {
                            const parsed = JSON.parse(savedAuth);
                            if (parsed.token && parsed.user) {
                                resolve({
                                    success: true,
                                    ...parsed
                                });
                                return;
                            }
                        } catch (e) {
                            // Ø®Ø·Ø§ÛŒ parse
                        }
                    }
                    
                    resolve({
                        success: false,
                        message: 'Ù‡ÛŒÚ† session Ø°Ø®ÛŒØ±Ù‡â€ŒØ´Ø¯Ù‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯'
                    });
                }, 400);
            });
        }

        // ØªØ³Øª Û±: Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ù…Ù„
        async function runFullFlowTest() {
            addResult('info', 'Ø´Ø±ÙˆØ¹ ØªØ³Øª Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ù…Ù„', 'Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… â†’ Ù„Ø§Ú¯ÛŒÙ† â†’ Ù„Ø§Ú¯Ø§ÙˆØª');
            
            try {
                // Û±. Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…
                const username = document.getElementById('username').value;
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                const registerResult = await mockRegister(username, email, password);
                authState = {
                    isAuthenticated: true,
                    currentUser: registerResult.user,
                    token: registerResult.token,
                    tokenExpiry: Date.now() + 3600000,
                    refreshToken: null
                };
                
                addResult('success', 'Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù…ÙˆÙÙ‚', `Ú©Ø§Ø±Ø¨Ø± ${username} Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯`);
                updateAuthDisplay();
                
                // Û². Ù„Ø§Ú¯ÛŒÙ† (Ø¨Ø§ Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯)
                await new Promise(resolve => setTimeout(resolve, 1000));
                const loginResult = await mockLogin(email, password);
                authState = {
                    isAuthenticated: true,
                    currentUser: loginResult.user,
                    token: loginResult.token,
                    tokenExpiry: Date.now() + 3600000,
                    refreshToken: loginResult.refreshToken
                };
                
                addResult('success', 'Ù„Ø§Ú¯ÛŒÙ† Ù…ÙˆÙÙ‚', 'Ú©Ø§Ø±Ú¯Ø± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ÙˆØ§Ø±Ø¯ Ø´Ø¯');
                updateAuthDisplay();
                
                // Û³. Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§Ù¾
                await new Promise(resolve => setTimeout(resolve, 1500));
                addResult('info', 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¨Ø±Ù†Ø§Ù…Ù‡', 'Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ø­Ø§Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§Ø³Øª...');
                
                // Û´. Ù„Ø§Ú¯Ø§ÙˆØª
                await new Promise(resolve => setTimeout(resolve, 1000));
                const logoutResult = await mockLogout();
                authState = {
                    isAuthenticated: false,
                    currentUser: null,
                    token: null,
                    tokenExpiry: null,
                    refreshToken: null
                };
                
                addResult('success', 'Ù„Ø§Ú¯Ø§ÙˆØª Ù…ÙˆÙÙ‚', logoutResult.message);
                updateAuthDisplay();
                
                addResult('success', 'ØªØ³Øª Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ù…Ù„ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯', 'ØªÙ…Ø§Ù… Ù…Ø±Ø§Ø­Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù†Ø¯');
                
            } catch (error) {
                addResult('error', 'Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ù…Ù„', error.message);
            }
        }

        // ØªØ³Øª Û²: Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…
        async function runRegisterTest() {
            addResult('info', 'Ø´Ø±ÙˆØ¹ ØªØ³Øª Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…', 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ùˆ Ø«Ø¨Øª Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯');
            
            try {
                const username = document.getElementById('username').value;
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                const result = await mockRegister(username, email, password);
                authState = {
                    isAuthenticated: true,
                    currentUser: result.user,
                    token: result.token,
                    tokenExpiry: Date.now() + 3600000,
                    refreshToken: null
                };
                
                addResult('success', 'ØªØ³Øª Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù…ÙˆÙÙ‚', result.message);
                updateAuthDisplay();
                
            } catch (error) {
                addResult('error', 'Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…', error.message);
                
                // ØªØ³Øª Ø®Ø·Ø§Ù‡Ø§ÛŒ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…
                addResult('info', 'ØªØ³Øª Ø®Ø·Ø§Ù‡Ø§ÛŒ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…', 'Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø®Ø·Ø§Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù');
                
                try {
                    await mockRegister('ab', 'invalid-email', '123');
                    addResult('error', 'Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ', 'Ø³ÛŒØ³ØªÙ… Ø¨Ø§ÛŒØ¯ Ø®Ø·Ø§ Ù…ÛŒâ€ŒØ¯Ø§Ø¯');
                } catch (validationError) {
                    addResult('success', 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯', validationError.message);
                }
            }
        }

        // ØªØ³Øª Û³: Ù„Ø§Ú¯ÛŒÙ†
        async function runLoginTest() {
            addResult('info', 'Ø´Ø±ÙˆØ¹ ØªØ³Øª Ù„Ø§Ú¯ÛŒÙ†', 'ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡ Ø³ÛŒØ³ØªÙ…');
            
            try {
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                const result = await mockLogin(email, password);
                authState = {
                    isAuthenticated: true,
                    currentUser: result.user,
                    token: result.token,
                    tokenExpiry: Date.now() + 3600000,
                    refreshToken: result.refreshToken
                };
                
                addResult('success', 'ØªØ³Øª Ù„Ø§Ú¯ÛŒÙ† Ù…ÙˆÙÙ‚', 'Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ÙˆØ§Ø±Ø¯ Ø´Ø¯');
                updateAuthDisplay();
                
                // ØªØ³Øª Ù„Ø§Ú¯ÛŒÙ† Ø¨Ø§ Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡
                addResult('info', 'ØªØ³Øª Ù„Ø§Ú¯ÛŒÙ† Ù†Ø§Ù…ÙˆÙÙ‚', 'Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ÙˆØ±ÙˆØ¯ Ø¨Ø§ Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡');
                
                try {
                    await mockLogin(email, 'wrong_password');
                    addResult('error', 'Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡', 'Ø³ÛŒØ³ØªÙ… Ø¨Ø§ÛŒØ¯ Ø®Ø·Ø§ Ù…ÛŒâ€ŒØ¯Ø§Ø¯');
                } catch (loginError) {
                    addResult('success', 'Ù„Ø§Ú¯ÛŒÙ† Ù†Ø§Ù…ÙˆÙÙ‚ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯', loginError.message);
                }
                
            } catch (error) {
                addResult('error', 'Ø®Ø·Ø§ Ø¯Ø± Ù„Ø§Ú¯ÛŒÙ†', error.message);
            }
        }

        // ØªØ³Øª Û´: Ù„Ø§Ú¯Ø§ÙˆØª
        async function runLogoutTest() {
            addResult('info', 'Ø´Ø±ÙˆØ¹ ØªØ³Øª Ù„Ø§Ú¯Ø§ÙˆØª', 'Ø®Ø±ÙˆØ¬ Ú©Ø§Ø±Ø¨Ø± Ø§Ø² Ø³ÛŒØ³ØªÙ…');
            
            // Ø§Ø¨ØªØ¯Ø§ Ù„Ø§Ú¯ÛŒÙ† Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
            try {
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                const loginResult = await mockLogin(email, password);
                authState = {
                    isAuthenticated: true,
                    currentUser: loginResult.user,
                    token: loginResult.token,
                    tokenExpiry: Date.now() + 3600000,
                    refreshToken: loginResult.refreshToken
                };
                
                addResult('success', 'Ù„Ø§Ú¯ÛŒÙ† Ø§ÙˆÙ„ÛŒÙ‡', 'Ú©Ø§Ø±Ú¯Ø± Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ù„Ø§Ú¯Ø§ÙˆØª ÙˆØ§Ø±Ø¯ Ø´Ø¯');
                updateAuthDisplay();
                
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Ø­Ø§Ù„Ø§ Ù„Ø§Ú¯Ø§ÙˆØª Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
                const logoutResult = await mockLogout();
                authState = {
                    isAuthenticated: false,
                    currentUser: null,
                    token: null,
                    tokenExpiry: null,
                    refreshToken: null
                };
                
                addResult('success', 'ØªØ³Øª Ù„Ø§Ú¯Ø§ÙˆØª Ù…ÙˆÙÙ‚', logoutResult.message);
                updateAuthDisplay();
                
            } catch (error) {
                addResult('error', 'Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ù„Ø§Ú¯Ø§ÙˆØª', error.message);
            }
        }

        // ØªØ³Øª Ûµ: Ø­ÙØ¸ ÙˆØ¶Ø¹ÛŒØª
        async function runStatePersistenceTest() {
            addResult('info', 'Ø´Ø±ÙˆØ¹ ØªØ³Øª Ø­ÙØ¸ ÙˆØ¶Ø¹ÛŒØª', 'Ø°Ø®ÛŒØ±Ù‡ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ session');
            
            try {
                // Û±. Ù„Ø§Ú¯ÛŒÙ† Ùˆ Ø°Ø®ÛŒØ±Ù‡
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                const loginResult = await mockLogin(email, password);
                authState = {
                    isAuthenticated: true,
                    currentUser: loginResult.user,
                    token: loginResult.token,
                    tokenExpiry: Date.now() + 3600000,
                    refreshToken: loginResult.refreshToken
                };
                
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage
                localStorage.setItem('farsinglish_auth_state', JSON.stringify(authState));
                addResult('success', 'Ø°Ø®ÛŒØ±Ù‡ ÙˆØ¶Ø¹ÛŒØª', 'ÙˆØ¶Ø¹ÛŒØª Ø§Ø­Ø±Ø§Ø² Ø¯Ø± localStorage Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
                
                // Û². Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø±ÙØ±Ø´ ØµÙØ­Ù‡
                await new Promise(resolve => setTimeout(resolve, 1500));
                addResult('info', 'Ø±ÙØ±Ø´ ØµÙØ­Ù‡', 'Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø¬Ø¯Ø¯ ØµÙØ­Ù‡');
                
                // Û³. Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª
                const restoreResult = await mockRestoreSession();
                
                if (restoreResult.success) {
                    authState = restoreResult;
                    addResult('success', 'Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª', 'ÙˆØ¶Ø¹ÛŒØª Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø´Ø¯');
                    updateAuthDisplay();
                } else {
                    addResult('warning', 'Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª', 'Ù‡ÛŒÚ† session Ø°Ø®ÛŒØ±Ù‡â€ŒØ´Ø¯Ù‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯');
                }
                
                // Û´. Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø­Ø§Ù„Øª Ø°Ø®ÛŒØ±Ù‡â€ŒØ´Ø¯Ù‡
                localStorage.removeItem('farsinglish_auth_state');
                addResult('info', 'Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø­Ø§Ù„Øª', 'Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ´Ø¯Ù‡ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯');
                
            } catch (error) {
                addResult('error', 'Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ø­ÙØ¸ ÙˆØ¶Ø¹ÛŒØª', error.message);
            }
        }

        // ØªØ³Øª Û¶: Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§
        async function runErrorHandlingTest() {
            addResult('info', 'Ø´Ø±ÙˆØ¹ ØªØ³Øª Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§', 'Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø®Ø·Ø§Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù');
            
            // Û±. ØªØ³Øª Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø¨Ø§ Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ù…Ø¹ØªØ¨Ø±
            addResult('info', 'ØªØ³Øª Û±: Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù†Ø§Ù…Ø¹ØªØ¨Ø±', 'Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø±');
            
            try {
                await mockRegister('', '', '');
                addResult('error', 'Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ', 'Ø³ÛŒØ³ØªÙ… Ø¨Ø§ÛŒØ¯ Ø®Ø·Ø§ Ù…ÛŒâ€ŒØ¯Ø§Ø¯');
            } catch (error) {
                addResult('success', 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯', error.message);
            }
            
            // Û². ØªØ³Øª Ù„Ø§Ú¯ÛŒÙ† Ø¨Ø§ Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ù…Ø¹ØªØ¨Ø±
            await new Promise(resolve => setTimeout(resolve, 800));
            addResult('info', 'ØªØ³Øª Û²: Ù„Ø§Ú¯ÛŒÙ† Ù†Ø§Ù…Ø¹ØªØ¨Ø±', 'Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù„Ø§Ú¯ÛŒÙ† Ø¨Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù‚Øµ');
            
            try {
                await mockLogin('', '');
                addResult('error', 'Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ù„Ø§Ú¯ÛŒÙ†', 'Ø³ÛŒØ³ØªÙ… Ø¨Ø§ÛŒØ¯ Ø®Ø·Ø§ Ù…ÛŒâ€ŒØ¯Ø§Ø¯');
            } catch (error) {
                addResult('success', 'Ù„Ø§Ú¯ÛŒÙ† Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯', error.message);
            }
            
            // Û³. ØªØ³Øª session Ù…Ù†Ù‚Ø¶ÛŒ Ø´Ø¯Ù‡
            await new Promise(resolve => setTimeout(resolve, 800));
            addResult('info', 'ØªØ³Øª Û³: Token Ù…Ù†Ù‚Ø¶ÛŒ Ø´Ø¯Ù‡', 'Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ù†Ù‚Ø¶Ø§ÛŒ ØªÙˆÚ©Ù†');
            
            const expiredToken = generateMockJWT({ username: 'test' }, -10); // ØªÙˆÚ©Ù† Ù…Ù†Ù‚Ø¶ÛŒ Ø´Ø¯Ù‡
            const isExpired = expiredToken.includes('.');
            
            if (isExpired) {
                addResult('success', 'ØªØ´Ø®ÛŒØµ Ø§Ù†Ù‚Ø¶Ø§', 'Ø³ÛŒØ³ØªÙ… Ø¨Ø§ÛŒØ¯ ØªÙˆÚ©Ù† Ù…Ù†Ù‚Ø¶ÛŒ Ø´Ø¯Ù‡ Ø±Ø§ ØªØ´Ø®ÛŒØµ Ø¯Ù‡Ø¯');
            } else {
                addResult('warning', 'ØªØ³Øª Ø§Ù†Ù‚Ø¶Ø§', 'ØªÙˆÚ©Ù† Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡');
            }
            
            // Û´. ØªØ³Øª Ø´Ø¨Ú©Ù‡ Ù‚Ø·Ø¹
            await new Promise(resolve => setTimeout(resolve, 800));
            addResult('info', 'ØªØ³Øª Û´: Ù‚Ø·Ø¹ Ø´Ø¨Ú©Ù‡', 'Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø®Ø·Ø§ÛŒ Ø´Ø¨Ú©Ù‡');
            
            const networkError = new Error('Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ø¨Ø±Ù‚Ø±Ø§Ø± Ù†ÛŒØ³Øª');
            addResult('warning', 'Ø®Ø·Ø§ÛŒ Ø´Ø¨Ú©Ù‡ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯', networkError.message);
            
            addResult('success', 'ØªØ³Øª Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯', 'Û´ Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Ø®Ø·Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªØ³Øª Ø´Ø¯Ù†Ø¯');
        }

        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù†ØªØ§ÛŒØ¬
        function clearResults() {
            document.getElementById('resultsContainer').innerHTML = `
                <div class="result-item info">
                    <div class="status-icon">â„¹ï¸</div>
                    <div class="result-content">
                        <div class="result-title">Ù†ØªØ§ÛŒØ¬ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯</div>
                        <div class="result-details">Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÛŒØ¯ ØªØ³Øªâ€ŒÙ‡Ø§ Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯</div>
                    </div>
                    <div class="timestamp">${new Date().toLocaleTimeString('fa-IR')}</div>
                </div>
            `;
            
            // Ø±ÛŒØ³Øª Ø¢Ù…Ø§Ø±
            testStats.total = 0;
            testStats.passed = 0;
            testStats.failed = 0;
            testStats.results = [];
            updateStats();
            
            addResult('info', 'Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù†ØªØ§ÛŒØ¬', 'Ù‡Ù…Ù‡ Ù†ØªØ§ÛŒØ¬ Ù‚Ø¨Ù„ÛŒ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯');
        }

        // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', () => {
            const now = new Date();
            const timeString = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;
            document.getElementById('initialTimestamp').textContent = timeString;
            
            // Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª
            authState = {
                isAuthenticated: false,
                currentUser: null,
                token: null,
                tokenExpiry: null,
                refreshToken: null
            };
            updateAuthDisplay();
            
            console.log('âœ… Ø³ÛŒØ³ØªÙ… ØªØ³Øª Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯');
        });
    </script>
</body>
  </html>
