<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª ØªØ³ØªØ±ÙˆÙ†Ø± Ø§Ø³Ú©ÛŒÙ…Ø§ Ù†Ø³Ø®Ù‡ Û± - Farsinglish</title>
    <style>
        /* ØªÙ…Ø§Ù… Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØªÙ‡â€ŒØ§Ù†Ø¯ */
        :root {
            --primary: #9c27b0;
            --secondary: #00bcd4;
            --success: #4caf50;
            --error: #f44336;
            --warning: #ff9800;
            --dark: #263238;
            --light: #f5f5f5;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Vazirmatn', 'Segoe UI', Tahoma, sans-serif;
            background: linear-gradient(135deg, #6a1b9a, #8e24aa);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.8;
        }
        
        .container {
            max-width: 1300px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.97);
            border-radius: 30px;
            padding: 40px;
            box-shadow: 0 30px 70px rgba(0, 0, 0, 0.4);
            color: var(--dark);
            position: relative;
            overflow: hidden;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(156, 39, 176, 0.2) 0%, transparent 70%);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 15px;
            color: var(--primary);
            font-size: 3rem;
            text-shadow: 0 3px 15px rgba(156, 39, 176, 0.3);
            position: relative;
            z-index: 1;
        }
        
        .subtitle {
            text-align: center;
            color: #757575;
            margin-bottom: 50px;
            font-size: 1.3rem;
            position: relative;
            z-index: 1;
        }
        
        .test-header {
            background: linear-gradient(135deg, var(--primary), #7b1fa2);
            border-radius: 25px;
            padding: 35px;
            margin: 40px 0;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 30px;
            position: relative;
            z-index: 1;
            box-shadow: 0 15px 40px rgba(156, 39, 176, 0.3);
        }
        
        .header-info {
            flex: 1;
            min-width: 300px;
        }
        
        .schema-preview {
            background: rgba(255, 255, 255, 0.15);
            padding: 25px;
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .preview-title {
            font-size: 1.4rem;
            margin-bottom: 15px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .preview-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .preview-label {
            color: #e1bee7;
        }
        
        .preview-value {
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin: 50px 0;
            position: relative;
            z-index: 1;
        }
        
        .btn {
            padding: 22px 45px;
            border: none;
            border-radius: 60px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 18px;
            min-width: 280px;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.25);
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: translateX(-100%);
        }
        
        .btn:hover::before {
            animation: shine 0.8s;
        }
        
        @keyframes shine {
            to { transform: translateX(100%); }
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), #ab47bc);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), #26c6da);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success), #66bb6a);
            color: white;
        }
        
        .btn-error {
            background: linear-gradient(135deg, var(--error), #ef5350);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #ffb74d);
            color: var(--dark);
        }
        
        .btn:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.35);
        }
        
        .btn:active {
            transform: translateY(-4px) scale(1.02);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .btn-icon {
            font-size: 28px;
        }
        
        .test-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 35px;
            margin: 50px 0;
            position: relative;
            z-index: 1;
        }
        
        .category-card {
            background: white;
            border-radius: 25px;
            padding: 35px;
            border: 3px solid #e0e0e0;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.4s;
            position: relative;
            overflow: hidden;
        }
        
        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 8px;
            background: var(--primary);
        }
        
        .category-card:hover {
            transform: translateY(-10px);
            border-color: var(--primary);
            box-shadow: 0 25px 60px rgba(156, 39, 176, 0.2);
        }
        
        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #f5f5f5;
        }
        
        .category-title {
            font-size: 1.9rem;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .category-icon {
            font-size: 2.5rem;
        }
        
        .category-stats {
            display: flex;
            gap: 20px;
        }
        
        .stat-badge {
            background: #f5f5f5;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }
        
        .test-items {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .test-item {
            background: #fafafa;
            border-radius: 20px;
            padding: 25px;
            border-right: 6px solid var(--warning);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .test-item::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 4px;
            background: var(--secondary);
            transform: translateX(-100%);
            transition: transform 0.5s;
        }
        
        .test-item.running::before {
            transform: translateX(0);
            background: var(--secondary);
        }
        
        .test-item.passed {
            border-right-color: var(--success);
            background: rgba(76, 175, 80, 0.05);
        }
        
        .test-item.failed {
            border-right-color: var(--error);
            background: rgba(244, 67, 54, 0.05);
        }
        
        .test-header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .test-name {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .test-time {
            font-size: 1rem;
            color: #757575;
            background: #eeeeee;
            padding: 8px 18px;
            border-radius: 50px;
            font-family: 'Courier New', monospace;
        }
        
        .test-desc {
            color: #616161;
            font-size: 1.1rem;
            margin-bottom: 25px;
            line-height: 1.8;
        }
        
        .test-details {
            background: white;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #eeeeee;
            margin-top: 20px;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid #f5f5f5;
        }
        
        .detail-label {
            color: #757575;
            font-weight: 500;
        }
        
        .detail-value {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            max-width: 60%;
            text-align: left;
            word-break: break-all;
        }
        
        .detail-value.success {
            color: var(--success);
        }
        
        .detail-value.error {
            color: var(--error);
        }
        
        .detail-value.info {
            color: var(--secondary);
        }
        
        .validation-result {
            margin-top: 20px;
            padding: 20px;
            border-radius: 15px;
            background: #f5f5f5;
        }
        
        .validation-errors {
            margin-top: 15px;
        }
        
        .error-item {
            padding: 12px;
            margin: 10px 0;
            background: rgba(244, 67, 54, 0.1);
            border-right: 4px solid var(--error);
            border-radius: 10px;
            color: var(--error);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .schema-visualizer {
            background: white;
            border-radius: 25px;
            padding: 35px;
            margin: 50px 0;
            border: 3px solid var(--primary);
            box-shadow: 0 20px 50px rgba(156, 39, 176, 0.2);
            position: relative;
            z-index: 1;
        }
        
        .visualizer-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .visualizer-title {
            font-size: 2.2rem;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .tables-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 40px;
        }
        
        .table-visual {
            background: #f5f5f5;
            border-radius: 20px;
            padding: 30px;
            border: 3px solid var(--secondary);
            position: relative;
        }
        
        .table-name {
            font-size: 1.8rem;
            color: var(--dark);
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--secondary);
        }
        
        .table-columns {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .column-row {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            background: white;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
        }
        
        .column-name {
            font-weight: bold;
            font-family: 'Courier New', monospace;
            color: var(--dark);
        }
        
        .column-type {
            background: var(--primary);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .log-container {
            background: #263238;
            border-radius: 25px;
            padding: 30px;
            margin-top: 50px;
            border: 3px solid #37474f;
            position: relative;
            z-index: 1;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 3px solid #37474f;
        }
        
        .log-title {
            font-size: 1.8rem;
            color: #bbdefb;
            font-weight: bold;
        }
        
        .log-entries {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .log-entry {
            padding: 20px;
            border-radius: 15px;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            border-right: 5px solid transparent;
            animation: slideIn 0.3s ease-out;
            background: rgba(255, 255, 255, 0.05);
        }
        
        @keyframes slideIn {
            from { transform: translateX(20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .log-entry.info { border-color: var(--secondary); color: #80deea; }
        .log-entry.success { border-color: var(--success); color: #a5d6a7; }
        .log-entry.error { border-color: var(--error); color: #ef9a9a; }
        .log-entry.warning { border-color: var(--warning); color: #ffcc80; }
        
        .spinner {
            width: 28px;
            height: 28px;
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
            display: inline-block;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .progress-container {
            width: 100%;
            background: #e0e0e0;
            border-radius: 10px;
            height: 15px;
            margin: 30px 0;
            overflow: hidden;
            position: relative;
            z-index: 1;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            border-radius: 10px;
            transition: width 0.5s ease-out;
            width: 0%;
        }
        
        @media (max-width: 768px) {
            .container { padding: 25px; }
            .test-categories { grid-template-columns: 1fr; }
            .tables-container { grid-template-columns: 1fr; }
            .btn { min-width: 100%; margin-bottom: 20px; }
            h1 { font-size: 2.5rem; }
            .test-header { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª ØªØ³ØªØ±ÙˆÙ†Ø± Ø§Ø³Ú©ÛŒÙ…Ø§ Ù†Ø³Ø®Ù‡ Û±</h1>
        <div class="subtitle">
            Ø¢Ø²Ù…Ø§ÛŒØ´ Ú©Ø§Ù…Ù„ Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ Farsinglish - Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒØŒ Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§ Ùˆ Ø±ÙˆØ§Ø¨Ø·
        </div>
        
        <div class="test-header">
            <div class="header-info">
                <h2 style="color: white; margin-bottom: 15px; font-size: 2.2rem;">Ø¨Ø±Ø±Ø³ÛŒ Ø¬Ø§Ù…Ø¹ Ø§Ø³Ú©ÛŒÙ…Ø§</h2>
                <p style="color: #e1bee7; line-height: 1.8; font-size: 1.1rem;">
                    Ø§ÛŒÙ† ØªØ³ØªØ±ÙˆÙ†Ø± Û±Û² ØªØ³Øª Ù…Ø®ØªÙ„Ù Ø±Ø§ Ø±ÙˆÛŒ Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ ØªØ§ Ø§Ø² ØµØ­Øª Ø·Ø±Ø§Ø­ÛŒ 
                    Ø¬Ø¯Ø§ÙˆÙ„ØŒ Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§ Ùˆ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø­Ø§ØµÙ„ Ú©Ù†Ø¯.
                </p>
            </div>
            
            <div class="schema-preview">
                <div class="preview-title">
                    <span>ğŸ“Š</span> Ø¢Ù…Ø§Ø± Ø§Ø³Ú©ÛŒÙ…Ø§
                </div>
                <div class="preview-item">
                    <span class="preview-label">ØªØ¹Ø¯Ø§Ø¯ Ø¬Ø¯Ø§ÙˆÙ„:</span>
                    <span class="preview-value">Û³</span>
                </div>
                <div class="preview-item">
                    <span class="preview-label">ØªØ¹Ø¯Ø§Ø¯ ÙÛŒÙ„Ø¯Ù‡Ø§:</span>
                    <span class="preview-value">Û²Û²</span>
                </div>
                <div class="preview-item">
                    <span class="preview-label">ØªØ¹Ø¯Ø§Ø¯ Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§:</span>
                    <span class="preview-value">Û±Û²</span>
                </div>
                <div class="preview-item">
                    <span class="preview-label">ØªØ¹Ø¯Ø§Ø¯ ØªØ³Øªâ€ŒÙ‡Ø§:</span>
                    <span class="preview-value">Û±Û²</span>
                </div>
            </div>
        </div>
        
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        
        <div class="controls">
            <button class="btn btn-primary" onclick="runAllTests()" id="runAllBtn">
                <span class="btn-icon">ğŸš€</span> Ø§Ø¬Ø±Ø§ÛŒ ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§
            </button>
            <button class="btn btn-secondary" onclick="runValidationTests()" id="validationBtn">
                <span class="btn-icon">âœ…</span> ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
            </button>
            <button class="btn btn-success" onclick="runSchemaTests()" id="schemaBtn">
                <span class="btn-icon">ğŸ“Š</span> ØªØ³Øª Ø³Ø§Ø®ØªØ§Ø±
            </button>
            <button class="btn btn-warning" onclick="runPerformanceTests()" id="performanceBtn">
                <span class="btn-icon">âš¡</span> ØªØ³Øª Ø¹Ù…Ù„Ú©Ø±Ø¯
            </button>
            <button class="btn btn-error" onclick="resetAllTests()" id="resetBtn">
                <span class="btn-icon">ğŸ”„</span> Ø±ÛŒØ³Øª ØªØ³Øªâ€ŒÙ‡Ø§
            </button>
        </div>
        
        <div id="testResults" class="test-categories">
            <!-- ØªØ³Øªâ€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
        </div>
        
        <div class="schema-visualizer" id="schemaVisualizer">
            <div class="visualizer-header">
                <div class="visualizer-title">ğŸ“Š Ù†Ù…Ø§ÛŒØ´ Ú¯Ø±Ø§ÙÛŒÚ©ÛŒ Ø§Ø³Ú©ÛŒÙ…Ø§</div>
                <p style="color: #757575; font-size: 1.1rem;">Ø³Ø§Ø®ØªØ§Ø± Ø¬Ø¯Ø§ÙˆÙ„ Ùˆ Ø±ÙˆØ§Ø¨Ø· Ø¨Ù‡ ØµÙˆØ±Øª Ø¨ØµØ±ÛŒ</p>
            </div>
            <div class="tables-container" id="tablesVisualization">
                <!-- Ø¬Ø¯Ø§ÙˆÙ„ Ø¨Ù‡ ØµÙˆØ±Øª Ø¨ØµØ±ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
            </div>
        </div>
        
        <div class="log-container">
            <div class="log-header">
                <div class="log-title">ğŸ“ Ù„Ø§Ú¯ Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§</div>
                <button onclick="clearLog()" style="background: #37474f; color: #bbdefb; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-weight: bold;">
                    Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ Ù„Ø§Ú¯
                </button>
            </div>
            <div class="log-entries" id="logOutput"></div>
        </div>
    </div>

    <script>
        // ==================== Ø³ÛŒØ³ØªÙ… Ù„Ø§Ú¯â€ŒÚ¯ÛŒØ±ÛŒ ====================
        class Logger {
            constructor() {
                this.logOutput = document.getElementById('logOutput');
                this.logCount = 0;
            }
            
            add(type, message) {
                this.logCount++;
                const entry = document.createElement('div');
                entry.className = `log-entry ${type}`;
                
                const time = new Date().toLocaleTimeString('fa-IR', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                
                const icon = {
                    'info': 'ğŸ”µ',
                    'success': 'âœ…',
                    'error': 'âŒ',
                    'warning': 'âš ï¸'
                }[type];
                
                entry.textContent = `${icon} [${time}] ${message}`;
                this.logOutput.appendChild(entry);
                this.logOutput.scrollTop = this.logOutput.scrollHeight;
            }
            
            info(message) { this.add('info', message); }
            success(message) { this.add('success', message); }
            error(message) { this.add('error', message); }
            warning(message) { this.add('warning', message); }
            
            clear() {
                this.logOutput.innerHTML = '';
                this.info('Ù„Ø§Ú¯â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯ - Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯');
            }
        }

        // ==================== ØªØ³ØªØ±ÙˆÙ†Ø± Ø§Ø³Ú©ÛŒÙ…Ø§ ====================
        class SchemaTester {
            constructor() {
                this.logger = new Logger();
                this.stats = {
                    total: 0,
                    passed: 0,
                    failed: 0,
                    startTime: null,
                    currentTest: 0,
                    totalTests: 12
                };
                
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø³Ú©ÛŒÙ…Ø§
                this.loadSchema();
            }
            
            loadSchema() {
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø³ØªÛŒ Ø§Ø³Ú©ÛŒÙ…Ø§
                this.schema = {
                    "users": {
                        keyPath: "id",
                        autoIncrement: false,
                        indexes: [
                            { name: "email_idx", keyPath: "email", options: { unique: true } },
                            { name: "level_idx", keyPath: "level", options: { } },
                            { name: "xp_idx", keyPath: "xp", options: { } }
                        ]
                    },
                    "lessons": {
                        keyPath: "lessonId",
                        autoIncrement: false,
                        indexes: [
                            { name: "level_idx", keyPath: "level", options: { } },
                            { name: "isLocked_idx", keyPath: "isLocked", options: { } },
                            { name: "prerequisites_idx", keyPath: "prerequisites", options: { multiEntry: true } }
                        ]
                    },
                    "progress": {
                        keyPath: ["userId", "lessonId"],
                        autoIncrement: false,
                        indexes: [
                            { name: "userId_idx", keyPath: "userId", options: { } },
                            { name: "lessonId_idx", keyPath: "lessonId", options: { } },
                            { name: "status_idx", keyPath: "status", options: { } },
                            { name: "nextReview_idx", keyPath: "nextReviewDate", options: { } }
                        ]
                    }
                };
                    
                this.validators = {
                    validateUser(userData) {
                        const errors = [];
                        if (!userData.id || userData.id.length !== 36) {
                            errors.push("Ø´Ù†Ø§Ø³Ù‡ Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª (Ø¨Ø§ÛŒØ¯ Û³Û¶ Ú©Ø§Ø±Ø§Ú©ØªØ± Ø¨Ø§Ø´Ø¯)");
                        }
                        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                        if (!emailRegex.test(userData.email)) {
                            errors.push("ÙØ±Ù…Øª Ø§ÛŒÙ…ÛŒÙ„ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª");
                        }
                        if (userData.level < 1 || userData.level > 100) {
                            errors.push("Ø³Ø·Ø­ Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ÛŒØ¯ Ø¨ÛŒÙ† Û± ØªØ§ Û±Û°Û° Ø¨Ø§Ø´Ø¯");
                        }
                        return { isValid: errors.length === 0, errors };
                    },
                    
                    validateLesson(lessonData) {
                        const errors = [];
                        const lessonIdRegex = /^\d+_\d+_\d+$/;
                        if (!lessonIdRegex.test(lessonData.lessonId)) {
                            errors.push("Ø´Ù†Ø§Ø³Ù‡ Ø¯Ø±Ø³ Ø¨Ø§ÛŒØ¯ ÙØ±Ù…Øª level_chapter_lesson Ø¨Ø§Ø´Ø¯");
                        }
                        if (lessonData.level < 1 || lessonData.level > 10) {
                            errors.push("Ø³Ø·Ø­ Ø¯Ø±Ø³ Ø¨Ø§ÛŒØ¯ Ø¨ÛŒÙ† Û± ØªØ§ Û±Û° Ø¨Ø§Ø´Ø¯");
                        }
                        if (!lessonData.content || !lessonData.content.text) {
                            errors.push("Ø¯Ø±Ø³ Ø¨Ø§ÛŒØ¯ Ù…Ø­ØªÙˆØ§ÛŒ Ù…ØªÙ†ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯");
                        }
                        return { isValid: errors.length === 0, errors };
                    },
                    
                    validateProgress(progressData) {
                        const errors = [];
                        const validStatuses = ['not_started', 'in_progress', 'completed', 'review'];
                        if (!progressData.userId || !progressData.lessonId) {
                            errors.push("Ø´Ù†Ø§Ø³Ù‡ Ú©Ø§Ø±Ø¨Ø± Ùˆ Ø¯Ø±Ø³ Ø§Ù„Ø²Ø§Ù…ÛŒ Ø§Ø³Øª");
                        }
                        if (!validStatuses.includes(progressData.status)) {
                            errors.push(`ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§ÛŒØ¯ ÛŒÚ©ÛŒ Ø§Ø² Ø§ÛŒÙ† Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø§Ø´Ø¯: ${validStatuses.join(', ')}`);
                        }
                        if (progressData.score < 0 || progressData.score > 100) {
                            errors.push("Ø§Ù…ØªÛŒØ§Ø² Ø¨Ø§ÛŒØ¯ Ø¨ÛŒÙ† Û° ØªØ§ Û±Û°Û° Ø¨Ø§Ø´Ø¯");
                        }
                        return { isValid: errors.length === 0, errors };
                    }
                };
                    
                this.srsDefaults = {
                    easeFactor: 2.5,
                    interval: 1,
                    repetitions: 0,
                    nextReview: null
                };
                    
                this.logger.info('Ø§Ø³Ú©ÛŒÙ…Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯');
            }
            
            updateStats() {
                document.getElementById('progressBar').style.width = 
                    `${(this.stats.currentTest / this.stats.totalTests) * 100}%`;
            }
            
            createCategoryCard(title, icon, categoryId) {
                const card = document.createElement('div');
                card.className = 'category-card';
                card.id = `category-${categoryId}`;
                
                card.innerHTML = `
                    <div class="category-header">
                        <div class="category-title">
                            <span class="category-icon">${icon}</span>
                            ${title}
                        </div>
                        <div class="category-stats">
                            <div class="stat-badge" id="stats-${categoryId}">Û°/Û°</div>
                        </div>
                    </div>
                    <div class="test-items" id="tests-${categoryId}">
                        <!-- ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ† Ø¯Ø³ØªÙ‡ -->
                    </div>
                `;
                
                return card;
            }
            
            createTestElement(name, description, categoryId) {
                const testDiv = document.createElement('div');
                testDiv.className = 'test-item';
                
                const time = new Date().toLocaleTimeString('fa-IR', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                
                testDiv.innerHTML = `
                    <div class="test-header-row">
                        <div class="test-name">
                            <span>ğŸ“‹</span> ${name}
                        </div>
                        <div class="test-time">${time}</div>
                    </div>
                    <div class="test-desc">${description}</div>
                    <div class="test-details">
                        <div class="detail-row">
                            <span class="detail-label">ÙˆØ¶Ø¹ÛŒØª:</span>
                            <span class="detail-value" id="status-${categoryId}-${name.replace(/\s+/g, '-')}">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±...</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø²Ù…Ø§Ù† Ø§Ø¬Ø±Ø§:</span>
                            <span class="detail-value" id="time-${categoryId}-${name.replace(/\s+/g, '-')}">-</span>
                        </div>
                        <div id="details-${categoryId}-${name.replace(/\s+/g, '-')}"></div>
                    </div>
                `;
                
                return testDiv;
            }
            
            async runTest(testFn, name, description, categoryId) {
                this.stats.total++;
                this.stats.currentTest++;
                this.updateStats();
                
                const testElement = this.createTestElement(name, description, categoryId);
                document.getElementById(`tests-${categoryId}`).appendChild(testElement);
                
                const statusEl = document.getElementById(`status-${categoryId}-${name.replace(/\s+/g, '-')}`);
                const timeEl = document.getElementById(`time-${categoryId}-${name.replace(/\s+/g, '-')}`);
                const detailsEl = document.getElementById(`details-${categoryId}-${name.replace(/\s+/g, '-')}`);
                
                testElement.classList.add('running');
                statusEl.textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§...';
                statusEl.className = 'detail-value';
                
                try {
                    const startTime = Date.now();
                    const result = await testFn();
                    const duration = Date.now() - startTime;
                    
                    timeEl.textContent = `${duration}ms`;
                    
                    if (result.success) {
                        this.stats.passed++;
                        testElement.classList.remove('running');
                        testElement.classList.add('passed');
                        statusEl.textContent = 'âœ… Ù…ÙˆÙÙ‚';
                        statusEl.className = 'detail-value success';
                        detailsEl.innerHTML = result.details || '';
                        this.logger.success(`${name}: Ù…ÙˆÙÙ‚ (${duration}ms)`);
                    } else {
                        this.stats.failed++;
                        testElement.classList.remove('running');
                        testElement.classList.add('failed');
                        statusEl.textContent = 'âŒ Ù†Ø§Ù…ÙˆÙÙ‚';
                        statusEl.className = 'detail-value error';
                        detailsEl.innerHTML = `
                            <div class="validation-result">
                                <strong>Ø®Ø·Ø§Ù‡Ø§:</strong>
                                <div class="validation-errors">
                                    ${result.errors ? result.errors.map(err => `
                                        <div class="error-item">
                                            <span>âŒ</span> ${err}
                                        </div>
                                    `).join('') : 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ'}
                                </div>
                            </div>
                        `;
                        this.logger.error(`${name}: Ù†Ø§Ù…ÙˆÙÙ‚ - ${result.message || ''}`);
                    }
                } catch (error) {
                    this.stats.failed++;
                    testElement.classList.remove('running');
                    testElement.classList.add('failed');
                    statusEl.textContent = 'ğŸ’¥ Ø®Ø·Ø§';
                    statusEl.className = 'detail-value error';
                    timeEl.textContent = '-';
                    detailsEl.innerHTML = `
                        <div class="validation-result">
                            <strong>Ø®Ø·Ø§ÛŒ Ø§Ø¬Ø±Ø§:</strong>
                            <div class="validation-errors">
                                <div class="error-item">
                                    <span>ğŸ’¥</span> ${error.message}
                                </div>
                            </div>
                        </div>
                    `;
                    this.logger.error(`${name}: Ø®Ø·Ø§ÛŒ Ø§Ø¬Ø±Ø§ - ${error.message}`);
                }
                
                // Ø¢Ù¾Ø¯ÛŒØª Ø¢Ù…Ø§Ø± Ø¯Ø³ØªÙ‡
                const categoryTests = document.querySelectorAll(`#tests-${categoryId} .test-item`).length;
                const categoryPassed = document.querySelectorAll(`#tests-${categoryId} .test-item.passed`).length;
                document.getElementById(`stats-${categoryId}`).textContent = 
                    `${categoryPassed}/${categoryTests}`;
                
                this.updateStats();
                await new Promise(resolve => setTimeout(resolve, 300));
            }
            
            // ==================== ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ====================
            
            async testUserValidation() {
                const validUser = {
                    id: '550e8400-e29b-41d4-a716-446655440000',
                    email: 'test@farsinglish.com',
                    username: 'Ú©Ø§Ø±Ø¨Ø± ØªØ³Øª',
                    level: 5,
                    xp: 1000,
                    streakDays: 7
                };
                
                const invalidUser = {
                    id: 'invalid',
                    email: 'invalid-email',
                    level: 150
                };
                
                const validResult = this.validators.validateUser(validUser);
                const invalidResult = this.validators.validateUser(invalidUser);
                
                return {
                    success: validResult.isValid && !invalidResult.isValid,
                    errors: invalidResult.errors,
                    details: `
                        <div class="detail-row">
                            <span class="detail-label">Ú©Ø§Ø±Ø¨Ø± Ù…Ø¹ØªØ¨Ø±:</span>
                            <span class="detail-value success">âœ… Ù¾Ø°ÛŒØ±ÙØªÙ‡ Ø´Ø¯</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ù…Ø¹ØªØ¨Ø±:</span>
                            <span class="detail-value ${invalidResult.errors.length > 0 ? 'error' : 'success'}">
                                ${invalidResult.errors.length} Ø®Ø·Ø§ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ø¯
                            </span>
                        </div>
                    `
                };
            }
            
            async testLessonValidation() {
                const validLesson = {
                    lessonId: '1_2_3',
                    title: 'Ø¯Ø±Ø³ ØªØ³Øª',
                    level: 3,
                    content: { text: 'Ù…ØªÙ† Ø¯Ø±Ø³' },
                    vocabulary: ['word1', 'word2'],
                    isLocked: true
                };
                
                const invalidLesson = {
                    lessonId: 'invalid_format',
                    level: 15,
                    content: {}
                };
                
                const validResult = this.validators.validateLesson(validLesson);
                const invalidResult = this.validators.validateLesson(invalidLesson);
                
                return {
                    success: validResult.isValid && !invalidResult.isValid,
                    errors: invalidResult.errors,
                    details: `
                        <div class="detail-row">
                            <span class="detail-label">Ø¯Ø±Ø³ Ù…Ø¹ØªØ¨Ø±:</span>
                            <span class="detail-value success">âœ… ÙØ±Ù…Øª ØµØ­ÛŒØ­</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø¯Ø±Ø³ Ù†Ø§Ù…Ø¹ØªØ¨Ø±:</span>
                            <span class="detail-value ${invalidResult.errors.length > 0 ? 'error' : 'success'}">
                                ${invalidResult.errors.length} Ø®Ø·Ø§ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
                            </span>
                        </div>
                    `
                };
            }
            
            async testProgressValidation() {
                const validProgress = {
                    userId: 'user123',
                    lessonId: '1_1_1',
                    status: 'in_progress',
                    score: 85,
                    lastReviewDate: new Date().toISOString(),
                    nextReviewDate: new Date(Date.now() + 86400000).toISOString()
                };
                
                const invalidProgress = {
                    userId: '',
                    lessonId: '',
                    status: 'invalid_status',
                    score: 150
                };
                
                const validResult = this.validators.validateProgress(validProgress);
                const invalidResult = this.validators.validateProgress(invalidProgress);
                
                return {
                    success: validResult.isValid && !invalidResult.isValid,
                    errors: invalidResult.errors,
                    details: `
                        <div class="detail-row">
                            <span class="detail-label">Ù¾ÛŒØ´Ø±ÙØª Ù…Ø¹ØªØ¨Ø±:</span>
                            <span class="detail-value success">âœ… ÙˆØ¶Ø¹ÛŒØª Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ù¾ÛŒØ´Ø±ÙØª Ù†Ø§Ù…Ø¹ØªØ¨Ø±:</span>
                            <span class="detail-value ${invalidResult.errors.length > 0 ? 'error' : 'success'}">
                                ${invalidResult.errors.length} Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                            </span>
                        </div>
                    `
                };
            }
            
            async testEmailValidation() {
                const testCases = [
                    {
                        email: "user@farsinglish.com",
                        expected: true,
                        description: "Ø§ÛŒÙ…ÛŒÙ„ Ù…Ø¹ØªØ¨Ø±"
                    },
                    {
                        email: "user.test@sub.domain.com",
                        expected: true,
                        description: "Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ø§ Ø³Ø§Ø¨â€ŒØ¯Ø§Ù…Ù†Ù‡"
                    },
                    {
                        email: "invalid-email",
                        expected: false,
                        description: "Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ø¯ÙˆÙ† @"
                    },
                    {
                        email: "user@",
                        expected: false,
                        description: "Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ø¯ÙˆÙ† Ø¯Ø§Ù…Ù†Ù‡"
                    },
                    {
                        email: "@domain.com",
                        expected: false,
                        description: "Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ø¯ÙˆÙ† Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ"
                    },
                    {
                        email: "user@domain",
                        expected: false,
                        description: "Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ø¯ÙˆÙ† Ù¾Ø³ÙˆÙ†Ø¯ Ø¯Ø§Ù…Ù†Ù‡"
                    },
                    {
                        email: "user@domain.",
                        expected: false,
                        description: "Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ø§ Ù†Ù‚Ø·Ù‡ Ø§Ù†ØªÙ‡Ø§ÛŒÛŒ"
                    },
                    {
                        email: "user.name+tag@domain.com",
                        expected: true,
                        description: "Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ø§ Ù¾Ù„Ø§Ø³ ØªÚ¯"
                    }
                ];

                let passedTests = 0;
                const details = [];

                testCases.forEach((testCase, index) => {
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    const isValid = emailRegex.test(testCase.email);
                    const testPassed = isValid === testCase.expected;
                    
                    if (testPassed) passedTests++;
                    
                    details.push(`
                        <div class="detail-row">
                            <span class="detail-label">${testCase.description}:</span>
                            <span class="detail-value ${testPassed ? 'success' : 'error'}">
                                ${testCase.email} â†’ ${isValid ? 'Ù…Ø¹ØªØ¨Ø±' : 'Ù†Ø§Ù…Ø¹ØªØ¨Ø±'} 
                                ${testPassed ? 'âœ…' : 'âŒ'}
                            </span>
                        </div>
                    `);
                });

                const successRate = Math.round((passedTests / testCases.length) * 100);

                return {
                    success: passedTests === testCases.length,
                    details: `
                        <div class="detail-row">
                            <span class="detail-label">ØªØ¹Ø¯Ø§Ø¯ ØªØ³Øªâ€ŒÙ‡Ø§:</span>
                            <span class="detail-value">${testCases.length} ØªØ³Øª</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ù…ÙˆÙÙ‚ÛŒØª:</span>
                            <span class="detail-value ${passedTests === testCases.length ? 'success' : 'warning'}">
                                ${passedTests}/${testCases.length} (${successRate}%)
                            </span>
                        </div>
                        ${details.join('')}
                        <div class="detail-row">
                            <span class="detail-label">ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ:</span>
                            <span class="detail-value info">
                                Ø¨Ø±Ø±Ø³ÛŒ ÛŒÚ©ØªØ§ÛŒÛŒ Ø§ÛŒÙ…ÛŒÙ„ Ø¯Ø± Ø³Ø·Ø­ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯
                            </span>
                        </div>
                    `
                };
            }
            
            // ==================== ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø®ØªØ§Ø± ====================
            
            async testSchemaStructure() {
                const requiredTables = ['users', 'lessons', 'progress'];
                const tablesExist = Object.keys(this.schema).every(table => 
                    requiredTables.includes(table)
                );
                
                const usersHasKeyPath = this.schema.users.keyPath === 'id';
                const lessonsHasKeyPath = this.schema.lessons.keyPath === 'lessonId';
                const progressHasCompoundKey = Array.isArray(this.schema.progress.keyPath) && 
                    this.schema.progress.keyPath.length === 2;
                
                return {
                    success: tablesExist && usersHasKeyPath && lessonsHasKeyPath && progressHasCompoundKey,
                    details: `
                        <div class="detail-row">
                            <span class="detail-label">ØªØ¹Ø¯Ø§Ø¯ Ø¬Ø¯Ø§ÙˆÙ„:</span>
                            <span class="detail-value">${Object.keys(this.schema).length} Ø¬Ø¯ÙˆÙ„</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ú©Ù„ÛŒØ¯ Ø§ØµÙ„ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†:</span>
                            <span class="detail-value ${usersHasKeyPath ? 'success' : 'error'}">
                                ${this.schema.users.keyPath}
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ú©Ù„ÛŒØ¯ Ø§ØµÙ„ÛŒ Ø¯Ø±ÙˆØ³:</span>
                            <span class="detail-value ${lessonsHasKeyPath ? 'success' : 'error'}">
                                ${this.schema.lessons.keyPath}
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ú©Ù„ÛŒØ¯ Ø§ØµÙ„ÛŒ Ù¾ÛŒØ´Ø±ÙØª:</span>
                            <span class="detail-value ${progressHasCompoundKey ? 'success' : 'error'}">
                                [${this.schema.progress.keyPath.join(', ')}]
                            </span>
                        </div>
                    `
                };
            }
            
            async testIndexesStructure() {
                const usersIndexes = this.schema.users.indexes;
                const lessonsIndexes = this.schema.lessons.indexes;
                const progressIndexes = this.schema.progress.indexes;
                
                const usersHasEmailIndex = usersIndexes.some(idx => idx.name === 'email_idx');
                const usersHasLevelIndex = usersIndexes.some(idx => idx.name === 'level_idx');
                const progressHasNextReviewIndex = progressIndexes.some(idx => idx.name === 'nextReview_idx');
                
                const totalIndexes = usersIndexes.length + lessonsIndexes.length + progressIndexes.length;
                
                return {
                    success: usersHasEmailIndex && usersHasLevelIndex && progressHasNextReviewIndex,
                    details: `
                        <div class="detail-row">
                            <span class="detail-label">Ú©Ù„ Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§:</span>
                            <span class="detail-value">${totalIndexes} Ø§ÛŒÙ†Ø¯Ú©Ø³</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø§ÛŒÙ†Ø¯Ú©Ø³ Ø§ÛŒÙ…ÛŒÙ„:</span>
                            <span class="detail-value ${usersHasEmailIndex ? 'success' : 'error'}">
                                ${usersHasEmailIndex ? 'âœ… Ù…ÙˆØ¬ÙˆØ¯' : 'âŒ Ù…ÙÙ‚ÙˆØ¯'}
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø§ÛŒÙ†Ø¯Ú©Ø³ Ø³Ø·Ø­:</span>
                            <span class="detail-value ${usersHasLevelIndex ? 'success' : 'error'}">
                                ${usersHasLevelIndex ? 'âœ… Ù…ÙˆØ¬ÙˆØ¯' : 'âŒ Ù…ÙÙ‚ÙˆØ¯'}
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø§ÛŒÙ†Ø¯Ú©Ø³ Ù…Ø±ÙˆØ± Ø¨Ø¹Ø¯ÛŒ:</span>
                            <span class="detail-value ${progressHasNextReviewIndex ? 'success' : 'error'}">
                                ${progressHasNextReviewIndex ? 'âœ… Ù…ÙˆØ¬ÙˆØ¯' : 'âŒ Ù…ÙÙ‚ÙˆØ¯'}
                            </span>
                        </div>
                    `
                };
            }
            
            async testForeignKeys() {
                const progressSchema = this.schema.progress;
                const hasUserIdIndex = progressSchema.indexes.some(idx => idx.name === 'userId_idx');
                const hasLessonIdIndex = progressSchema.indexes.some(idx => idx.name === 'lessonId_idx');
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒÙ†Ú©Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ Ø®Ø§Ø±Ø¬ÛŒ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ù†Ø¯
                const keyPathIncludesUserId = progressSchema.keyPath.includes('userId');
                const keyPathIncludesLessonId = progressSchema.keyPath.includes('lessonId');
                
                return {
                    success: hasUserIdIndex && hasLessonIdIndex && keyPathIncludesUserId && keyPathIncludesLessonId,
                    details: `
                        <div class="detail-row">
                            <span class="detail-label">Ø§ÛŒÙ†Ø¯Ú©Ø³ userId:</span>
                            <span class="detail-value ${hasUserIdIndex ? 'success' : 'error'}">
                                ${hasUserIdIndex ? 'âœ… Ø¨Ø±Ø§ÛŒ Ø¬Ø³ØªØ¬ÙˆÛŒ Ø³Ø±ÛŒØ¹' : 'âŒ Ù…ÙÙ‚ÙˆØ¯'}
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø§ÛŒÙ†Ø¯Ú©Ø³ lessonId:</span>
                            <span class="detail-value ${hasLessonIdIndex ? 'success' : 'error'}">
                                ${hasLessonIdIndex ? 'âœ… Ø¨Ø±Ø§ÛŒ Ø¬Ø³ØªØ¬ÙˆÛŒ Ø³Ø±ÛŒØ¹' : 'âŒ Ù…ÙÙ‚ÙˆØ¯'}
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø±Ø§Ø¨Ø·Ù‡ Ø¨Ø§ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†:</span>
                            <span class="detail-value ${keyPathIncludesUserId ? 'success' : 'error'}">
                                ${keyPathIncludesUserId ? 'âœ… ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡' : 'âŒ ØªØ¹Ø±ÛŒÙ Ù†Ø´Ø¯Ù‡'}
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø±Ø§Ø¨Ø·Ù‡ Ø¨Ø§ Ø¯Ø±ÙˆØ³:</span>
                            <span class="detail-value ${keyPathIncludesLessonId ? 'success' : 'error'}">
                                ${keyPathIncludesLessonId ? 'âœ… ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡' : 'âŒ ØªØ¹Ø±ÛŒÙ Ù†Ø´Ø¯Ù‡'}
                            </span>
                        </div>
                    `
                };
            }
            
            async testSRSDefaults() {
                const defaults = this.srsDefaults;
                
                const hasEaseFactor = typeof defaults.easeFactor === 'number' && defaults.easeFactor > 1;
                const hasInterval = typeof defaults.interval === 'number' && defaults.interval >= 1;
                const hasRepetitions = typeof defaults.repetitions === 'number';
                const hasNextReview = defaults.nextReview === null;
                
                return {
                    success: hasEaseFactor && hasInterval && hasRepetitions && hasNextReview,
                    details: `
                        <div class="detail-row">
                            <span class="detail-label">Ø¶Ø±ÛŒØ¨ Ø¢Ø³Ø§Ù†ÛŒ (easeFactor):</span>
                            <span class="detail-value ${hasEaseFactor ? 'success' : 'error'}">
                                ${defaults.easeFactor}
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">ÙØ§ØµÙ„Ù‡ (interval):</span>
                            <span class="detail-value ${hasInterval ? 'success' : 'error'}">
                                ${defaults.interval} Ø±ÙˆØ²
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">ØªÚ©Ø±Ø§Ø±Ù‡Ø§ (repetitions):</span>
                            <span class="detail-value ${hasRepetitions ? 'success' : 'error'}">
                                ${defaults.repetitions}
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ù…Ø±ÙˆØ± Ø¨Ø¹Ø¯ÛŒ (nextReview):</span>
                            <span class="detail-value ${hasNextReview ? 'success' : 'error'}">
                                ${defaults.nextReview === null ? 'null (Ù¾ÛŒØ´â€ŒÙØ±Ø¶)' : 'ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡'}
                            </span>
                        </div>
                    `
                };
            }
            
            // ==================== ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ ====================
            
            async testSchemaPerformance() {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¹Ù…Ù„ÛŒØ§Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø¹Ù…Ù„Ú©Ø±Ø¯
                const startTime = Date.now();
                let operations = 0;
                
                // Ø¹Ù…Ù„ÛŒØ§Øª Û±: Ø¨Ø±Ø±Ø³ÛŒ Ø³Ø§Ø®ØªØ§Ø± Ø§Ø³Ú©ÛŒÙ…Ø§
                for (let i = 0; i < 1000; i++) {
                    const tables = Object.keys(this.schema);
                    operations++;
                }
                
                // Ø¹Ù…Ù„ÛŒØ§Øª Û²: Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§
                for (const tableName in this.schema) {
                    const table = this.schema[tableName];
                    if (table.indexes) {
                        operations += table.indexes.length;
                    }
                }
                
                // Ø¹Ù…Ù„ÛŒØ§Øª Û³: Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ù†Ù…ÙˆÙ†Ù‡
                const testUser = {
                    id: 'test-id-123',
                    email: 'test@perf.com',
                    level: 5
                };
                
                for (let i = 0; i < 100; i++) {
                    this.validators.validateUser(testUser);
                    operations++;
                }
                
                const duration = Date.now() - startTime;
                const opsPerSecond = Math.round((operations / duration) * 1000);
                
                return {
                    success: duration < 1000, // Ú©Ù…ØªØ± Ø§Ø² Û± Ø«Ø§Ù†ÛŒÙ‡
                    details: `
                        <div class="detail-row">
                            <span class="detail-label">Ø²Ù…Ø§Ù† Ø§Ø¬Ø±Ø§:</span>
                            <span class="detail-value ${duration < 1000 ? 'success' : 'warning'}">
                                ${duration}ms
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø¹Ù…Ù„ÛŒØ§Øª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡:</span>
                            <span class="detail-value">${operations} Ø¹Ù…Ù„ÛŒØ§Øª</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø³Ø±Ø¹Øª:</span>
                            <span class="detail-value ${opsPerSecond > 1000 ? 'success' : 'warning'}">
                                ${opsPerSecond} Ø¹Ù…Ù„ÛŒØ§Øª/Ø«Ø§Ù†ÛŒÙ‡
                            </span>
                        </div>
                    `
                };
            }
            
            async testMemoryUsage() {
                // ØªØ®Ù…ÛŒÙ† Ù…ØµØ±Ù Ø­Ø§ÙØ¸Ù‡
                const schemaSize = JSON.stringify(this.schema).length;
                const validatorsSize = JSON.stringify(this.validators).length;
                const totalSizeKB = Math.round((schemaSize + validatorsSize) / 1024 * 100) / 100;
                
                return {
                    success: totalSizeKB < 100, // Ú©Ù…ØªØ± Ø§Ø² Û±Û°Û° Ú©ÛŒÙ„ÙˆØ¨Ø§ÛŒØª
                    details: `
                        <div class="detail-row">
                            <span class="detail-label">Ø­Ø¬Ù… Ø§Ø³Ú©ÛŒÙ…Ø§:</span>
                            <span class="detail-value">${Math.round(schemaSize / 1024 * 100) / 100} KB</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø­Ø¬Ù… Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬â€ŒÙ‡Ø§:</span>
                            <span class="detail-value">${Math.round(validatorsSize / 1024 * 100) / 100} KB</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ú©Ù„ Ù…ØµØ±Ù Ø­Ø§ÙØ¸Ù‡:</span>
                            <span class="detail-value ${totalSizeKB < 100 ? 'success' : 'warning'}">
                                ${totalSizeKB} KB
                            </span>
                        </div>
                    `
                };
            }
            
            async testQueryOptimization() {
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡ Ø¨Ø±Ø§ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø±Ø§ÛŒØ¬
                const commonQueries = [
                    { name: 'Ø¯Ø±ÛŒØ§ÙØª Ú©Ø§Ø±Ø¨Ø± ØªÙˆØ³Ø· Ø§ÛŒÙ…ÛŒÙ„', index: 'email_idx', exists: false },
                    { name: 'Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø±ÙˆØ³ ÛŒÚ© Ø³Ø·Ø­', index: 'level_idx', exists: false },
                    { name: 'Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø±ÙˆØ³ Ù‚ÙÙ„/Ø¨Ø§Ø²', index: 'isLocked_idx', exists: false },
                    { name: 'Ø¯Ø±ÛŒØ§ÙØª Ù…Ø±ÙˆØ±Ù‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ', index: 'nextReview_idx', exists: false }
                ];
                
                // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§
                commonQueries[0].exists = this.schema.users.indexes.some(idx => idx.name === 'email_idx');
                commonQueries[1].exists = this.schema.lessons.indexes.some(idx => idx.name === 'level_idx');
                commonQueries[2].exists = this.schema.lessons.indexes.some(idx => idx.name === 'isLocked_idx');
                commonQueries[3].exists = this.schema.progress.indexes.some(idx => idx.name === 'nextReview_idx');
                
                const allIndexesExist = commonQueries.every(query => query.exists);
                
                const detailsHTML = commonQueries.map(query => `
                    <div class="detail-row">
                        <span class="detail-label">${query.name}:</span>
                        <span class="detail-value ${query.exists ? 'success' : 'error'}">
                            ${query.exists ? `âœ… ${query.index}` : `âŒ ${query.index} Ù…ÙÙ‚ÙˆØ¯`}
                        </span>
                    </div>
                `).join('');
                
                return {
                    success: allIndexesExist,
                    details: detailsHTML
                };
            }
            
            async testDataIntegrity() {
                // Ø¨Ø±Ø±Ø³ÛŒ ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                const tests = [
                    { name: 'Ú©Ù„ÛŒØ¯ Ø§ØµÙ„ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù…Ù†Ø­ØµØ±Ø¨Ù‡â€ŒÙØ±Ø¯ Ø§Ø³Øª', passed: this.schema.users.keyPath === 'id' },
                    { name: 'Ú©Ù„ÛŒØ¯ Ø§ØµÙ„ÛŒ Ø¯Ø±Ø³ Ù…Ù†Ø­ØµØ±Ø¨Ù‡â€ŒÙØ±Ø¯ Ø§Ø³Øª', passed: this.schema.lessons.keyPath === 'lessonId' },
                    { name: 'Ø§ÛŒÙ…ÛŒÙ„ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ÛŒÚ©ØªØ§ Ø§Ø³Øª', passed: this.schema.users.indexes.some(idx => 
                        idx.name === 'email_idx' && idx.options.unique === true) },
                    { name: 'ÙˆØ¶Ø¹ÛŒØª Ù¾ÛŒØ´Ø±ÙØª Ù…Ù‚Ø§Ø¯ÛŒØ± Ù…Ø¹ØªØ¨Ø± Ø¯Ø§Ø±Ø¯', passed: true },
                    { name: 'Ø§Ù…ØªÛŒØ§Ø² Ø¨ÛŒÙ† Û° ØªØ§ Û±Û°Û° Ø§Ø³Øª', passed: true }
                ];
                
                const allPassed = tests.every(test => test.passed);
                
                const detailsHTML = tests.map(test => `
                    <div class="detail-row">
                        <span class="detail-label">${test.name}:</span>
                        <span class="detail-value ${test.passed ? 'success' : 'error'}">
                            ${test.passed ? 'âœ…' : 'âŒ'}
                        </span>
                    </div>
                `).join('');
                
                return {
                    success: allPassed,
                    details: detailsHTML
                };
            }
            
            // ==================== Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ ====================
            
            async runAllTests() {
                // Ø±ÛŒØ³Øª Ú©Ø±Ø¯Ù†
                this.stats = {
                    total: 0,
                    passed: 0,
                    failed: 0,
                    startTime: Date.now(),
                    currentTest: 0,
                    totalTests: 12
                };
                
                document.getElementById('testResults').innerHTML = '';
                document.getElementById('progressBar').style.width = '0%';
                this.logger.clear();
                
                // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
                document.getElementById('runAllBtn').disabled = true;
                document.getElementById('runAllBtn').innerHTML = '<span class="spinner"></span> Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§...';
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ ØªØ³Øª
                const categories = [
                    { id: 'validation', title: 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¯Ø§Ø¯Ù‡', icon: 'âœ…' },
                    { id: 'structure', title: 'Ø³Ø§Ø®ØªØ§Ø± Ø§Ø³Ú©ÛŒÙ…Ø§', icon: 'ğŸ“Š' },
                    { id: 'performance', title: 'Ø¹Ù…Ù„Ú©Ø±Ø¯ Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ', icon: 'âš¡' }
                ];
                
                categories.forEach(category => {
                    document.getElementById('testResults').appendChild(
                        this.createCategoryCard(category.title, category.icon, category.id)
                    );
                });
                
                this.logger.info('Ø´Ø±ÙˆØ¹ Ø§Ø¬Ø±Ø§ÛŒ Û±Û² ØªØ³Øª Ø¬Ø§Ù…Ø¹ Ø§Ø³Ú©ÛŒÙ…Ø§...');
                
                // Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
                await this.runTest(() => this.testUserValidation(), 
                    'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ú©Ø§Ø±Ø¨Ø±', 'Ø¨Ø±Ø±Ø³ÛŒ ØµØ­Øª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±', 'validation');
                
                await this.runTest(() => this.testLessonValidation(), 
                    'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¯Ø±Ø³', 'Ø¨Ø±Ø±Ø³ÛŒ ØµØ­Øª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø³', 'validation');
                
                await this.runTest(() => this.testProgressValidation(), 
                    'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ù¾ÛŒØ´Ø±ÙØª', 'Ø¨Ø±Ø±Ø³ÛŒ ØµØ­Øª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØª', 'validation');
                
                await this.runTest(() => this.testEmailValidation(), 
                    'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø§ÛŒÙ…ÛŒÙ„', 'Ø¨Ø±Ø±Ø³ÛŒ ÙØ±Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø§ÛŒÙ…ÛŒÙ„', 'validation');
                
                // Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø®ØªØ§Ø±
                await this.runTest(() => this.testSchemaStructure(), 
                    'Ø³Ø§Ø®ØªØ§Ø± Ú©Ù„ÛŒ Ø§Ø³Ú©ÛŒÙ…Ø§', 'Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ø¬Ø¯Ø§ÙˆÙ„ Ùˆ Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ', 'structure');
                
                await this.runTest(() => this.testIndexesStructure(), 
                    'Ø³Ø§Ø®ØªØ§Ø± Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§', 'Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§ÛŒ ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡', 'structure');
                
                await this.runTest(() => this.testForeignKeys(), 
                    'Ø±ÙˆØ§Ø¨Ø· Ùˆ Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ Ø®Ø§Ø±Ø¬ÛŒ', 'Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø±ØªØ¨Ø§Ø· Ø¨ÛŒÙ† Ø¬Ø¯Ø§ÙˆÙ„', 'structure');
                
                await this.runTest(() => this.testSRSDefaults(), 
                    'ØªÙ†Ø¸ÛŒÙ…Ø§Øª SRS', 'Ø¨Ø±Ø±Ø³ÛŒ Ù…Ù‚Ø§Ø¯ÛŒØ± Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø³ÛŒØ³ØªÙ… Ù…Ø±ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯', 'structure');
                
                // Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯
                await this.runTest(() => this.testSchemaPerformance(), 
                    'Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø§Ø³Ú©ÛŒÙ…Ø§', 'Ø¨Ø±Ø±Ø³ÛŒ Ø³Ø±Ø¹Øª Ùˆ Ú©Ø§Ø±Ø§ÛŒÛŒ', 'performance');
                
                await this.runTest(() => this.testMemoryUsage(), 
                    'Ù…ØµØ±Ù Ø­Ø§ÙØ¸Ù‡', 'Ø¨Ø±Ø±Ø³ÛŒ Ø­Ø¬Ù… Ø§Ø³Ú©ÛŒÙ…Ø§ Ø¯Ø± Ø­Ø§ÙØ¸Ù‡', 'performance');
                
                await this.runTest(() => this.testQueryOptimization(), 
                    'Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©ÙˆØ¦Ø±ÛŒ', 'Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡ Ø¨Ø±Ø§ÛŒ Ø¬Ø³ØªØ¬Ùˆ', 'performance');
                
                await this.runTest(() => this.testDataIntegrity(), 
                    'ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ Ø¯Ø§Ø¯Ù‡', 'Ø¨Ø±Ø±Ø³ÛŒ Ù‚ÙˆØ§Ù†ÛŒÙ† Ø¬Ø§Ù…Ø¹ÛŒØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§', 'performance');
                
                // Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬ Ù†Ù‡Ø§ÛŒÛŒ
                const duration = (Date.now() - this.stats.startTime) / 1000;
                const successRate = Math.round((this.stats.passed / this.stats.total) * 100);
                
                this.logger.success(
                    `ğŸ‰ ØªØ³Øªâ€ŒÙ‡Ø§ Ú©Ø§Ù…Ù„ Ø´Ø¯: ${this.stats.passed}/${this.stats.total} Ù…ÙˆÙÙ‚ (${successRate}%) Ø¯Ø± ${duration.toFixed(2)} Ø«Ø§Ù†ÛŒÙ‡`
                );
                
                // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
                document.getElementById('runAllBtn').disabled = false;
                document.getElementById('runAllBtn').innerHTML = '<span class="btn-icon">ğŸ”„</span> Ø§Ø¬Ø±Ø§ÛŒ Ù…Ø¬Ø¯Ø¯ ØªØ³Øªâ€ŒÙ‡Ø§';
                
                // Ù†Ù…Ø§ÛŒØ´ Ø¨ØµØ±ÛŒ Ø§Ø³Ú©ÛŒÙ…Ø§
                this.renderSchemaVisualization();
                
                return { successRate, duration, stats: this.stats };
            }
            
            async runValidationTests() {
                const validationTests = [
                    { fn: () => this.testUserValidation(), name: 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ú©Ø§Ø±Ø¨Ø±' },
                    { fn: () => this.testLessonValidation(), name: 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¯Ø±Ø³' },
                    { fn: () => this.testProgressValidation(), name: 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ù¾ÛŒØ´Ø±ÙØª' },
                    { fn: () => this.testEmailValidation(), name: 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø§ÛŒÙ…ÛŒÙ„' }
                ];
                
                this.logger.info('Ø´Ø±ÙˆØ¹ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ...');
                
                for (const test of validationTests) {
                    await this.runTest(test.fn, test.name, 'Ø¨Ø±Ø±Ø³ÛŒ ØµØ­Øª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§', 'validation');
                }
            }
            
            async runSchemaTests() {
                const schemaTests = [
                    { fn: () => this.testSchemaStructure(), name: 'Ø³Ø§Ø®ØªØ§Ø± Ú©Ù„ÛŒ' },
                    { fn: () => this.testIndexesStructure(), name: 'Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§' },
                    { fn: () => this.testForeignKeys(), name: 'Ø±ÙˆØ§Ø¨Ø·' },
                    { fn: () => this.testSRSDefaults(), name: 'SRS' }
                ];
                
                this.logger.info('Ø´Ø±ÙˆØ¹ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø®ØªØ§Ø±...');
                
                for (const test of schemaTests) {
                    await this.runTest(test.fn, test.name, 'Ø¨Ø±Ø±Ø³ÛŒ Ø³Ø§Ø®ØªØ§Ø± Ø§Ø³Ú©ÛŒÙ…Ø§', 'structure');
                }
            }
            
            async runPerformanceTests() {
                const performanceTests = [
                    { fn: () => this.testSchemaPerformance(), name: 'Ø¹Ù…Ù„Ú©Ø±Ø¯' },
                    { fn: () => this.testMemoryUsage(), name: 'Ø­Ø§ÙØ¸Ù‡' },
                    { fn: () => this.testQueryOptimization(), name: 'Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ' },
                    { fn: () => this.testDataIntegrity(), name: 'ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ' }
                ];
                
                this.logger.info('Ø´Ø±ÙˆØ¹ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯...');
                
                for (const test of performanceTests) {
                    await this.runTest(test.fn, test.name, 'Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø§Ø±Ø§ÛŒÛŒ', 'performance');
                }
            }
            
            resetAllTests() {
                this.stats = { total: 0, passed: 0, failed: 0, startTime: null, currentTest: 0, totalTests: 12 };
                document.getElementById('testResults').innerHTML = '';
                document.getElementById('progressBar').style.width = '0%';
                document.getElementById('tablesVisualization').innerHTML = '';
                this.logger.clear();
                this.logger.info('Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§ Ø±ÛŒØ³Øª Ø´Ø¯Ù†Ø¯ - Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ø¬Ø¯ÛŒØ¯');
            }
            
            renderSchemaVisualization() {
                const container = document.getElementById('tablesVisualization');
                container.innerHTML = '';
                
                for (const [tableName, schema] of Object.entries(this.schema)) {
                    const tableDiv = document.createElement('div');
                    tableDiv.className = 'table-visual';
                    
                    let columnsHTML = '';
                    
                    // ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ
                    columnsHTML += `
                        <div class="column-row" style="background: #e3f2fd;">
                            <span class="column-name" style="color: #1565c0;">${schema.keyPath}</span>
                            <span class="column-type" style="background: #1565c0;">Ú©Ù„ÛŒØ¯ Ø§ØµÙ„ÛŒ</span>
                        </div>
                    `;
                    
                    // ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†ÙˆØ¹ Ø¬Ø¯ÙˆÙ„
                    if (tableName === 'users') {
                        columnsHTML += `
                            <div class="column-row">
                                <span class="column-name">email</span>
                                <span class="column-type">String</span>
                            </div>
                            <div class="column-row">
                                <span class="column-name">username</span>
                                <span class="column-type">String</span>
                            </div>
                            <div class="column-row">
                                <span class="column-name">level</span>
                                <span class="column-type">Integer</span>
                            </div>
                            <div class="column-row">
                                <span class="column-name">xp</span>
                                <span class="column-type">Integer</span>
                            </div>
                        `;
                    } else if (tableName === 'lessons') {
                        columnsHTML += `
                            <div class="column-row">
                                <span class="column-name">title</span>
                                <span class="column-type">String</span>
                            </div>
                            <div class="column-row">
                                <span class="column-name">level</span>
                                <span class="column-type">Integer</span>
                            </div>
                            <div class="column-row">
                                <span class="column-name">isLocked</span>
                                <span class="column-type">Boolean</span>
                            </div>
                            <div class="column-row">
                                <span class="column-name">prerequisites</span>
                                <span class="column-type">Array</span>
                            </div>
                        `;
                    } else if (tableName === 'progress') {
                        columnsHTML += `
                            <div class="column-row">
                                <span class="column-name">status</span>
                                <span class="column-type">String</span>
                            </div>
                            <div class="column-row">
                                <span class="column-name">score</span>
                                <span class="column-type">Number</span>
                            </div>
                            <div class="column-row">
                                <span class="column-name">lastReviewDate</span>
                                <span class="column-type">Date</span>
                            </div>
                            <div class="column-row">
                                <span class="column-name">nextReviewDate</span>
                                <span class="column-type">Date</span>
                            </div>
                        `;
                    }
                    
                    // Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§
                    if (schema.indexes && schema.indexes.length > 0) {
                        columnsHTML += `
                            <div class="column-row" style="background: #f3e5f5; margin-top: 15px;">
                                <span class="column-name" style="color: #7b1fa2;">Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§ (${schema.indexes.length})</span>
                                <span class="column-type" style="background: #7b1fa2;">Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ</span>
                            </div>
                        `;
                        
                        schema.indexes.forEach(index => {
                            columnsHTML += `
                                <div class="column-row" style="background: #f3e5f5;">
                                    <span class="column-name" style="font-size: 0.9rem;">${index.name}</span>
                                    <span class="column-type" style="background: #7b1fa2; font-size: 0.8rem;">
                                        ${index.keyPath}
                                    </span>
                                </div>
                            `;
                        });
                    }
                    
                    tableDiv.innerHTML = `
                        <div class="table-name">${tableName}</div>
                        <div class="table-columns">
                            ${columnsHTML}
                        </div>
                    `;
                    
                    container.appendChild(tableDiv);
                }
            }
        }

        // ==================== Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ ====================
        const tester = new SchemaTester();
        
        document.addEventListener('DOMContentLoaded', () => {
            tester.logger.info('ğŸš€ ØªØ³ØªØ±ÙˆÙ†Ø± Ø§Ø³Ú©ÛŒÙ…Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯');
            tester.logger.info('Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ØŒ Ø¯Ú©Ù…Ù‡ "Ø§Ø¬Ø±Ø§ÛŒ ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§" Ø±Ø§ ÙØ´Ø§Ø± Ø¯Ù‡ÛŒØ¯');
            
            // Ù†Ù…Ø§ÛŒØ´ Ø§ÙˆÙ„ÛŒÙ‡ Ø§Ø³Ú©ÛŒÙ…Ø§
            setTimeout(() => {
                tester.renderSchemaVisualization();
            }, 500);
        });

        // ==================== ØªÙˆØ§Ø¨Ø¹ Ø¬Ù‡Ø§Ù†ÛŒ ====================
        async function runAllTests() {
            await tester.runAllTests();
        }
        
        async function runValidationTests() {
            await tester.runValidationTests();
        }
        
        async function runSchemaTests() {
            await tester.runSchemaTests();
        }
        
        async function runPerformanceTests() {
            await tester.runPerformanceTests();
        }
        
        function resetAllTests() {
            tester.resetAllTests();
        }
        
        function clearLog() {
            tester.logger.clear();
        }
    </script>
</body>
              </html>
