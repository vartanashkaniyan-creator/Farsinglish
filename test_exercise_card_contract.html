```html
<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Exercise Card</title>
    <style>
        body {
            font-family: Vazir, Tahoma, Arial, sans-serif;
            background-color: #f5f7fa;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
            padding: 24px;
        }
        h1 {
            font-size: 1.6rem;
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-top: 0;
        }
        h2 {
            font-size: 1.2rem;
            color: #34495e;
            margin: 20px 0 10px;
        }
        .card-container {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #e2e8f0;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .test-case {
            background: white;
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #e9ecef;
            box-shadow: 0 2px 8px rgba(0,0,0,0.02);
        }
        .test-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .test-badge {
            background: #e9ecef;
            padding: 2px 8px;
            border-radius: 20px;
            font-size: 0.7rem;
            color: #495057;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #2980b9;
            margin: 5px;
            box-shadow: 0 2px 4px rgba(52,152,219,0.2);
        }
        button:hover {
            background: #2980b9;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .console-output {
            background: #1e293b;
            color: #e2e8f0;
            font-family: 'Courier New', monospace;
            padding: 15px;
            border-radius: 8px;
            font-size: 0.85rem;
            direction: ltr;
            text-align: left;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            border: 1px solid #334155;
        }
        .btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
            justify-content: center;
        }
        .reset-btn {
            background: #95a5a6;
            border-color: #7f8c8d;
        }
        .reset-btn:hover {
            background: #7f8c8d;
        }
        .success {
            color: #2ecc71;
            font-weight: 600;
        }
        .error {
            color: #e74c3c;
            font-weight: 600;
        }
        .warning {
            color: #f39c12;
        }
        .summary {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #c3e6cb;
            margin: 15px 0;
            font-weight: 500;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>ğŸ§ª ØªØ³Øª Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Exercise Card</h1>
    <p>Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø¯Ø³ØªÛŒØŒ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯Ù‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ/Ø®Ø±ÙˆØ¬ÛŒ Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª ExerciseCard Ø±Ø§ ØªØ³Øª Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</p>

    <div class="card-container">
        <h2>ğŸ“¦ Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª ExerciseCard (Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡)</h2>
        <div id="exerciseCardPreview" style="background: white; border-radius: 12px; padding: 20px; border: 2px solid #3498db; margin-bottom: 20px;">
            <!-- Ø§ÛŒÙ†Ø¬Ø§ Ú©Ø§Ø±Øª Ø¨Ù‡â€ŒØµÙˆØ±Øª Ù¾ÙˆÛŒØ§ Ø±Ù†Ø¯Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
        </div>

        <div class="btn-group">
            <button onclick="testPropsContract()">ğŸ§¾ ØªØ³Øª Ø¯Ø±ÛŒØ§ÙØª Props</button>
            <button onclick="testEventEmission()">ğŸ“¢ ØªØ³Øª Ø§Ø±Ø³Ø§Ù„ Event</button>
            <button onclick="testUnknownExerciseType()">â“ ØªØ³Øª Ù†ÙˆØ¹ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡</button>
            <button onclick="testMissingData()">âš ï¸ ØªØ³Øª Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ù‚Øµ</button>
            <button onclick="runAllTests()">âš¡ Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§</button>
            <button class="reset-btn" onclick="resetTestState()">ğŸ”„ Ø±ÛŒØ³Øª</button>
        </div>

        <div id="testSummary" class="summary" style="display: none;"></div>

        <h2>ğŸ“‹ Ø®Ø±ÙˆØ¬ÛŒ Ú©Ù†Ø³ÙˆÙ„:</h2>
        <div id="consoleOutput" class="console-output">
            > Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯...
        </div>
    </div>
</div>

<script>
    (function() {
        // ==================== Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª ExerciseCard ====================
        class ExerciseCard {
            constructor(props) {
                this.props = props || {};
                this.events = [];
                this.container = document.getElementById('exerciseCardPreview');
                this.render();
            }

            // Ù…ØªØ¯ Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¨Ù‡ ÙˆØ§Ù„Ø¯
            emit(eventName, data) {
                const event = {
                    name: eventName,
                    data: data,
                    timestamp: new Date().toISOString()
                };
                this.events.push(event);
                logToConsole(`[Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª] Ø±ÙˆÛŒØ¯Ø§Ø¯ "${eventName}" Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯: ${JSON.stringify(data)}`, 'info');
                if (this.props.onEvent) {
                    this.props.onEvent(event);
                }
                return event;
            }

            // Ø±Ù†Ø¯Ø± Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø¨Ø± Ø§Ø³Ø§Ø³ props
            render() {
                if (!this.container) return;

                const { exercise = {}, onAnswer, showAnswer = false } = this.props;
                const exerciseType = exercise.type || 'unknown';
                const question = exercise.question || 'Ø³ÙˆØ§Ù„ Ù†Ø§Ù…Ø´Ø®Øµ';
                const options = exercise.options || [];
                const correctAnswer = exercise.correctAnswer || '';

                let html = `
                    <div style="background: #f0f7ff; border-radius: 12px; padding: 16px; border: 1px solid #bbdefb;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <span style="background: #3498db; color: white; padding: 4px 12px; border-radius: 30px; font-size: 0.8rem;">${exerciseType}</span>
                            <span style="color: #7f8c8d; font-size: 0.8rem;">ğŸ§© ExerciseCard</span>
                        </div>
                        <div style="font-size: 1.2rem; font-weight: 500; margin-bottom: 16px;">${question}</div>
                `;

                if (exerciseType === 'multiple-choice' && options.length > 0) {
                    html += `<div style="display: flex; flex-direction: column; gap: 8px;">`;
                    options.forEach((opt, idx) => {
                        html += `
                            <button class="option-btn" data-value="${opt}" style="background: white; border: 1px solid #b0bec5; border-radius: 30px; padding: 10px; text-align: right; cursor: pointer; margin: 2px 0;" onclick="simulateAnswer('${opt}')">
                                ${opt}
                            </button>
                        `;
                    });
                    html += `</div>`;
                } else if (exerciseType === 'flashcard') {
                    html += `
                        <div style="background: white; border-radius: 12px; padding: 20px; text-align: center; border: 1px dashed #90a4ae; margin: 10px 0;">
                            ${showAnswer ? correctAnswer : 'â“ Ú©Ø§Ø±Øª (Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¬ÙˆØ§Ø¨)'}
                        </div>
                        <button style="background: #f39c12; border: none; color: white; border-radius: 30px; padding: 10px 20px; width: 100%;" onclick="simulateFlip()">
                            Ù†Ù…Ø§ÛŒØ´ Ù¾Ø§Ø³Ø®
                        </button>
                    `;
                } else {
                    html += `<div style="color: #e74c3c; padding: 15px; background: #fdeded; border-radius: 8px;">â›” Ù†ÙˆØ¹ ØªÙ…Ø±ÛŒÙ† Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡ ÛŒØ§ Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ù‚Øµ</div>`;
                }

                html += `<div style="margin-top: 12px; font-size: 0.7rem; color: #90a4ae; direction: ltr; text-align: left;">props: ${JSON.stringify({ exercise, showAnswer })}</div>`;
                html += `</div>`;

                this.container.innerHTML = html;
            }

            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ props
            setProps(newProps) {
                this.props = { ...this.props, ...newProps };
                this.render();
                logToConsole(`[Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª] props Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯: ${JSON.stringify(newProps)}`, 'info');
                this.emit('propsUpdated', newProps);
            }
        }

        // ==================== Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ ====================
        let currentCard = null;
        let testResults = [];
        const consoleDiv = document.getElementById('consoleOutput');
        const summaryDiv = document.getElementById('testSummary');

        // ==================== ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ ====================
        function logToConsole(message, type = 'log') {
            const prefix = {
                'log': 'ğŸ“Œ',
                'success': 'âœ…',
                'error': 'âŒ',
                'warning': 'âš ï¸',
                'info': 'â„¹ï¸'
            }[type] || 'ğŸ“Œ';
            const timestamp = new Date().toLocaleTimeString('fa-IR');
            const line = `[${timestamp}] ${prefix} ${message}`;
            consoleDiv.innerHTML += line + '\n';
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        function clearConsole() {
            consoleDiv.innerHTML = '';
        }

        function addTestResult(name, passed, message) {
            testResults.push({ name, passed, message });
            const status = passed ? 'âœ…' : 'âŒ';
            logToConsole(`${status} ØªØ³Øª "${name}": ${message}`, passed ? 'success' : 'error');
        }

        function showSummary() {
            const total = testResults.length;
            const passed = testResults.filter(r => r.passed).length;
            const failed = total - passed;
            summaryDiv.style.display = 'block';
            summaryDiv.className = failed === 0 ? 'summary success' : 'summary error';
            summaryDiv.innerHTML = `ğŸ“Š Ø®Ù„Ø§ØµÙ‡: ${passed} Ø§Ø² ${total} ØªØ³Øª Ù…ÙˆÙÙ‚ (${failed} Ø´Ú©Ø³Øª)`;
        }

        function resetTestState() {
            clearConsole();
            testResults = [];
            summaryDiv.style.display = 'none';
            if (currentCard) {
                currentCard.setProps({ exercise: { type: 'multiple-choice', question: 'Ø³ÙˆØ§Ù„ Ù†Ù…ÙˆÙ†Ù‡', options: ['Ú¯Ø²ÛŒÙ†Ù‡ Û±', 'Ú¯Ø²ÛŒÙ†Ù‡ Û²'] } });
            } else {
                initializeCard();
            }
            logToConsole('ğŸ”„ Ø­Ø§Ù„Øª ØªØ³Øª Ø±ÛŒØ³Øª Ø´Ø¯.', 'info');
        }

        // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ú©Ø§Ø±Øª
        function initializeCard() {
            const defaultExercise = {
                type: 'multiple-choice',
                question: 'Ù…Ø¹Ù†ÛŒ "apple" Ú†ÛŒØ³ØªØŸ',
                options: ['Ø³ÛŒØ¨', 'Ù¾Ø±ØªÙ‚Ø§Ù„', 'Ù…ÙˆØ²', 'Ø§Ù†Ú¯ÙˆØ±'],
                correctAnswer: 'Ø³ÛŒØ¨'
            };
            currentCard = new ExerciseCard({
                exercise: defaultExercise,
                onEvent: (event) => {
                    logToConsole(`[ÙˆØ§Ù„Ø¯] Ø±ÙˆÛŒØ¯Ø§Ø¯ "${event.name}" Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯ Ø¨Ø§ Ø¯Ø§Ø¯Ù‡: ${JSON.stringify(event.data)}`, 'info');
                }
            });
            logToConsole('âœ… Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª ExerciseCard Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø´Ø¯.', 'success');
        }

        // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ú¯Ø²ÛŒÙ†Ù‡ (Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø¯Ø³ØªÛŒ)
        window.simulateAnswer = function(answer) {
            if (currentCard) {
                logToConsole(`[Ú©Ø§Ø±Ø¨Ø±] Ú¯Ø²ÛŒÙ†Ù‡ "${answer}" Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯.`, 'log');
                currentCard.emit('answerSelected', { answer, exercise: currentCard.props.exercise });
            }
        };

        window.simulateFlip = function() {
            if (currentCard) {
                currentCard.setProps({ showAnswer: true });
                currentCard.emit('cardFlipped', {});
            }
        };

        // ==================== ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ ====================
        function testPropsContract() {
            clearConsole();
            testResults = [];
            logToConsole('ğŸ§¾ Ø´Ø±ÙˆØ¹ ØªØ³Øª Ø¯Ø±ÛŒØ§ÙØª Props...', 'info');

            // ØªØ³Øª 1: Ø¯Ø±ÛŒØ§ÙØª exercise Ø§Ø² Ù†ÙˆØ¹ multiple-choice
            try {
                const exerciseMC = {
                    type: 'multiple-choice',
                    question: 'Ø³ÙˆØ§Ù„ ØªØ³ØªÛŒØŸ',
                    options: ['opt1', 'opt2'],
                    correctAnswer: 'opt1'
                };
                currentCard.setProps({ exercise: exerciseMC });
                const propsReceived = currentCard.props.exercise;
                if (propsReceived.type === 'multiple-choice' && propsReceived.question === 'Ø³ÙˆØ§Ù„ ØªØ³ØªÛŒØŸ') {
                    addTestResult('Ø¯Ø±ÛŒØ§ÙØª props (multiple-choice)', true, 'props Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯.');
                } else {
                    addTestResult('Ø¯Ø±ÛŒØ§ÙØª props (multiple-choice)', false, 'props Ù†Ø§Ø¯Ø±Ø³Øª Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯.');
                }
            } catch (e) {
                addTestResult('Ø¯Ø±ÛŒØ§ÙØª props (multiple-choice)', false, 'Ø®Ø·Ø§: ' + e.message);
            }

            // ØªØ³Øª 2: Ø¯Ø±ÛŒØ§ÙØª exercise Ø§Ø² Ù†ÙˆØ¹ flashcard
            try {
                const exerciseFC = {
                    type: 'flashcard',
                    question: 'Ø®Ø§Ù†Ù‡',
                    correctAnswer: 'house'
                };
                currentCard.setProps({ exercise: exerciseFC });
                const propsReceived = currentCard.props.exercise;
                if (propsReceived.type === 'flashcard' && propsReceived.question === 'Ø®Ø§Ù†Ù‡') {
                    addTestResult('Ø¯Ø±ÛŒØ§ÙØª props (flashcard)', true, 'props Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯.');
                } else {
                    addTestResult('Ø¯Ø±ÛŒØ§ÙØª props (flashcard)', false, 'props Ù†Ø§Ø¯Ø±Ø³Øª Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯.');
                }
            } catch (e) {
                addTestResult('Ø¯Ø±ÛŒØ§ÙØª props (flashcard)', false, 'Ø®Ø·Ø§: ' + e.message);
            }

            // ØªØ³Øª 3: Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ù…ØªØ¯Ù‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ Ø¯Ø± props (onEvent)
            try {
                const hasOnEvent = typeof currentCard.props.onEvent === 'function';
                if (hasOnEvent) {
                    addTestResult('ÙˆØ¬ÙˆØ¯ onEvent Ø¯Ø± props', true, 'Ù…ØªØ¯ onEvent ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯.');
                } else {
                    addTestResult('ÙˆØ¬ÙˆØ¯ onEvent Ø¯Ø± props', false, 'Ù…ØªØ¯ onEvent ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.');
                }
            } catch (e) {
                addTestResult('ÙˆØ¬ÙˆØ¯ onEvent Ø¯Ø± props', false, 'Ø®Ø·Ø§: ' + e.message);
            }

            showSummary();
        }

        function testEventEmission() {
            clearConsole();
            testResults = [];
            logToConsole('ğŸ“¢ Ø´Ø±ÙˆØ¹ ØªØ³Øª Ø§Ø±Ø³Ø§Ù„ Event...', 'info');

            // Ø±ÛŒØ³Øª Ú©Ø§Ø±Øª Ø¨Ù‡ Ø­Ø§Ù„Øª multiple-choice
            currentCard.setProps({
                exercise: {
                    type: 'multiple-choice',
                    question: 'Ø³ÙˆØ§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯',
                    options: ['Ø§Ù„Ù', 'Ø¨'],
                    correctAnswer: 'Ø§Ù„Ù'
                }
            });

            // ØªØ³Øª Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ answerSelected
            try {
                const eventName = 'answerSelected';
                const oldEventCount = currentCard.events.length;
                currentCard.emit(eventName, { answer: 'Ø§Ù„Ù' });
                const newEventCount = currentCard.events.length;
                if (newEventCount > oldEventCount && currentCard.events[currentCard.events.length-1].name === eventName) {
                    addTestResult('Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ answerSelected', true, 'Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯.');
                } else {
                    addTestResult('Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ answerSelected', false, 'Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø§Ø±Ø³Ø§Ù„ Ù†Ø´Ø¯.');
                }
            } catch (e) {
                addTestResult('Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ answerSelected', false, 'Ø®Ø·Ø§: ' + e.message);
            }

            // ØªØ³Øª Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ cardFlipped (Ø¨Ø§ ÙÙ„Ø´ Ú©Ø§Ø±Øª)
            try {
                currentCard.setProps({
                    exercise: { type: 'flashcard', question: 'ØªØ³Øª', correctAnswer: 'test' },
                    showAnswer: false
                });
                const oldEventCount = currentCard.events.length;
                currentCard.emit('cardFlipped', {});
                const newEventCount = currentCard.events.length;
                if (newEventCount > oldEventCount && currentCard.events[currentCard.events.length-1].name === 'cardFlipped') {
                    addTestResult('Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ cardFlipped', true, 'Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯.');
                } else {
                    addTestResult('Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ cardFlipped', false, 'Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø§Ø±Ø³Ø§Ù„ Ù†Ø´Ø¯.');
                }
            } catch (e) {
                addTestResult('Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ cardFlipped', false, 'Ø®Ø·Ø§: ' + e.message);
            }

            // ØªØ³Øª Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ propsUpdated
            try {
                const oldEventCount = currentCard.events.length;
                currentCard.setProps({ showAnswer: true });
                const newEventCount = currentCard.events.length;
                const lastEvent = currentCard.events[currentCard.events.length-1];
                if (newEventCount > oldEventCount && lastEvent.name === 'propsUpdated') {
                    addTestResult('Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ propsUpdated', true, 'Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯.');
                } else {
                    addTestResult('Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ propsUpdated', false, 'Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø§Ø±Ø³Ø§Ù„ Ù†Ø´Ø¯.');
                }
            } catch (e) {
                addTestResult('Ø§Ø±Ø³Ø§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯ propsUpdated', false, 'Ø®Ø·Ø§: ' + e.message);
            }

            showSummary();
        }

        function testUnknownExerciseType() {
            clearConsole();
            testResults = [];
            logToConsole('â“ Ø´Ø±ÙˆØ¹ ØªØ³Øª Ù†ÙˆØ¹ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡ ØªÙ…Ø±ÛŒÙ†...', 'info');

            try {
                currentCard.setProps({
                    exercise: { type: 'unknown-type', question: 'Ú†ÛŒØ³ØªØŸ' }
                });
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ø¢ÛŒØ§ Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø¨Ø¯ÙˆÙ† Ø®Ø·Ø§ Ø±Ù†Ø¯Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯
                const containerHtml = document.getElementById('exerciseCardPreview').innerHTML;
                if (containerHtml.includes('Ù†ÙˆØ¹ ØªÙ…Ø±ÛŒÙ† Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡') || containerHtml.includes('â›”')) {
                    addTestResult('Ù†ÙˆØ¹ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡', true, 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø®Ø·Ø§ÛŒ Ù…Ù†Ø§Ø³Ø¨ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯.');
                } else {
                    addTestResult('Ù†ÙˆØ¹ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡', false, 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø®Ø·Ø§ÛŒ Ù…Ù†Ø§Ø³Ø¨ Ù†Ù…Ø§ÛŒØ´ Ù†Ø¯Ø§Ø¯.');
                }
            } catch (e) {
                addTestResult('Ù†ÙˆØ¹ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡', false, 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ú©Ø±Ø´ Ú©Ø±Ø¯: ' + e.message);
            }

            showSummary();
        }

        function testMissingData() {
            clearConsole();
            testResults = [];
            logToConsole('âš ï¸ Ø´Ø±ÙˆØ¹ ØªØ³Øª Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ù‚Øµ...', 'info');

            // ØªØ³Øª 1: exercise Ø®Ø§Ù„ÛŒ
            try {
                currentCard.setProps({ exercise: {} });
                const html = document.getElementById('exerciseCardPreview').innerHTML;
                if (html.includes('Ø³ÙˆØ§Ù„ Ù†Ø§Ù…Ø´Ø®Øµ') || html.includes('Ù†ÙˆØ¹ ØªÙ…Ø±ÛŒÙ† Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡')) {
                    addTestResult('exercise Ø®Ø§Ù„ÛŒ', true, 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø¨Ø§ Ø¯Ø§Ø¯Ù‡ Ø®Ø§Ù„ÛŒ Ú©Ø§Ø± Ú©Ø±Ø¯.');
                } else {
                    addTestResult('exercise Ø®Ø§Ù„ÛŒ', false, 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø±ÙØªØ§Ø± ØºÛŒØ±Ù…Ù†ØªØ¸Ø±Ù‡ Ø¯Ø§Ø´Øª.');
                }
            } catch (e) {
                addTestResult('exercise Ø®Ø§Ù„ÛŒ', false, 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ú©Ø±Ø´ Ú©Ø±Ø¯: ' + e.message);
            }

            // ØªØ³Øª 2: multiple-choice Ø¨Ø¯ÙˆÙ† options
            try {
                currentCard.setProps({
                    exercise: { type: 'multiple-choice', question: 'Ø¨Ø¯ÙˆÙ† Ú¯Ø²ÛŒÙ†Ù‡' }
                });
                const html = document.getElementById('exerciseCardPreview').innerHTML;
                if (html.includes('Ú¯Ø²ÛŒÙ†Ù‡') || html.includes('Ù†ÙˆØ¹ ØªÙ…Ø±ÛŒÙ† Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡')) {
                    addTestResult('multiple-choice Ø¨Ø¯ÙˆÙ† options', true, 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø¨Ø§ Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ù‚Øµ Ú©Ø§Ø± Ú©Ø±Ø¯.');
                } else {
                    addTestResult('multiple-choice Ø¨Ø¯ÙˆÙ† options', false, 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø±ÙØªØ§Ø± ØºÛŒØ±Ù…Ù†ØªØ¸Ø±Ù‡ Ø¯Ø§Ø´Øª.');
                }
            } catch (e) {
                addTestResult('multiple-choice Ø¨Ø¯ÙˆÙ† options', false, 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ú©Ø±Ø´ Ú©Ø±Ø¯: ' + e.message);
            }

            // ØªØ³Øª 3: flashcard Ø¨Ø¯ÙˆÙ† correctAnswer
            try {
                currentCard.setProps({
                    exercise: { type: 'flashcard', question: 'Ø¨Ø¯ÙˆÙ† Ø¬ÙˆØ§Ø¨' }
                });
                const html = document.getElementById('exerciseCardPreview').innerHTML;
                if (html.includes('â“') || html.includes('Ù†ÙˆØ¹ ØªÙ…Ø±ÛŒÙ† Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡')) {
                    addTestResult('flashcard Ø¨Ø¯ÙˆÙ† correctAnswer', true, 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø¨Ø§ Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ù‚Øµ Ú©Ø§Ø± Ú©Ø±Ø¯.');
                } else {
                    addTestResult('flashcard Ø¨Ø¯ÙˆÙ† correctAnswer', false, 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø±ÙØªØ§Ø± ØºÛŒØ±Ù…Ù†ØªØ¸Ø±Ù‡ Ø¯Ø§Ø´Øª.');
                }
            } catch (e) {
                addTestResult('flashcard Ø¨Ø¯ÙˆÙ† correctAnswer', false, 'Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ú©Ø±Ø´ Ú©Ø±Ø¯: ' + e.message);
            }

            showSummary();
        }

        function runAllTests() {
            clearConsole();
            testResults = [];
            logToConsole('âš¡ Ø§Ø¬Ø±Ø§ÛŒ ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯...', 'info');
            testPropsContract();
            testEventEmission();
            testUnknownExerciseType();
            testMissingData();
            logToConsole('ğŸ ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§ Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù†Ø¯.', 'success');
        }

        // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ù‡
        window.onload = function() {
            initializeCard();
        };

        // Ù‚Ø±Ø§Ø± Ø¯Ø§Ø¯Ù† ØªÙˆØ§Ø¨Ø¹ Ø¯Ø± scope Ø³Ø±Ø§Ø³Ø±ÛŒ
        window.testPropsContract = testPropsContract;
        window.testEventEmission = testEventEmission;
        window.testUnknownExerciseType = testUnknownExerciseType;
        window.testMissingData = testMissingData;
        window.runAllTests = runAllTests;
        window.resetTestState = resetTestState;
    })();
</script>
</body>
</html>
```
