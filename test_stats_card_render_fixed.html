<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª Ø¯Ø³ØªÛŒ: Ú©Ø§Ø±Øª Ø¢Ù…Ø§Ø± (Ø§ØµÙ„Ø§Ø­â€ŒØ´Ø¯Ù‡)</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            max-width: 600px;
            margin: 20px auto;
            padding: 0 20px;
            background: #f5f7fb;
            color: #1e293b;
        }
        h1 { font-size: 1.5rem; border-bottom: 2px solid #cbd5e1; padding-bottom: 8px; }
        .card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.05);
            margin-bottom: 24px;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 40px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            margin: 8px 8px 8px 0;
        }
        .button-secondary { background: #f1f5f9; color: #334155; }
        .test-output {
            background: #0f172a;
            color: #bbf7d0;
            padding: 16px;
            border-radius: 16px;
            font-family: 'Courier New', monospace;
            max-height: 400px;
            overflow-y: auto;
        }
        .success { color: #86efac; }
        .fail { color: #f87171; }
        .component-box {
            background: white;
            border-radius: 16px;
            padding: 20px;
            border: 2px solid #e2e8f0;
            margin-top: 24px;
        }
    </style>
</head>
<body>
<h1>ğŸ“Š ØªØ³Øª Ú©Ø§Ø±Øª Ø¢Ù…Ø§Ø± (Ù†Ø³Ø®Ù‡ Ø§ØµÙ„Ø§Ø­â€ŒØ´Ø¯Ù‡)</h1>

<div class="component-box">
    <h3>âš™ï¸ Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª stats-card</h3>
    <div id="stats-card-demo" style="background: #f1f5f9; padding: 20px; border-radius: 16px;"></div>
</div>

<div style="display: flex; flex-wrap: wrap; gap: 8px; margin: 20px 0;">
    <button id="test-normal-data">âœ… Û±. Ø¯Ø§Ø¯Ù‡ Ø¹Ø§Ø¯ÛŒ</button>
    <button id="test-zero-stats">ğŸŸ¡ Û². Ø¢Ù…Ø§Ø± ØµÙØ±</button>
    <button id="test-large-numbers">ğŸ”¢ Û³. Ø§Ø¹Ø¯Ø§Ø¯ Ø¨Ø²Ø±Ú¯</button>
    <button id="test-incomplete-data">âš ï¸ Û´. Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ù‚Øµ</button>
    <button id="test-empty-object">ğŸ“­ Ûµ. Ø´ÛŒØ¡ Ø®Ø§Ù„ÛŒ</button>
    <button id="test-all-fields">ğŸ“‹ Û¶. Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§</button>
    <button class="button-secondary" id="clear-output">ğŸ§¹ Ù¾Ø§Ú©â€ŒÚ©Ø±Ø¯Ù†</button>
</div>

<div class="test-output" id="output">
    <div class="test-line info">ğŸ“Œ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.</div>
</div>

<script>
(function() {
    const demo = document.getElementById('stats-card-demo');
    const out = document.getElementById('output');

    function log(msg, type = 'info') {
        const line = document.createElement('div');
        line.className = `test-line ${type}`;
        line.textContent = `> ${msg}`;
        out.appendChild(line);
        out.scrollTop = out.scrollHeight;
    }

    function clearLog() {
        out.innerHTML = '<div class="test-line info">ğŸ“Œ Ø®Ø±ÙˆØ¬ÛŒ Ù¾Ø§Ú© Ø´Ø¯.</div>';
    }

    // ØªØ§Ø¨Ø¹ Ø±Ù†Ø¯Ø± (Ù…Ù†Ø·Ù‚ Ù…Ø­Ø¶)
    function renderStatsCard(data) {
        const safe = data || {};
        const lessons = safe.lessonsCompleted ?? 0;
        const total = safe.totalExercises ?? 0;
        const correct = safe.correctAnswers ?? 0;
        const streak = safe.streakDays ?? 0;
        const level = safe.level ?? 1;
        let acc = safe.accuracy;
        if (acc === undefined && total > 0) acc = Math.round((correct / total) * 100);
        else if (acc === undefined) acc = 0;

        return `
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <div style="background:#f1f5f9;padding:12px;border-radius:12px;text-align:center;">
                    <div style="font-size:0.9rem;color:#475569;">Ø¯Ø±Ø³â€ŒÙ‡Ø§</div>
                    <div style="font-size:2rem;font-weight:bold;color:#3b82f6;" data-testid="lessons">${lessons}</div>
                </div>
                <div style="background:#f1f5f9;padding:12px;border-radius:12px;text-align:center;">
                    <div style="font-size:0.9rem;color:#475569;">Ø¯Ù‚Øª</div>
                    <div style="font-size:2rem;font-weight:bold;color:#10b981;" data-testid="accuracy">${acc}%</div>
                </div>
                <div style="background:#f1f5f9;padding:12px;border-radius:12px;text-align:center;">
                    <div style="font-size:0.9rem;color:#475569;">Ú¯Ø§Ù…</div>
                    <div style="font-size:2rem;font-weight:bold;color:#f59e0b;" data-testid="streak">${streak} Ø±ÙˆØ²</div>
                </div>
                <div style="background:#f1f5f9;padding:12px;border-radius:12px;text-align:center;">
                    <div style="font-size:0.9rem;color:#475569;">Ø³Ø·Ø­</div>
                    <div style="font-size:2rem;font-weight:bold;color:#8b5cf6;" data-testid="level">${level}</div>
                </div>
            </div>
            <div style="margin-top:16px;font-size:0.8rem;color:#64748b;border-top:1px solid #cbd5e1;padding-top:8px;" data-testid="summary">
                ğŸ† Ù…Ø¬Ù…ÙˆØ¹ ØªÙ…Ø±ÛŒÙ†â€ŒÙ‡Ø§: ${total} | Ù¾Ø§Ø³Ø® ØµØ­ÛŒØ­: ${correct}
            </div>
        `;
    }

    function runTest(name, input, checks) {
        log(`ğŸ§ª Ø´Ø±ÙˆØ¹: ${name}`, 'info');
        log(`ÙˆØ±ÙˆØ¯ÛŒ: ${JSON.stringify(input)}`, 'info');
        demo.innerHTML = renderStatsCard(input);

        let ok = true;
        checks.forEach(c => {
            const el = document.querySelector(`[data-testid="${c.id}"]`);
            if (!el) { log(`   âŒ ${c.desc}: Ø§Ù„Ù…Ø§Ù† ÛŒØ§ÙØª Ù†Ø´Ø¯`, 'fail'); ok = false; return; }
            const actual = el.textContent.trim();
            if (actual === c.expected) {
                log(`   âœ… ${c.desc}: "${c.expected}"`, 'success');
            } else {
                log(`   âŒ ${c.desc}: Ø§Ù†ØªØ¸Ø§Ø± "${c.expected}" â†’ Ø¯Ø±ÛŒØ§ÙØª "${actual}"`, 'fail');
                ok = false;
            }
        });
        log(ok ? 'âœ… Ù‡Ù…Ù‡ Ù…ÙˆØ§Ø±Ø¯ Ú¯Ø°Ø±Ø§Ù†Ø¯Ù‡ Ø´Ø¯\n' : 'âŒ Ø¨Ø±Ø®ÛŒ Ù…ÙˆØ§Ø±Ø¯ Ø´Ú©Ø³Øª Ø®ÙˆØ±Ø¯\n');
    }

    document.getElementById('test-normal-data').addEventListener('click', () => {
        runTest('Ø¯Ø§Ø¯Ù‡ Ø¹Ø§Ø¯ÛŒ', 
            { lessonsCompleted:5, totalExercises:50, correctAnswers:40, streakDays:7, level:3 },
            [
                { id:'lessons', desc:'ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø±Ø³â€ŒÙ‡Ø§', expected:'5' },
                { id:'accuracy', desc:'Ø¯Ù‚Øª', expected:'80%' },
                { id:'streak', desc:'Ú¯Ø§Ù…', expected:'7 Ø±ÙˆØ²' },
                { id:'level', desc:'Ø³Ø·Ø­', expected:'3' },
                { id:'summary', desc:'Ø®Ù„Ø§ØµÙ‡', expected:'ğŸ† Ù…Ø¬Ù…ÙˆØ¹ ØªÙ…Ø±ÛŒÙ†â€ŒÙ‡Ø§: 50 | Ù¾Ø§Ø³Ø® ØµØ­ÛŒØ­: 40' }
            ]
        );
    });

    document.getElementById('test-zero-stats').addEventListener('click', () => {
        runTest('Ø¢Ù…Ø§Ø± ØµÙØ±',
            { lessonsCompleted:0, totalExercises:0, correctAnswers:0, streakDays:0, level:1 },
            [
                { id:'lessons', desc:'Ø¯Ø±Ø³â€ŒÙ‡Ø§', expected:'0' },
                { id:'accuracy', desc:'Ø¯Ù‚Øª', expected:'0%' },
                { id:'streak', desc:'Ú¯Ø§Ù…', expected:'0 Ø±ÙˆØ²' },
                { id:'level', desc:'Ø³Ø·Ø­', expected:'1' }
            ]
        );
    });

    document.getElementById('test-large-numbers').addEventListener('click', () => {
        runTest('Ø§Ø¹Ø¯Ø§Ø¯ Ø¨Ø²Ø±Ú¯',
            { lessonsCompleted:999, totalExercises:9876, correctAnswers:5432, streakDays:365, level:99 },
            [
                { id:'lessons', desc:'Ø¯Ø±Ø³â€ŒÙ‡Ø§', expected:'999' },
                { id:'accuracy', desc:'Ø¯Ù‚Øª', expected:'55%' },
                { id:'streak', desc:'Ú¯Ø§Ù…', expected:'365 Ø±ÙˆØ²' },
                { id:'level', desc:'Ø³Ø·Ø­', expected:'99' }
            ]
        );
    });

    document.getElementById('test-incomplete-data').addEventListener('click', () => {
        runTest('Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ù‚Øµ',
            { lessonsCompleted:3, streakDays:2, level:2 },
            [
                { id:'lessons', desc:'Ø¯Ø±Ø³â€ŒÙ‡Ø§', expected:'3' },
                { id:'accuracy', desc:'Ø¯Ù‚Øª', expected:'0%' },
                { id:'streak', desc:'Ú¯Ø§Ù…', expected:'2 Ø±ÙˆØ²' },
                { id:'level', desc:'Ø³Ø·Ø­', expected:'2' }
            ]
        );
    });

    document.getElementById('test-empty-object').addEventListener('click', () => {
        runTest('Ø´ÛŒØ¡ Ø®Ø§Ù„ÛŒ', {}, [
            { id:'lessons', desc:'Ø¯Ø±Ø³â€ŒÙ‡Ø§', expected:'0' },
            { id:'accuracy', desc:'Ø¯Ù‚Øª', expected:'0%' },
            { id:'streak', desc:'Ú¯Ø§Ù…', expected:'0 Ø±ÙˆØ²' },
            { id:'level', desc:'Ø³Ø·Ø­', expected:'1' }
        ]);
    });

    document.getElementById('test-all-fields').addEventListener('click', () => {
        runTest('Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§',
            { lessonsCompleted:10, totalExercises:100, correctAnswers:85, streakDays:14, level:5, accuracy:90 },
            [
                { id:'lessons', desc:'Ø¯Ø±Ø³â€ŒÙ‡Ø§', expected:'10' },
                { id:'accuracy', desc:'Ø¯Ù‚Øª', expected:'90%' },
                { id:'streak', desc:'Ú¯Ø§Ù…', expected:'14 Ø±ÙˆØ²' },
                { id:'level', desc:'Ø³Ø·Ø­', expected:'5' }
            ]
        );
    });

    document.getElementById('clear-output').addEventListener('click', () => {
        clearLog();
        demo.innerHTML = '<div style="color:#64748b;text-align:center;">Ù…Ù†ØªØ¸Ø± ØªØ³Øª...</div>';
    });

    clearLog();
})();
</script>

<hr>
<div style="text-align:center; color:#64748b;">âœ… ØªØ³Øª Ø§ØµÙ„Ø§Ø­â€ŒØ´Ø¯Ù‡ â€“ Ù…Ø´Ú©Ù„ Ø®Ù„Ø§ØµÙ‡ Ø¨Ø±Ø·Ø±Ù Ø´Ø¯</div>
</body>
</html>
