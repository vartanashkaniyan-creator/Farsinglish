<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>ØªØ³Øª Ø¯Ø³ØªÛŒ SRS - Farsinglish</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Tahoma', 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }
        h1 {
            font-size: 28px;
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        h2 {
            font-size: 20px;
            color: #34495e;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
        }
        .scenario-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        .scenario-card:hover {
            border-color: #667eea;
            box-shadow: 0 8px 15px rgba(102,126,234,0.2);
        }
        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .scenario-title {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            background: #f8f9fa;
            padding: 8px 15px;
            border-radius: 30px;
            display: inline-block;
        }
        .status {
            padding: 6px 15px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 14px;
        }
        .status-pending {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }
        .status-pass {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status-fail {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .form-group {
            margin: 15px 0;
            background: #f8fafc;
            padding: 15px;
            border-radius: 12px;
        }
        .slider-container {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        input[type=range] {
            flex: 1;
            height: 8px;
            border-radius: 10px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 25px;
            height: 25px;
            background: #667eea;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(102,126,234,0.5);
            border: 2px solid white;
        }
        .quality-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            color: white;
        }
        .quality-0 { background: #e74c3c; }
        .quality-1 { background: #e67e22; }
        .quality-2 { background: #f39c12; }
        .quality-3 { background: #f1c40f; color: #2c3e50; }
        .quality-4 { background: #2ecc71; }
        .quality-5 { background: #27ae60; }
        
        .result-box {
            background: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            direction: ltr;
            text-align: left;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 5px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102,126,234,0.4);
        }
        button:active {
            transform: translateY(0);
        }
        .btn-reset {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
        }
        .btn-verify {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            width: 100%;
            padding: 15px;
            font-size: 18px;
        }
        .summary-box {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 20px;
            border-radius: 16px;
            margin-top: 30px;
            text-align: center;
        }
        .log-panel {
            background: #1e1e1e;
            color: #0f0;
            padding: 15px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 200px;
            overflow-y: auto;
            direction: ltr;
            text-align: left;
            margin-top: 20px;
        }
        .flex-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        @media (max-width: 600px) {
            .container { padding: 15px; }
            h1 { font-size: 24px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§  Farsinglish</h1>
        <h2>ğŸ“‹ ØªØ³Øª Ø¯Ø³ØªÛŒ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… SRS (SM-2)</h2>
        <p style="text-align: center; color: #666; margin-bottom: 25px;">
            â­ Ù‡Ø± Ø³Ù†Ø§Ø±ÛŒÙˆ Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯ØŒ Ù†ØªÛŒØ¬Ù‡ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ùˆ ØªØ£ÛŒÛŒØ¯ Ú©Ù†ÛŒØ¯
        </p>

        <div id="scenarios-container"></div>
        
        <div style="display: flex; gap: 15px; margin: 25px 0;">
            <button onclick="resetAllScenarios()" class="btn-reset" style="flex: 1;">ğŸ”„ Ø±ÛŒØ³Øª Ù‡Ù…Ù‡ Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§</button>
            <button onclick="exportLog()" style="flex: 1; background: #27ae60;">ğŸ“¥ Ø®Ø±ÙˆØ¬ÛŒ Ù„Ø§Ú¯</button>
        </div>

        <div class="summary-box" id="summary">
            <h3 style="margin-bottom: 10px;">ğŸ“Š ÙˆØ¶Ø¹ÛŒØª Ú©Ù„ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§</h3>
            <div id="stats" style="font-size: 20px; font-weight: bold;">âœ… Û° / Û°</div>
        </div>

        <div class="log-panel" id="log-panel">
            ğŸ“ Ù…Ù†ØªØ¸Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§...
        </div>
    </div>

    <script>
        // -------------------- Ú©Ù„Ø§Ø³ SRS Scheduler --------------------
        class SRSScheduler {
            constructor() {
                this.defaultEaseFactor = 2.5;
                this.minEaseFactor = 1.3;
                this.maxEaseFactor = 3.0;
            }

            calculateNextReview(quality, repetitions, easeFactor, interval = 0) {
                if (quality < 0 || quality > 5) throw new Error('Ú©ÛŒÙÛŒØª Ø¨Ø§ÛŒØ¯ Ø¨ÛŒÙ† Û° ØªØ§ Ûµ Ø¨Ø§Ø´Ø¯');
                
                if (quality < 3) {
                    return {
                        interval: 1,
                        repetitions: 0,
                        easeFactor: Math.max(this.minEaseFactor, easeFactor - 0.2)
                    };
                }

                let newInterval;
                if (repetitions === 0) newInterval = 1;
                else if (repetitions === 1) newInterval = 6;
                else newInterval = Math.round(interval * easeFactor);

                let newEaseFactor = easeFactor + (0.1 - (5 - quality) * (0.08 + (5 - quality) * 0.02));
                newEaseFactor = Math.max(this.minEaseFactor, Math.min(this.maxEaseFactor, newEaseFactor));

                return {
                    interval: newInterval,
                    repetitions: repetitions + 1,
                    easeFactor: parseFloat(newEaseFactor.toFixed(2))
                };
            }
        }

        // -------------------- Ø¯Ø§Ø¯Ù‡ Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ --------------------
        const scenarios = [
            {
                id: 1,
                title: 'ğŸŒŸ Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ - Ø§ÙˆÙ„ÛŒÙ† Ù…ÙˆØ§Ø¬Ù‡Ù‡ Ø¨Ø§ Ú©Ù„Ù…Ù‡',
                desc: 'Ú©ÛŒÙÛŒØª Ù¾Ø§Ø³Ø®: Ûµ (Ø¹Ø§Ù„ÛŒ)',
                params: { quality: 5, repetitions: 0, easeFactor: 2.5, interval: 0 },
                expected: { interval: 1, repetitions: 1, easeFactor: 2.6 }
            },
            {
                id: 2,
                title: 'ğŸ“š Ù…Ø±ÙˆØ± Ø§ÙˆÙ„ - Ù¾Ø§Ø³Ø® Ø®ÙˆØ¨',
                desc: 'Ú©ÛŒÙÛŒØª Ù¾Ø§Ø³Ø®: Û´ (Ø®ÙˆØ¨)',
                params: { quality: 4, repetitions: 1, easeFactor: 2.6, interval: 1 },
                expected: { interval: 6, repetitions: 2, easeFactor: 2.58 }
            },
            {
                id: 3,
                title: 'ğŸ”„ Ù…Ø±ÙˆØ± Ø¯ÙˆÙ… - Ù¾Ø§Ø³Ø® Ø¹Ø§Ù„ÛŒ',
                desc: 'Ú©ÛŒÙÛŒØª Ù¾Ø§Ø³Ø®: Ûµ (Ø¹Ø§Ù„ÛŒ)',
                params: { quality: 5, repetitions: 2, easeFactor: 2.58, interval: 6 },
                expected: { interval: 15, repetitions: 3, easeFactor: 2.68 }
            },
            {
                id: 4,
                title: 'âŒ Ù¾Ø§Ø³Ø® Ù†Ø§Ø¯Ø±Ø³Øª - Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ø§ÙˆÙ„',
                desc: 'Ú©ÛŒÙÛŒØª Ù¾Ø§Ø³Ø®: Û± (Ø®ÛŒÙ„ÛŒ Ø¶Ø¹ÛŒÙ)',
                params: { quality: 1, repetitions: 3, easeFactor: 2.68, interval: 15 },
                expected: { interval: 1, repetitions: 0, easeFactor: 2.48 }
            },
            {
                id: 5,
                title: 'ğŸ”„ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ø¬Ø¯Ø¯ - Ø§ÙˆÙ„ÛŒÙ† Ù¾Ø§Ø³Ø® Ø¯Ø±Ø³Øª',
                desc: 'Ú©ÛŒÙÛŒØª Ù¾Ø§Ø³Ø®: Û³ (Ù‚Ø¨ÙˆÙ„)',
                params: { quality: 3, repetitions: 0, easeFactor: 2.48, interval: 0 },
                expected: { interval: 1, repetitions: 1, easeFactor: 2.46 }
            },
            {
                id: 6,
                title: 'âš¡ Ù…Ø±ÙˆØ± Ø·ÙˆÙ„Ø§Ù†ÛŒ Ù…Ø¯Øª - Ú©Ù„Ù…Ù‡ Ù…Ø³Ù„Ø· Ø´Ø¯Ù‡',
                desc: 'Ú©ÛŒÙÛŒØª Ù¾Ø§Ø³Ø®: Ûµ (Ø¹Ø§Ù„ÛŒ)',
                params: { quality: 5, repetitions: 10, easeFactor: 2.8, interval: 120 },
                expected: { interval: 336, repetitions: 11, easeFactor: 2.9 }
            },
            {
                id: 7,
                title: 'ğŸ“‰ Ú©Ø§Ù‡Ø´ ØªØ¯Ø±ÛŒØ¬ÛŒ - Ø§ÙØª Ú©ÛŒÙÛŒØª',
                desc: 'Ú©ÛŒÙÛŒØª Ù¾Ø§Ø³Ø®: Û² (Ø¶Ø¹ÛŒÙ)',
                params: { quality: 2, repetitions: 5, easeFactor: 2.7, interval: 30 },
                expected: { interval: 1, repetitions: 0, easeFactor: 2.5 }
            },
            {
                id: 8,
                title: 'ğŸ¯ Ù…Ø±ÙˆØ± Ù…Ø±Ø²ÛŒ - Ú©ÛŒÙÛŒØª Û³',
                desc: 'Ú©ÛŒÙÛŒØª Ù¾Ø§Ø³Ø®: Û³ (Ø­Ø¯Ø§Ù‚Ù„ Ù‚Ø¨ÙˆÙ„ÛŒ)',
                params: { quality: 3, repetitions: 4, easeFactor: 2.5, interval: 20 },
                expected: { interval: 50, repetitions: 5, easeFactor: 2.48 }
            }
        ];

        const scheduler = new SRSScheduler();
        let logEntries = [];

        // -------------------- ØªÙˆØ§Ø¨Ø¹ Ù„Ø§Ú¯ --------------------
        function addLog(message, type = 'info') {
            const time = new Date().toLocaleTimeString('fa-IR');
            logEntries.push({ time, message, type });
            updateLogPanel();
        }

        function updateLogPanel() {
            const panel = document.getElementById('log-panel');
            let html = '';
            logEntries.slice(-10).forEach(entry => {
                const color = entry.type === 'success' ? '#0f0' : entry.type === 'error' ? '#f00' : '#ff0';
                html += `<div style="color: ${color}">[${entry.time}] ${entry.message}</div>`;
            });
            panel.innerHTML = html || 'ğŸ“ Ù„Ø§Ú¯ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª...';
        }

        // -------------------- Ø±Ù†Ø¯Ø± Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ --------------------
        function renderScenarios() {
            const container = document.getElementById('scenarios-container');
            let html = '';

            scenarios.forEach(scenario => {
                const status = getScenarioStatus(scenario.id);
                let statusClass = 'status-pending';
                let statusText = 'â³ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ³Øª';
                if (status === 'pass') {
                    statusClass = 'status-pass';
                    statusText = 'âœ… ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡';
                } else if (status === 'fail') {
                    statusClass = 'status-fail';
                    statusText = 'âŒ Ù†Ø§Ù…ÙˆÙÙ‚';
                }

                html += `
                    <div class="scenario-card" id="scenario-${scenario.id}">
                        <div class="scenario-header">
                            <span class="scenario-title">ğŸ§ª Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ ${scenario.id}: ${scenario.title}</span>
                            <span class="status ${statusClass}" id="status-${scenario.id}">${statusText}</span>
                        </div>
                        <p style="color: #666; margin-bottom: 15px;">${scenario.desc}</p>
                        
                        <div class="form-group">
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 10px; font-weight: bold;">
                                    â­ Ú©ÛŒÙÛŒØª Ù¾Ø§Ø³Ø® (Û° ØªØ§ Ûµ):
                                </label>
                                <div class="slider-container">
                                    <input type="range" id="quality-${scenario.id}" 
                                           min="0" max="5" value="${scenario.params.quality}" step="1"
                                           oninput="updateQualityValue(${scenario.id}, this.value)">
                                    <span class="quality-badge quality-${scenario.params.quality}" id="badge-${scenario.id}">
                                        Ú©ÛŒÙÛŒØª ${scenario.params.quality}
                                    </span>
                                </div>
                            </div>
                            
                            <div class="flex-row">
                                <div style="flex: 1; background: #f0f2f5; padding: 10px; border-radius: 8px;">
                                    <small>ğŸ“Š ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ:</small>
                                    <div>ØªÚ©Ø±Ø§Ø±: ${scenario.params.repetitions} | Ø¹Ø§Ù…Ù„ Ø³Ù‡ÙˆÙ„Øª: ${scenario.params.easeFactor} | ÙØ§ØµÙ„Ù‡: ${scenario.params.interval}</div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 15px; display: flex; gap: 10px;">
                                <button onclick="runScenario(${scenario.id})" style="flex: 2;">âš¡ Ø§Ø¬Ø±Ø§ÛŒ Ø³Ù†Ø§Ø±ÛŒÙˆ</button>
                                <button onclick="verifyScenario(${scenario.id})" class="btn-verify" style="flex: 1; padding: 12px;">âœ“ ØªØ£ÛŒÛŒØ¯</button>
                                <button onclick="resetScenario(${scenario.id})" style="flex: 0.5; background: #95a5a6;" title="Ø±ÛŒØ³Øª">ğŸ”„</button>
                            </div>
                            
                            <div id="result-${scenario.id}" class="result-box" style="display: none;"></div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
            updateSummary();
        }

        // -------------------- Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ù‚Ø¯Ø§Ø± Ú©ÛŒÙÛŒØª --------------------
        window.updateQualityValue = function(id, value) {
            const badge = document.getElementById(`badge-${id}`);
            badge.textContent = `Ú©ÛŒÙÛŒØª ${value}`;
            badge.className = `quality-badge quality-${value}`;
            
            const scenario = scenarios.find(s => s.id === id);
            if (scenario) {
                scenario.params.quality = parseInt(value);
            }
        };

        // -------------------- Ø§Ø¬Ø±Ø§ÛŒ Ø³Ù†Ø§Ø±ÛŒÙˆ --------------------
        window.runScenario = function(id) {
            const scenario = scenarios.find(s => s.id === id);
            if (!scenario) return;

            try {
                const result = scheduler.calculateNextReview(
                    scenario.params.quality,
                    scenario.params.repetitions,
                    scenario.params.easeFactor,
                    scenario.params.interval
                );

                const resultDiv = document.getElementById(`result-${id}`);
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span>ğŸ“Œ Ù†ØªÛŒØ¬Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡:</span>
                        <span style="background: #27ae60; padding: 3px 10px; border-radius: 15px; font-size: 12px;">${new Date().toLocaleTimeString('fa-IR')}</span>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(3,1fr); gap: 10px; margin-top: 10px;">
                        <div style="background: #34495e; padding: 10px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 12px; color: #aaa;">ÙØ§ØµÙ„Ù‡ (Ø±ÙˆØ²)</div>
                            <div style="font-size: 24px; font-weight: bold; color: #fff;">${result.interval}</div>
                        </div>
                        <div style="background: #34495e; padding: 10px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 12px; color: #aaa;">ØªÚ©Ø±Ø§Ø±</div>
                            <div style="font-size: 24px; font-weight: bold; color: #fff;">${result.repetitions}</div>
                        </div>
                        <div style="background: #34495e; padding: 10px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 12px; color: #aaa;">Ø¹Ø§Ù…Ù„ Ø³Ù‡ÙˆÙ„Øª</div>
                            <div style="font-size: 24px; font-weight: bold; color: #fff;">${result.easeFactor}</div>
                        </div>
                    </div>
                `;

                addLog(`Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ ${id}: Ø§Ø¬Ø±Ø§ Ø´Ø¯ - ÙØ§ØµÙ„Ù‡: ${result.interval}, ØªÚ©Ø±Ø§Ø±: ${result.repetitions}, EF: ${result.easeFactor}`, 'info');
                
            } catch (error) {
                alert(`Ø®Ø·Ø§ Ø¯Ø± Ø§Ø¬Ø±Ø§ÛŒ Ø³Ù†Ø§Ø±ÛŒÙˆ: ${error.message}`);
                addLog(`Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ ${id}: Ø®Ø·Ø§ - ${error.message}`, 'error');
            }
        };

        // -------------------- ØªØ£ÛŒÛŒØ¯ Ø³Ù†Ø§Ø±ÛŒÙˆ --------------------
        window.verifyScenario = function(id) {
            const scenario = scenarios.find(s => s.id === id);
            if (!scenario) return;

            try {
                const result = scheduler.calculateNextReview(
                    scenario.params.quality,
                    scenario.params.repetitions,
                    scenario.params.easeFactor,
                    scenario.params.interval
                );

                const expected = scenario.expected;
                const passed = (
                    result.interval === expected.interval &&
                    result.repetitions === expected.repetitions &&
                    Math.abs(result.easeFactor - expected.easeFactor) < 0.1
                );

                const statusEl = document.getElementById(`status-${id}`);
                if (passed) {
                    statusEl.className = 'status status-pass';
                    statusEl.textContent = 'âœ… ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡';
                    addLog(`Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ ${id}: âœ… ØªØ£ÛŒÛŒØ¯ Ø´Ø¯ - Ù…Ù†Ø·Ø¨Ù‚ Ø¨Ø§ Ø®Ø±ÙˆØ¬ÛŒ Ù…ÙˆØ±Ø¯ Ø§Ù†ØªØ¸Ø§Ø±`, 'success');
                } else {
                    statusEl.className = 'status status-fail';
                    statusEl.textContent = 'âŒ Ù†Ø§Ù…ÙˆÙÙ‚';
                    addLog(`Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ ${id}: âŒ Ù†Ø§Ù…ÙˆÙÙ‚ - Ø®Ø±ÙˆØ¬ÛŒ Ø¨Ø§ Ù…ÙˆØ±Ø¯ Ø§Ù†ØªØ¸Ø§Ø± Ù…Ø·Ø§Ø¨Ù‚Øª Ù†Ø¯Ø§Ø±Ø¯`, 'error');
                }

                saveScenarioStatus(id, passed);
                updateSummary();
                
            } catch (error) {
                alert(`Ø®Ø·Ø§ Ø¯Ø± ØªØ£ÛŒÛŒØ¯ Ø³Ù†Ø§Ø±ÛŒÙˆ: ${error.message}`);
            }
        };

        // -------------------- Ø°Ø®ÛŒØ±Ù‡/Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª --------------------
        function saveScenarioStatus(id, passed) {
            const statuses = JSON.parse(localStorage.getItem('srs_test_statuses') || '{}');
            statuses[id] = passed ? 'pass' : 'fail';
            localStorage.setItem('srs_test_statuses', JSON.stringify(statuses));
        }

        function getScenarioStatus(id) {
            const statuses = JSON.parse(localStorage.getItem('srs_test_statuses') || '{}');
            return statuses[id] || 'pending';
        }

        window.resetScenario = function(id) {
            const statuses = JSON.parse(localStorage.getItem('srs_test_statuses') || '{}');
            delete statuses[id];
            localStorage.setItem('srs_test_statuses', JSON.stringify(statuses));
            
            const statusEl = document.getElementById(`status-${id}`);
            statusEl.className = 'status status-pending';
            statusEl.textContent = 'â³ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ³Øª';
            
            const resultDiv = document.getElementById(`result-${id}`);
            resultDiv.style.display = 'none';
            
            addLog(`Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ ${id}: Ø±ÛŒØ³Øª Ø´Ø¯`, 'info');
            updateSummary();
        };

        window.resetAllScenarios = function() {
            localStorage.removeItem('srs_test_statuses');
            scenarios.forEach(scenario => {
                const statusEl = document.getElementById(`status-${scenario.id}`);
                if (statusEl) {
                    statusEl.className = 'status status-pending';
                    statusEl.textContent = 'â³ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ³Øª';
                }
                const resultDiv = document.getElementById(`result-${scenario.id}`);
                if (resultDiv) resultDiv.style.display = 'none';
            });
            addLog('ğŸ”„ ØªÙ…Ø§Ù… Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ Ø±ÛŒØ³Øª Ø´Ø¯Ù†Ø¯', 'info');
            updateSummary();
        };

        // -------------------- Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø®Ù„Ø§ØµÙ‡ --------------------
        function updateSummary() {
            let passed = 0;
            scenarios.forEach(s => {
                if (getScenarioStatus(s.id) === 'pass') passed++;
            });
            
            const total = scenarios.length;
            document.getElementById('stats').innerHTML = `âœ… ${passed} / ${total} Ø³Ù†Ø§Ø±ÛŒÙˆ`;
            
            if (passed === total) {
                addLog('ğŸ‰ ØªØ¨Ø±ÛŒÚ©! ØªÙ…Ø§Ù… Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ÛŒ SRS Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù†Ø¯', 'success');
            }
        }

        // -------------------- Ø®Ø±ÙˆØ¬ÛŒ Ù„Ø§Ú¯ --------------------
        window.exportLog = function() {
            const logText = logEntries.map(e => `[${e.time}] ${e.message}`).join('\n');
            const blob = new Blob([logText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `srs-manual-test-${new Date().getTime()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            addLog('ğŸ“¥ Ù„Ø§Ú¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ‡ Ø´Ø¯', 'success');
        };

        // -------------------- Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ --------------------
        window.onload = function() {
            renderScenarios();
            addLog('ğŸš€ ØªØ³Øª Ø¯Ø³ØªÛŒ SRS Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø¬Ø±Ø§Ø³Øª', 'info');
        };
    </script>
</body>
</html>
