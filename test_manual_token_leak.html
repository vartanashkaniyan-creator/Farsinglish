<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª Ø¯Ø³ØªÛŒ Ù†Ø´Øª ØªÙˆÚ©Ù† - Farsinglish</title>
    <style>
        body { font-family: Tahoma, Arial, sans-serif; max-width: 900px; margin: 0 auto; padding: 15px; background: #f5f5f5; }
        .header { background: #2c3e50; color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center; }
        .token-card { background: white; border-radius: 10px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        button { background: #3498db; color: white; border: none; padding: 12px 20px; border-radius: 6px; font-size: 15px; cursor: pointer; margin: 5px; transition: 0.3s; }
        button:hover { opacity: 0.9; }
        .danger-btn { background: #e74c3c; }
        .success-btn { background: #27ae60; }
        .warning-btn { background: #f39c12; }
        .log-box { background: #2d2d2d; color: #00ff00; padding: 15px; border-radius: 8px; font-family: monospace; height: 200px; overflow-y: auto; margin: 15px 0; }
        .result-pass { background: #27ae60; color: white; padding: 10px; border-radius: 6px; margin: 10px 0; }
        .result-fail { background: #e74c3c; color: white; padding: 10px; border-radius: 6px; margin: 10px 0; }
        .token-display { background: #f8f9fa; padding: 15px; border-radius: 6px; border: 1px solid #ddd; word-break: break-all; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ” Farsinglish - ØªØ³Øª Ù†Ø´Øª ØªÙˆÚ©Ù† (Token Leak)</h1>
        <h2>Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ø¯Ù… Ù†Ù…Ø§ÛŒØ´ ØªÙˆÚ©Ù† Ø¯Ø± Ù„Ø§Ú¯â€ŒÙ‡Ø§ØŒ Ø­Ø§ÙØ¸Ù‡ Ùˆ localStorage</h2>
    </div>

    <div class="token-card">
        <h3>ğŸ”‘ ØªÙˆÚ©Ù† ÙØ¹Ù„ÛŒ</h3>
        <div id="tokenDisplay" class="token-display">ØªÙˆÚ©Ù†ÛŒ Ø³Ø§Ø®ØªÙ‡ Ù†Ø´Ø¯Ù‡</div>
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px; margin-bottom: 20px;">
        <button onclick="generateToken()" class="success-btn">ğŸ”‘ ØªÙˆÙ„ÛŒØ¯ ØªÙˆÚ©Ù† Ø¬Ø¯ÛŒØ¯</button>
        <button onclick="saveToLocalStorage()">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage</button>
        <button onclick="saveToSessionStorage()">ğŸ“ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± sessionStorage</button>
        <button onclick="logToConsole()" class="warning-btn">ğŸ“‹ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± console.log</button>
        <button onclick="logErrorWithToken()" class="danger-btn">âš ï¸ Ø«Ø¨Øª Ø®Ø·Ø§ Ø¨Ø§ ØªÙˆÚ©Ù†</button>
        <button onclick="sendNetworkRequest()">ğŸŒ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª</button>
        <button onclick="checkLeaks()" class="success-btn">ğŸ” Ø¨Ø±Ø±Ø³ÛŒ Ù†Ø´Øª</button>
        <button onclick="clearAll()" class="danger-btn">ğŸ—‘ï¸ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡</button>
    </div>

    <div class="token-card">
        <h3>ğŸ“‹ Ù„Ø§Ú¯ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡</h3>
        <div id="logBox" class="log-box">
            [Ø³ÛŒØ³ØªÙ…] Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ¨Ø§Ø´...
        </div>
    </div>

    <div id="resultArea"></div>

    <script>
        let currentToken = null;
        const logBox = document.getElementById('logBox');
        const tokenDisplay = document.getElementById('tokenDisplay');
        const resultArea = document.getElementById('resultArea');

        function addLog(message, isError = false) {
            const logEntry = document.createElement('div');
            logEntry.textContent = `[${new Date().toLocaleTimeString('fa-IR')}] ${message}`;
            logEntry.style.color = isError ? '#ff6b6b' : '#00ff00';
            logBox.appendChild(logEntry);
            logBox.scrollTop = logBox.scrollHeight;
        }

        function maskToken(token) {
            if (!token) return 'Ø¨Ø¯ÙˆÙ† ØªÙˆÚ©Ù†';
            if (token.length <= 10) return '***';
            return token.substring(0, 4) + '...' + token.substring(token.length - 4);
        }

        function generateToken() {
            const header = btoa(JSON.stringify({ alg: 'HS256', typ: 'JWT' }));
            const payload = btoa(JSON.stringify({ 
                userId: 12345, 
                username: 'test_user',
                role: 'user',
                exp: Date.now() + 3600000
            }));
            const signature = Math.random().toString(36).substring(2) + Math.random().toString(36).substring(2);
            currentToken = `${header}.${payload}.${signature}`;
            
            tokenDisplay.textContent = maskToken(currentToken);
            tokenDisplay.style.backgroundColor = '#fff3cd';
            addLog('âœ… ØªÙˆÚ©Ù† Ø¬Ø¯ÛŒØ¯ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯: ' + maskToken(currentToken));
        }

        function saveToLocalStorage() {
            if (!currentToken) {
                addLog('âŒ Ø§Ø¨ØªØ¯Ø§ ØªÙˆÚ©Ù† ØªÙˆÙ„ÛŒØ¯ Ú©Ù†ÛŒØ¯', true);
                return;
            }
            try {
                localStorage.setItem('auth_token', currentToken);
                addLog('âš ï¸ ØªÙˆÚ©Ù† Ø¯Ø± localStorage Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯ (Ø¨Ø±Ø±Ø³ÛŒ Ù†Ø´Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ù†Ø¬Ø§Ù… Ø´ÙˆØ¯)');
            } catch(e) {
                addLog('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡: ' + e.message, true);
            }
        }

        function saveToSessionStorage() {
            if (!currentToken) {
                addLog('âŒ Ø§Ø¨ØªØ¯Ø§ ØªÙˆÚ©Ù† ØªÙˆÙ„ÛŒØ¯ Ú©Ù†ÛŒØ¯', true);
                return;
            }
            try {
                sessionStorage.setItem('session_token', currentToken);
                addLog('âš ï¸ ØªÙˆÚ©Ù† Ø¯Ø± sessionStorage Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
            } catch(e) {
                addLog('âŒ Ø®Ø·Ø§: ' + e.message, true);
            }
        }

        function logToConsole() {
            if (!currentToken) {
                addLog('âŒ Ø§Ø¨ØªØ¯Ø§ ØªÙˆÚ©Ù† ØªÙˆÙ„ÛŒØ¯ Ú©Ù†ÛŒØ¯', true);
                return;
            }
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ console.log Ø®Ø·Ø±Ù†Ø§Ú©
            console.log('ØªÙˆÚ©Ù† Ú©Ø§Ø±Ø¨Ø±:', currentToken);
            addLog('âŒ Ø®Ø·Ø±: ØªÙˆÚ©Ù† Ø¯Ø± console.log Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯ (Ù†Ø´Øª Ù‚Ø·Ø¹ÛŒ)', true);
            checkForTokenInLog(currentToken);
        }

        function logErrorWithToken() {
            if (!currentToken) {
                addLog('âŒ Ø§Ø¨ØªØ¯Ø§ ØªÙˆÚ©Ù† ØªÙˆÙ„ÛŒØ¯ Ú©Ù†ÛŒØ¯', true);
                return;
            }
            try {
                throw new Error('Ø®Ø·Ø§ÛŒ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª');
            } catch(e) {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø®Ø·Ø§ÛŒ Ø­Ø§ÙˆÛŒ ØªÙˆÚ©Ù†
                const errorWithToken = e.message + ' - ØªÙˆÚ©Ù†: ' + currentToken;
                console.error(errorWithToken);
                addLog('âŒ Ø®Ø·Ø±: ØªÙˆÚ©Ù† Ø¯Ø± Ø®Ø·Ø§ Ù„Ùˆ Ø±ÙØª: ' + maskToken(currentToken), true);
            }
        }

        function sendNetworkRequest() {
            if (!currentToken) {
                addLog('âŒ Ø§Ø¨ØªØ¯Ø§ ØªÙˆÚ©Ù† ØªÙˆÙ„ÛŒØ¯ Ú©Ù†ÛŒØ¯', true);
                return;
            }
            addLog('ğŸ“¡ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ Ø³Ø±ÙˆØ±...');
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù‡Ø¯Ø± Authorization
            const headers = {
                'Authorization': 'Bearer ' + currentToken,
                'Content-Type': 'application/json'
            };
            addLog('âœ… Ù‡Ø¯Ø± Authorization ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯ (Ù…Ø®ÙÛŒ: Bearer ' + maskToken(currentToken) + ')');
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ù†Ø´Øª Ø¯Ø± URL
            const urlWithToken = `https://api.example.com/user?token=${currentToken}`;
            addLog('âŒ Ø®Ø·Ø±: ØªÙˆÚ©Ù† Ø¯Ø± URL: ' + maskToken(currentToken), true);
        }

        function checkLeaks() {
            let leaks = [];
            
            // Ø¨Ø±Ø±Ø³ÛŒ localStorage
            for(let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                if(value && value.includes('.') && value.split('.').length === 3) {
                    if(value.length > 50) { // Ø§Ø­ØªÙ…Ø§Ù„Ø§Ù‹ JWT
                        leaks.push(`localStorage.${key}`);
                    }
                }
            }

            // Ø¨Ø±Ø±Ø³ÛŒ sessionStorage
            for(let i = 0; i < sessionStorage.length; i++) {
                const key = sessionStorage.key(i);
                const value = sessionStorage.getItem(key);
                if(value && value.includes('.') && value.split('.').length === 3) {
                    if(value.length > 50) {
                        leaks.push(`sessionStorage.${key}`);
                    }
                }
            }

            // Ø¨Ø±Ø±Ø³ÛŒ Ø­Ø§ÙØ¸Ù‡ (Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ)
            if(currentToken) {
                if(document.cookie.includes(currentToken.substring(0, 10))) {
                    leaks.push('cookie');
                }
            }

            // Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡
            let resultHtml = '';
            if(leaks.length === 0) {
                resultHtml = '<div class="result-pass">âœ… Ù‡ÛŒÚ† Ù†Ø´Øª ØªÙˆÚ©Ù†ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</div>';
            } else {
                resultHtml = `<div class="result-fail">âŒ Ù†Ø´Øª ØªÙˆÚ©Ù† Ø¯Ø±: ${leaks.join(', ')}</div>`;
            }
            resultArea.innerHTML = resultHtml;
            
            addLog('ğŸ” Ø¨Ø±Ø±Ø³ÛŒ Ù†Ø´Øª Ú©Ø§Ù…Ù„ Ø´Ø¯: ' + (leaks.length ? leaks.length + ' Ù†Ø´Øª' : 'Ø¨Ø¯ÙˆÙ† Ù†Ø´Øª'));
        }

        function checkForTokenInLog(token) {
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø±Ø±Ø³ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§
            setTimeout(() => {
                addLog('ğŸ” Ø¨Ø±Ø±Ø³ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ù„Ø§Ú¯â€ŒÙ‡Ø§...');
                // 50% Ø´Ø§Ù†Ø³ ØªØ´Ø®ÛŒØµ Ù†Ø´Øª
                if(Math.random() > 0.5) {
                    addLog('âœ… Ø³ÛŒØ³ØªÙ… ØªØ´Ø®ÛŒØµ Ù†Ø´Øª: ØªÙˆÚ©Ù† Ø¯Ø± Ù„Ø§Ú¯â€ŒÙ‡Ø§ ÛŒØ§ÙØª Ø´Ø¯', true);
                }
            }, 1000);
        }

        function clearAll() {
            currentToken = null;
            tokenDisplay.textContent = 'ØªÙˆÚ©Ù†ÛŒ Ø³Ø§Ø®ØªÙ‡ Ù†Ø´Ø¯Ù‡';
            tokenDisplay.style.backgroundColor = '#f8f9fa';
            localStorage.clear();
            sessionStorage.clear();
            document.cookie.split(";").forEach(function(c) { 
                document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); 
            });
            logBox.innerHTML = '[Ø³ÛŒØ³ØªÙ…] Ù‡Ù…Ù‡ Ú†ÛŒØ² Ù¾Ø§Ú© Ø´Ø¯';
            resultArea.innerHTML = '';
            addLog('ğŸ§¹ Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯');
        }

        // ØªØ³Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
        window.onload = function() {
            addLog('ğŸ›¡ï¸ Ø³ÛŒØ³ØªÙ… ØªØ³Øª Ù†Ø´Øª ØªÙˆÚ©Ù† ÙØ¹Ø§Ù„ Ø´Ø¯');
            addLog('âš ï¸ ØªÙˆÚ©Ù†â€ŒÙ‡Ø§ Ù‡Ø±Ú¯Ø² Ù†Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ù„Ø§Ú¯ØŒ consoleØŒ URL ÛŒØ§ Ø®Ø·Ø§Ù‡Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆÙ†Ø¯');
        };
    </script>
</body>
</html>
