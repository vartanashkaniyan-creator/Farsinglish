<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª i18n - ÙØ±Ø³ÛŒÙ†Ú¯Ù„ÛŒØ´</title>
    <style>
        body {
            font-family: Tahoma, Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 15px;
            background: #f0f2f5;
        }
        .header {
            background: #1a3b4e;
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }
        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .lang-panel {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            justify-content: center;
        }
        .lang-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            font-weight: bold;
            background: #e9ecef;
            color: #1a3b4e;
            cursor: pointer;
            border: 2px solid transparent;
        }
        .lang-btn.active {
            background: #1a3b4e;
            color: white;
            border-color: #ffc107;
        }
        .test-row {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            background: #f8fafc;
            border-radius: 10px;
            flex-wrap: wrap;
        }
        .key {
            background: #dee2e6;
            padding: 8px 15px;
            border-radius: 20px;
            font-family: monospace;
            font-size: 15px;
            margin-left: 15px;
        }
        .value {
            background: #d1e7dd;
            padding: 8px 20px;
            border-radius: 20px;
            color: #0a3622;
            font-weight: bold;
            flex: 1;
            min-width: 150px;
        }
        button {
            background: #2c5f73;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 30px;
            font-size: 16px;
            cursor: pointer;
            margin: 5px;
            transition: 0.2s;
        }
        button:hover {
            background: #1e4454;
        }
        .log {
            background: #212529;
            color: #adb5bd;
            padding: 15px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 14px;
            direction: ltr;
            text-align: left;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 20px;
        }
        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            background: #ffc107;
            color: #000;
            font-size: 12px;
            margin-right: 10px;
        }
    </style>
</head>
<body>

<div class="header">
    <h1>ğŸŒ Farsinglish - i18n Fallback</h1>
    <p>ØªØ³Øª Ø¯Ø³ØªÛŒ Ú†Ù†Ø¯Ø²Ø¨Ø§Ù†Ù‡â€ŒØ³Ø§Ø²ÛŒ | Ù…ÙˆØ¨Ø§ÛŒÙ„/ÙˆØ¨</p>
</div>

<div class="card">
    <h2 style="margin-top:0; text-align:center;">Ø²Ø¨Ø§Ù† ÙØ¹Ø§Ù„: <span id="currentLang" style="background: #ffc107; color: #000; padding: 5px 15px; border-radius: 30px;">fa-IR</span></h2>
    
    <div class="lang-panel">
        <button class="lang-btn active" id="faBtn" onclick="setLang('fa-IR')">ğŸ‡®ğŸ‡· ÙØ§Ø±Ø³ÛŒ</button>
        <button class="lang-btn" id="enBtn" onclick="setLang('en-US')">ğŸ‡ºğŸ‡¸ English</button>
        <button class="lang-btn" id="esBtn" onclick="setLang('es-ES')">ğŸ‡ªğŸ‡¸ EspaÃ±ol</button>
        <button class="lang-btn" id="arBtn" onclick="setLang('ar-SA')">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
    </div>
</div>

<div class="card">
    <h3>ğŸ“‹ Û±. ØªØ±Ø¬Ù…Ù‡ Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ</h3>
    <div class="test-row">
        <span class="key">appName</span>
        <span id="valAppName" class="value">-</span>
    </div>
    <div class="test-row">
        <span class="key">welcome</span>
        <span id="valWelcome" class="value">-</span>
    </div>
    <div class="test-row">
        <span class="key">startLesson</span>
        <span id="valStartLesson" class="value">-</span>
    </div>
    <button onclick="testBasicKeys()">ğŸ” ØªØ³Øª Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡</button>
</div>

<div class="card">
    <h3>ğŸ”„ Û². ØªØ³Øª Fallback (Ø²Ø¨Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒâ€ŒÙ†Ø´Ø¯Ù‡)</h3>
    <p><span class="badge">Ø¢Ø²Ù…Ø§ÛŒØ´</span> Ø²Ø¨Ø§Ù† Ø§Ø³Ù¾Ø§Ù†ÛŒØ§ÛŒÛŒ Ùˆ Ø¹Ø±Ø¨ÛŒ Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ø¨Ø±Ú¯Ø±Ø¯Ø¯</p>
    <div class="test-row">
        <span class="key">startLesson Ø¨Ø§ es-ES</span>
        <span id="valFallback" class="value">-</span>
    </div>
    <button onclick="testFallback()">ğŸ”„ ØªØ³Øª Fallback</button>
</div>

<div class="card">
    <h3>â“ Û³. Ú©Ù„ÛŒØ¯ Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯</h3>
    <div class="test-row">
        <span class="key">unknownKey</span>
        <span id="valMissing" class="value">-</span>
    </div>
    <button onclick="testMissingKey()">â“ ØªØ³Øª Ú©Ù„ÛŒØ¯ Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯</button>
</div>

<div class="card">
    <h3>â• Û´. Ø§ÙØ²ÙˆØ¯Ù† Ú©Ù„ÛŒØ¯ Ø¬Ø¯ÛŒØ¯</h3>
    <div class="test-row">
        <span class="key">newFeature</span>
        <span id="valNewKey" class="value">-</span>
    </div>
    <button onclick="testNewKey()">â• ØªØ³Øª Ú©Ù„ÛŒØ¯ Ø¬Ø¯ÛŒØ¯</button>
</div>

<div class="card">
    <h3>ğŸ“ Ú¯Ø²Ø§Ø±Ø´ ØªØ³Øª</h3>
    <div id="logPanel" class="log">
        -- Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ ÛŒÚ©ÛŒ Ø§Ø² ØªØ³Øªâ€ŒÙ‡Ø§ Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯ --
    </div>
    <button onclick="clearLog()" style="background: #6c757d; margin-top: 10px;">ğŸ§¹ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú¯Ø²Ø§Ø±Ø´</button>
    <button onclick="runAllTests()" style="background: #198754;">ğŸš€ Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§</button>
</div>

<script>
    // ---------- Ø¯ÛŒÚ©Ø´Ù†Ø±ÛŒ Ø³Ø§Ø¯Ù‡ ----------
    const dictionary = {
        appName: {
            'fa-IR': 'ÙØ±Ø³ÛŒÙ†Ú¯Ù„ÛŒØ´',
            'en-US': 'Farsinglish'
        },
        welcome: {
            'fa-IR': 'Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯!',
            'en-US': 'Welcome!'
        },
        startLesson: {
            'fa-IR': 'Ø´Ø±ÙˆØ¹ Ø¯Ø±Ø³',
            'en-US': 'Start Lesson'
        },
        review: {
            'fa-IR': 'Ù…Ø±ÙˆØ± Ø§Ù…Ø±ÙˆØ²',
            'en-US': 'Today\'s Review'
        },
        score: {
            'fa-IR': 'Ø§Ù…ØªÛŒØ§Ø²',
            'en-US': 'Score'
        },
        streak: {
            'fa-IR': 'Ø±ÙˆØ²Ù‡Ø§ÛŒ Ù…ØªÙˆØ§Ù„ÛŒ',
            'en-US': 'Streak'
        }
    };

    // ---------- ÙˆØ¶Ø¹ÛŒØª ----------
    let currentLanguage = 'fa-IR';
    let logEntries = [];

    // ---------- ØªÙˆØ§Ø¨Ø¹ ØªØ±Ø¬Ù…Ù‡ ----------
    function translate(key, lang = currentLanguage) {
        // Ú©Ù„ÛŒØ¯ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯ØŸ
        if (!dictionary[key]) {
            log('âš ï¸ Ú©Ù„ÛŒØ¯ "' + key + '" ÛŒØ§ÙØª Ù†Ø´Ø¯ â†’ Ø®Ø§Ù„ÛŒ');
            return '';
        }
        
        // ØªØ±Ø¬Ù…Ù‡ Ù…Ø³ØªÙ‚ÛŒÙ…
        if (dictionary[key][lang] && dictionary[key][lang].trim() !== '') {
            return dictionary[key][lang];
        }
        
        // Fallback Ø¨Ù‡ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ
        if (dictionary[key]['en-US'] && dictionary[key]['en-US'].trim() !== '') {
            log('ğŸ”„ Fallback: ' + lang + ' â†’ en-US Ø¨Ø±Ø§ÛŒ Ú©Ù„ÛŒØ¯ "' + key + '"');
            return dictionary[key]['en-US'];
        }
        
        // Ù‡ÛŒÚ† ØªØ±Ø¬Ù…Ù‡â€ŒØ§ÛŒ Ù†ÛŒØ³Øª
        log('âŒ Ù‡ÛŒÚ† ØªØ±Ø¬Ù…Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ "' + key + '" Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª');
        return '';
    }

    function setLang(lang) {
        currentLanguage = lang;
        document.getElementById('currentLang').innerHTML = lang;
        
        // Ø¢Ù¾Ø¯ÛŒØª Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
        document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
        if (lang === 'fa-IR') document.getElementById('faBtn').classList.add('active');
        else if (lang === 'en-US') document.getElementById('enBtn').classList.add('active');
        else if (lang === 'es-ES') document.getElementById('esBtn').classList.add('active');
        else if (lang === 'ar-SA') document.getElementById('arBtn').classList.add('active');
        
        log('ğŸŒ Ø²Ø¨Ø§Ù† ØªØºÛŒÛŒØ± Ú©Ø±Ø¯ Ø¨Ù‡: ' + lang);
    }

    function log(msg) {
        const time = new Date().toLocaleTimeString('fa-IR');
        logEntries.push('[' + time + '] ' + msg);
        const logPanel = document.getElementById('logPanel');
        if (logPanel) {
            logPanel.innerHTML = logEntries.map(entry => 'ğŸ“Œ ' + entry).join('<br>');
            logPanel.scrollTop = logPanel.scrollHeight;
        }
    }

    function clearLog() {
        logEntries = [];
        document.getElementById('logPanel').innerHTML = '-- Ú¯Ø²Ø§Ø±Ø´ Ù¾Ø§Ú© Ø´Ø¯ --';
    }

    // ---------- ØªØ³Øªâ€ŒÙ‡Ø§ ----------
    function testBasicKeys() {
        log('ğŸ§ª ØªØ³Øª Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡ (Ø²Ø¨Ø§Ù†: ' + currentLanguage + ')');
        
        const appName = translate('appName');
        const welcome = translate('welcome');
        const startLesson = translate('startLesson');
        
        document.getElementById('valAppName').innerHTML = appName;
        document.getElementById('valWelcome').innerHTML = welcome;
        document.getElementById('valStartLesson').innerHTML = startLesson;
        
        log('   appName = "' + appName + '"');
        log('   welcome = "' + welcome + '"');
        log('   startLesson = "' + startLesson + '"');
    }

    function testFallback() {
        log('ğŸ§ª ØªØ³Øª Fallback - ØªØºÛŒÛŒØ± Ø¨Ù‡ es-ES');
        const originalLang = currentLanguage;
        
        setLang('es-ES');
        const value = translate('startLesson');
        document.getElementById('valFallback').innerHTML = value + ' (Ø§Ø² es-ES)';
        log('   startLesson Ø¨Ø§ es-ES = "' + value + '" (Ø¨Ø§ÛŒØ¯: Start Lesson)');
        
        setLang(originalLang);
    }

    function testMissingKey() {
        log('ğŸ§ª ØªØ³Øª Ú©Ù„ÛŒØ¯ Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯');
        const value = translate('unknownKey');
        document.getElementById('valMissing').innerHTML = value === '' ? '(Ø®Ø§Ù„ÛŒ - ØµØ­ÛŒØ­)' : value;
        log('   unknownKey = "' + value + '" (Ø¨Ø§ÛŒØ¯ Ø®Ø§Ù„ÛŒ Ø¨Ø§Ø´Ø¯)');
    }

    function testNewKey() {
        log('ğŸ§ª Ø§ÙØ²ÙˆØ¯Ù† Ú©Ù„ÛŒØ¯ Ø¬Ø¯ÛŒØ¯');
        
        // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú©Ù„ÛŒØ¯ Ø¬Ø¯ÛŒØ¯ Ø¨Ù‡ Ø¯ÛŒÚ©Ø´Ù†Ø±ÛŒ
        dictionary.newFeature = {
            'fa-IR': 'ÙˆÛŒÚ˜Ú¯ÛŒ Ø¬Ø¯ÛŒØ¯: Ù…Ø±ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯',
            'en-US': 'New Feature: Smart Review'
        };
        
        const value = translate('newFeature');
        document.getElementById('valNewKey').innerHTML = value;
        log('   newFeature = "' + value + '"');
    }

    function runAllTests() {
        clearLog();
        log('ğŸš€ Ø§Ø¬Ø±Ø§ÛŒ ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§...');
        
        setLang('fa-IR');
        testBasicKeys();
        testFallback();
        testMissingKey();
        testNewKey();
        
        log('âœ… ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§ Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù†Ø¯. Ø®Ø±ÙˆØ¬ÛŒ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯.');
    }

    // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
    window.onload = function() {
        setLang('fa-IR');
        clearLog();
        log('ğŸŒ Ù…Ø§Ú˜ÙˆÙ„ i18n Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª. Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ ÙØ¹Ø§Ù„ Ø§Ø³Øª.');
    };
</script>

</body>
</html>
