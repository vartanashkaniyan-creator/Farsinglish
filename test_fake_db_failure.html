<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª: Fake DB Failure Â· Farsinglish</title>
    <style>
        body {
            font-family: 'Vazir', 'Tahoma', sans-serif;
            background: #f7f9fc;
            margin: 0;
            padding: 20px;
            color: #1e293b;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 12px 30px rgba(0,0,0,0.1);
            padding: 28px 24px;
            border: 1px solid #e9eef2;
        }
        h1 {
            font-size: 1.8rem;
            margin-top: 0;
            margin-bottom: 8px;
            color: #0f2b3d;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .subtitle {
            font-size: 1rem;
            color: #4b5e71;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 16px;
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
        }
        .badge {
            background: #dbeafe;
            color: #1e40af;
            padding: 4px 12px;
            border-radius: 40px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .section {
            background: #f8fafc;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 28px;
            border: 1px solid #dee7ed;
        }
        .section h2 {
            font-size: 1.4rem;
            margin-top: 0;
            margin-bottom: 18px;
            color: #163a5c;
            border-right: 5px solid #3b82f6;
            padding-right: 16px;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        .test-card {
            background: white;
            border-radius: 18px;
            padding: 18px 16px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.02);
            border: 1px solid #e2e8f0;
            transition: all 0.1s ease;
        }
        .test-card h3 {
            font-size: 1.15rem;
            margin: 0 0 12px 0;
            color: #1e3a5f;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .btn {
            background: white;
            border: 2px solid #3b82f6;
            color: #3b82f6;
            padding: 10px 20px;
            border-radius: 40px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: 0.1s;
            margin: 8px 6px 8px 0;
            box-shadow: 0 2px 6px rgba(0,0,0,0.03);
        }
        .btn:hover {
            background: #3b82f6;
            color: white;
            border-color: #2563eb;
        }
        .btn.small {
            padding: 6px 16px;
            font-size: 0.8rem;
        }
        .btn.danger {
            border-color: #dc2626;
            color: #b91c1c;
        }
        .btn.danger:hover {
            background: #dc2626;
            color: white;
        }
        .btn.secondary {
            border-color: #64748b;
            color: #334155;
        }
        .btn.secondary:hover {
            background: #475569;
            border-color: #334155;
            color: white;
        }
        .log-console {
            background: #0b1e2e;
            color: #bbdbf3;
            border-radius: 16px;
            padding: 18px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            max-height: 270px;
            overflow-y: auto;
            border: 1px solid #2d3f53;
            margin: 18px 0 10px;
        }
        .log-success {
            color: #a3e8a3;
        }
        .log-error {
            color: #f9acac;
        }
        .log-warning {
            color: #fdd98a;
        }
        .flex-row {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 10px;
            margin: 12px 0;
        }
        .assertion-list {
            list-style: none;
            padding: 0;
            margin: 12px 0 0;
        }
        .assertion-list li {
            background: #ecfdf5;
            border-radius: 30px;
            padding: 8px 18px;
            margin: 6px 0;
            border-right: 5px solid #059669;
            font-size: 0.9rem;
        }
        hr {
            border: none;
            border-top: 2px dashed #cbd5e1;
            margin: 24px 0;
        }
        .status-badge {
            display: inline-block;
            background: #e6f7e6;
            color: #0a7143;
            border-radius: 40px;
            padding: 6px 20px;
            font-weight: 600;
            font-size: 0.85rem;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>ğŸ“¦ ØªØ³Øª Ø¯Ø³ØªÛŒ Â· Ø®Ø±Ø§Ø¨ÛŒâ€ŒÙ‡Ø§ÛŒ Fake DB</h1>
    <div class="subtitle">
        <span>ğŸ” Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ failure / reject / timeout Â· <span class="badge">Fake DB Failure</span></span>
        <span>ğŸ§ª Û¶ Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Ú©Ù†ØªØ±Ù„ÛŒ</span>
    </div>

    <!-- ========== Ù…Ø§Ú˜ÙˆÙ„ FakeDB (Ø³Ø§Ø¯Ù‡ØŒ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²) ========== -->
    <div class="section">
        <h2>ğŸ§° Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ FakeDB (Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª failure)</h2>
        <p style="margin: 0 0 14px 0;">ÛŒÚ© Ø´ÛŒØ¡ fake Ø¨Ø§ Ù…ØªØ¯Ù‡Ø§ÛŒ get, save, delete Ú©Ù‡ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø®Ø·Ø§ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ù†Ø¯.</p>
        <div class="flex-row">
            <button class="btn small" id="resetFakeDbBtn">ğŸ”„ Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ø¨Ù‡ Ø­Ø§Ù„Øª Ø¹Ø§Ø¯ÛŒ (Ø¨Ø¯ÙˆÙ† Ø®Ø·Ø§)</button>
            <button class="btn small danger" id="injectGetFailure">ğŸ“› ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø®Ø·Ø§ Ø¯Ø± get</button>
            <button class="btn small danger" id="injectSaveFailure">ğŸ“› ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø®Ø·Ø§ Ø¯Ø± save</button>
            <button class="btn small danger" id="injectDeleteFailure">ğŸ“› ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø®Ø·Ø§ Ø¯Ø± delete</button>
            <button class="btn small secondary" id="simulateTimeout">â³ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ timeout (ØªØ£Ø®ÛŒØ± Ûµ Ø«Ø§Ù†ÛŒÙ‡)</button>
        </div>

        <!-- Ú©Ù†Ø³ÙˆÙ„ Ù„Ø§Ú¯ Ù…Ø®ØµÙˆØµ Ø§ÛŒÙ† Ø¨Ø®Ø´ -->
        <div class="log-console" id="fakeDbConsole">
[FakeDB] Ø¯Ø± ÙˆØ¶Ø¹ÛŒØª Ø¹Ø§Ø¯ÛŒ â€“ Ù…ØªØ¯Ù‡Ø§ Ø¨Ø¯ÙˆÙ† Ø®Ø·Ø§ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯.
        </div>
    </div>

    <!-- ========== Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ÛŒ ØªØ³Øª ========== -->
    <div class="section">
        <h2>ğŸ§ª Û¶ ØªØ³Øª Ø¯Ø³ØªÛŒ Ø®Ø±Ø§Ø¨ÛŒ (Ø¨Ø§ Ø¯Ú©Ù…Ù‡)</h2>
        <div class="test-grid">
            <!-- Ú©Ø§Ø±Øª 1 -->
            <div class="test-card">
                <h3>ğŸ”¹ Û±. get() Ø¨Ø§ Ø®Ø·Ø§ÛŒ ÙØ¹Ø§Ù„</h3>
                <p>Ø§Ø¨ØªØ¯Ø§ Â«ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø®Ø·Ø§ Ø¯Ø± getÂ» Ø±Ø§ Ø¨Ø²Ù†ØŒ Ø³Ù¾Ø³ Ø§ÛŒÙ† ØªØ³Øª Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†.</p>
                <button class="btn small" id="testGetFailureBtn">âš¡ Ø§Ø¬Ø±Ø§ÛŒ get Ùˆ Ø¨Ø±Ø±Ø³ÛŒ rejection</button>
                <div style="margin-top: 10px; font-size:0.85rem; background:#f1f5f9; padding:8px; border-radius:12px;" id="resultGetFailure">ÙˆØ¶Ø¹ÛŒØª: Ø¢Ù…Ø§Ø¯Ù‡</div>
            </div>
            <!-- Ú©Ø§Ø±Øª 2 -->
            <div class="test-card">
                <h3>ğŸ”¹ Û². save() Ø¨Ø§ Ø®Ø·Ø§ÛŒ ÙØ¹Ø§Ù„</h3>
                <button class="btn small" id="testSaveFailureBtn">ğŸ’¾ save Ø¨Ø§ rejection</button>
                <div style="margin-top: 10px; background:#f1f5f9; padding:8px; border-radius:12px;" id="resultSaveFailure">ÙˆØ¶Ø¹ÛŒØª: Ø¢Ù…Ø§Ø¯Ù‡</div>
            </div>
            <!-- Ú©Ø§Ø±Øª 3 -->
            <div class="test-card">
                <h3>ğŸ”¹ Û³. delete() Ø¨Ø§ Ø®Ø·Ø§ÛŒ ÙØ¹Ø§Ù„</h3>
                <button class="btn small" id="testDeleteFailureBtn">ğŸ—‘ï¸ delete Ø¨Ø§ rejection</button>
                <div style="margin-top: 10px; background:#f1f5f9; padding:8px; border-radius:12px;" id="resultDeleteFailure">ÙˆØ¶Ø¹ÛŒØª: Ø¢Ù…Ø§Ø¯Ù‡</div>
            </div>
            <!-- Ú©Ø§Ø±Øª 4 -->
            <div class="test-card">
                <h3>ğŸ”¹ Û´. timeout Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒâ€ŒØ´Ø¯Ù‡</h3>
                <button class="btn small" id="testTimeoutBtn">â±ï¸ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ø§ ØªØ£Ø®ÛŒØ± (reject Ø¨Ø¹Ø¯ Ø§Ø² Ûµs)</button>
                <div style="margin-top: 10px; background:#f1f5f9; padding:8px; border-radius:12px;" id="resultTimeout">ÙˆØ¶Ø¹ÛŒØª: Ø¢Ù…Ø§Ø¯Ù‡</div>
            </div>
            <!-- Ú©Ø§Ø±Øª 5 -->
            <div class="test-card">
                <h3>ğŸ”¹ Ûµ. get Ø±ÙˆÛŒ Ú©Ù„ÛŒØ¯ Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯ (Ø¨Ø¯ÙˆÙ† Ø®Ø·Ø§)</h3>
                <button class="btn small" id="testGetMissingBtn">ğŸ” get('ghost')</button>
                <div style="margin-top: 10px; background:#f1f5f9; padding:8px; border-radius:12px;" id="resultMissing">ÙˆØ¶Ø¹ÛŒØª: Ø¢Ù…Ø§Ø¯Ù‡</div>
            </div>
            <!-- Ú©Ø§Ø±Øª 6 -->
            <div class="test-card">
                <h3>ğŸ”¹ Û¶. save Ø¨Ø§ Ø¯Ø§Ø¯Ù‡ Ø®Ø±Ø§Ø¨ (null)</h3>
                <button class="btn small" id="testSaveNullBtn">ğŸ’¾ save(null)</button>
                <div style="margin-top: 10px; background:#f1f5f9; padding:8px; border-radius:12px;" id="resultSaveNull">ÙˆØ¶Ø¹ÛŒØª: Ø¢Ù…Ø§Ø¯Ù‡</div>
            </div>
        </div>
    </div>

    <!-- ========== Ù†Ù…Ø§ÛŒØ´ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ (contract) ========== -->
    <div class="section">
        <h2>ğŸ“œ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ (Contract) Â· Fake DB Ø¨Ø§ÛŒØ¯ ...</h2>
        <ul class="assertion-list">
            <li>âœ… Ø§Ú¯Ø± failure ÙØ¹Ø§Ù„ Ø¨Ø§Ø´Ø¯ØŒ Promise.reject (Ø¨Ø§ Ù¾ÛŒØ§Ù… Ø®Ø·Ø§) Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯.</li>
            <li>âœ… Ø¯Ø± Ø­Ø§Ù„Øª Ø¹Ø§Ø¯ÛŒ Ø¯Ø§Ø¯Ù‡ Ø±Ø§ Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯ ÛŒØ§ Ø°Ø®ÛŒØ±Ù‡â€ŒØ´Ø¯Ù‡ ØªÙ„Ù‚ÛŒ Ú©Ù†Ø¯.</li>
            <li>âœ… Ø¨Ø±Ø§ÛŒ Ú©Ù„ÛŒØ¯ Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯ reject Ù†Ú©Ù†Ø¯ØŒ Ø¨Ù„Ú©Ù‡ null ÛŒØ§ undefined Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯.</li>
            <li>âœ… timeout Ø±Ø§ Ø¨Ø§ reject Ù¾Ø³ Ø§Ø² ØªØ£Ø®ÛŒØ± Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ù†Ø¯.</li>
            <li>âœ… ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø± (null) Ø±Ø§ Ø¯ÙØ¹ Ú©Ù†Ø¯ ÛŒØ§ reject Ú©Ù†Ø¯ (Ø¨Ø³ØªÙ‡ Ø¨Ù‡ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ).</li>
        </ul>
    </div>

    <hr>
    <div class="flex-row" style="justify-content: space-between;">
        <span class="status-badge">âœ… ØªØ³Øª Ø¯Ø³ØªÛŒ Â· Ø¨Ø¯ÙˆÙ† Ø®ÙˆØ¯Ú©Ø§Ø±</span>
        <span>ğŸ”¸ Ù‡Ø± Ø¯Ú©Ù…Ù‡ ÛŒÚ© Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Ù…Ø³ØªÙ‚Ù„ Ø±Ø§ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</span>
    </div>
</div>

<script>
    (function() {
        // ----- ÙˆØ¶Ø¹ÛŒØª fakeDB Ùˆ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ø®Ø·Ø§ -----
        let failureConfig = {
            get: false,
            save: false,
            delete: false,
            timeoutDelay: 0, // 0 ÛŒØ¹Ù†ÛŒ Ø¨Ø¯ÙˆÙ† timeout
        };

        // Ø§Ø³ØªÙˆØ± Ø³Ø§Ø¯Ù‡ Ø¯Ø±ÙˆÙ†â€ŒØ­Ø§ÙØ¸Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ
        const memoryStore = new Map();
        memoryStore.set('user_1', { id: 1, name: 'Ø¹Ù„ÛŒ' });
        memoryStore.set('lesson_5', { id: 5, title: 'Ø¯Ø±Ø³ Ù†Ù…ÙˆÙ†Ù‡' });

        // ----- Ø§Ø¨Ø²Ø§Ø± Ú©Ù…Ú©ÛŒ Ø¨Ø±Ø§ÛŒ Ù„Ø§Ú¯ Ø¯Ø± Ú©Ù†Ø³ÙˆÙ„ Ø§Ø®ØªØµØ§ØµÛŒ -----
        const consoleDiv = document.getElementById('fakeDbConsole');
        function logToConsole(message, type = 'info') {
            const prefix = {
                info: 'ğŸ“Œ',
                success: 'âœ…',
                error: 'âŒ',
                warning: 'âš ï¸'
            }[type] || 'â€¢';
            const colorClass = type === 'error' ? 'log-error' : (type === 'success' ? 'log-success' : (type === 'warning' ? 'log-warning' : ''));
            const line = `<span class="${colorClass}">${prefix} ${message}</span>`;
            consoleDiv.innerHTML += '\n' + line;
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        // Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ú©Ù†Ø³ÙˆÙ„ Ù†ÛŒØ³ØªØŒ Ø§Ù…Ø§ ÛŒÚ© Ø®Ø· Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ….
        function resetConsoleToDefault() {
            consoleDiv.innerHTML = `[FakeDB] Ø¯Ø± ÙˆØ¶Ø¹ÛŒØª Ø¹Ø§Ø¯ÛŒ â€“ Ù…ØªØ¯Ù‡Ø§ Ø¨Ø¯ÙˆÙ† Ø®Ø·Ø§ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯.\n(Ø¨Ø§ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ failure Ø±Ø§ ÙØ¹Ø§Ù„ Ú©Ù†)`;
        }

        // ----- Ù…ØªØ¯Ù‡Ø§ÛŒ Ø¬Ø¹Ù„ÛŒ (fake) Ø¨Ø§ Ø¯Ø± Ù†Ø¸Ø± Ú¯Ø±ÙØªÙ† failureConfig -----
        function fakeGet(key) {
            logToConsole(`get("${key}") ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ø´Ø¯.`, 'info');
            return new Promise((resolve, reject) => {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ timeout Ø§Ú¯Ø± ÙØ¹Ø§Ù„ Ø¨Ø§Ø´Ø¯
                if (failureConfig.timeoutDelay > 0) {
                    logToConsole(`â³ timeout Ø¨Ù‡ Ù…Ø¯Øª ${failureConfig.timeoutDelay}ms ÙØ¹Ø§Ù„ Ø§Ø³Øª.`, 'warning');
                    setTimeout(() => {
                        reject(new Error(`timeout Ù¾Ø³ Ø§Ø² ${failureConfig.timeoutDelay}ms`));
                    }, failureConfig.timeoutDelay);
                    return;
                }
                // Ø®Ø·Ø§ÛŒ get ÙØ¹Ø§Ù„ØŸ
                if (failureConfig.get) {
                    logToConsole(`âŒ get Ø¨Ø§ Ø®Ø·Ø§ÛŒ ÙØ¹Ø§Ù„ reject Ù…ÛŒâ€ŒØ´ÙˆØ¯.`, 'error');
                    reject(new Error('Ø®Ø·Ø§ÛŒ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒâ€ŒØ´Ø¯Ù‡: Ù…ØªØ¯ get Ø®Ø±Ø§Ø¨ Ø§Ø³Øª.'));
                    return;
                }
                // Ø­Ø§Ù„Øª Ø¹Ø§Ø¯ÛŒ
                if (memoryStore.has(key)) {
                    const data = memoryStore.get(key);
                    logToConsole(`âœ… Ø¯Ø§Ø¯Ù‡â€ŒÛŒ Ú©Ù„ÛŒØ¯ "${key}" Ù¾ÛŒØ¯Ø§ Ø´Ø¯.`, 'success');
                    resolve(data);
                } else {
                    logToConsole(`ğŸ”¸ Ú©Ù„ÛŒØ¯ "${key}" ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯ØŒ null Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†ÛŒÙ….`, 'warning');
                    resolve(null);  // Ø¨Ø± Ø§Ø³Ø§Ø³ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ reject Ù†Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
                }
            });
        }

        function fakeSave(key, value) {
            logToConsole(`save("${key}", value) ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ø´Ø¯.`, 'info');
            return new Promise((resolve, reject) => {
                if (failureConfig.timeoutDelay > 0) {
                    logToConsole(`â³ timeout (save) Ø¨Ù‡ Ù…Ø¯Øª ${failureConfig.timeoutDelay}ms`, 'warning');
                    setTimeout(() => reject(new Error('timeout Ø¯Ø± save')), failureConfig.timeoutDelay);
                    return;
                }
                if (failureConfig.save) {
                    logToConsole(`âŒ save Ø¨Ø§ Ø®Ø·Ø§ÛŒ ÙØ¹Ø§Ù„ reject`, 'error');
                    reject(new Error('Ø®Ø·Ø§ÛŒ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒâ€ŒØ´Ø¯Ù‡: save Ø®Ø±Ø§Ø¨ Ø§Ø³Øª.'));
                    return;
                }
                if (value === null || value === undefined) {
                    logToConsole(`âš ï¸ ÙˆØ±ÙˆØ¯ÛŒ null/undefined Ø§Ø³Øª.`, 'warning');
                    // Ø¨Ø³ØªÙ‡ Ø¨Ù‡ Ø¯ÛŒØ²Ø§ÛŒÙ† Ù…ÛŒâ€ŒØªÙˆØ§Ù† reject Ú©Ø±Ø¯ ÛŒØ§ Ø°Ø®ÛŒØ±Ù‡ Ù†Ú©Ø±Ø¯
                    // Ø§ÛŒÙ†Ø¬Ø§ reject Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ….
                    reject(new Error('Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ù…Ø¹ØªØ¨Ø±: Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù† null Ø°Ø®ÛŒØ±Ù‡ Ú©Ø±Ø¯.'));
                    return;
                }
                memoryStore.set(key, value);
                logToConsole(`âœ… Ø¯Ø§Ø¯Ù‡ Ø¨Ø§ Ú©Ù„ÛŒØ¯ "${key}" Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯.`, 'success');
                resolve({ ok: true, key });
            });
        }

        function fakeDelete(key) {
            logToConsole(`delete("${key}")`, 'info');
            return new Promise((resolve, reject) => {
                if (failureConfig.timeoutDelay > 0) {
                    logToConsole(`â³ timeout (delete)`, 'warning');
                    setTimeout(() => reject(new Error('timeout delete')), failureConfig.timeoutDelay);
                    return;
                }
                if (failureConfig.delete) {
                    logToConsole(`âŒ delete Ø¨Ø§ Ø®Ø·Ø§ÛŒ ÙØ¹Ø§Ù„ reject`, 'error');
                    reject(new Error('Ø®Ø·Ø§ÛŒ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒâ€ŒØ´Ø¯Ù‡: delete Ø®Ø±Ø§Ø¨ Ø§Ø³Øª.'));
                    return;
                }
                if (memoryStore.has(key)) {
                    memoryStore.delete(key);
                    logToConsole(`âœ… Ú©Ù„ÛŒØ¯ "${key}" Ø­Ø°Ù Ø´Ø¯.`, 'success');
                    resolve({ deleted: true });
                } else {
                    logToConsole(`ğŸ”¸ Ú©Ù„ÛŒØ¯ "${key}" ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø´ØªØŒ Ø§Ù…Ø§ Ø¹Ù…Ù„ÛŒØ§Øª Ù…ÙˆÙÙ‚ Ù…Ø­Ø³ÙˆØ¨ Ù…ÛŒâ€ŒØ´ÙˆØ¯.`, 'warning');
                    resolve({ deleted: false });
                }
            });
        }

        // ----- ØªÙˆØ§Ø¨Ø¹ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ (Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´) -----
        function refreshUIAfterAction(elementId, message, isError = false) {
            const el = document.getElementById(elementId);
            if (el) {
                el.innerText = isError ? `âŒ Ø®Ø·Ø§: ${message.substring(0, 40)}` : `âœ… Ù†ØªÛŒØ¬Ù‡: ${message}`;
                el.style.background = isError ? '#fee2e2' : '#e6f7e6';
            }
        }

        // ----- Ø§ØªØµØ§Ù„ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ -----
        document.getElementById('resetFakeDbBtn').addEventListener('click', function() {
            failureConfig = { get: false, save: false, delete: false, timeoutDelay: 0 };
            resetConsoleToDefault();
            // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù†ØªØ§ÛŒØ¬
            ['resultGetFailure','resultSaveFailure','resultDeleteFailure','resultTimeout','resultMissing','resultSaveNull'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.innerText = 'ÙˆØ¶Ø¹ÛŒØª: Ø¢Ù…Ø§Ø¯Ù‡';
            });
            logToConsole('ğŸ” ØªÙ†Ø¸ÛŒÙ…Ø§Øª failure Ø¨Ù‡ Ø­Ø§Ù„Øª Ø¹Ø§Ø¯ÛŒ Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù‡ Ø´Ø¯.', 'success');
        });

        document.getElementById('injectGetFailure').addEventListener('click', function() {
            failureConfig = { ...failureConfig, get: true, save: false, delete: false, timeoutDelay: 0 };
            logToConsole('âŒâŒ failure.get = true (Ø®Ø·Ø§ÛŒ get ÙØ¹Ø§Ù„ Ø´Ø¯)', 'error');
        });
        document.getElementById('injectSaveFailure').addEventListener('click', function() {
            failureConfig = { ...failureConfig, save: true, get: false, delete: false, timeoutDelay: 0 };
            logToConsole('âŒâŒ failure.save = true (Ø®Ø·Ø§ÛŒ save ÙØ¹Ø§Ù„ Ø´Ø¯)', 'error');
        });
        document.getElementById('injectDeleteFailure').addEventListener('click', function() {
            failureConfig = { ...failureConfig, delete: true, get: false, save: false, timeoutDelay: 0 };
            logToConsole('âŒâŒ failure.delete = true (Ø®Ø·Ø§ÛŒ delete ÙØ¹Ø§Ù„ Ø´Ø¯)', 'error');
        });
        document.getElementById('simulateTimeout').addEventListener('click', function() {
            failureConfig = { ...failureConfig, timeoutDelay: 5000, get: false, save: false, delete: false };
            logToConsole('â³â³ timeout ÙØ¹Ø§Ù„ Ø´Ø¯: Ûµ Ø«Ø§Ù†ÛŒÙ‡ ØªØ£Ø®ÛŒØ± (Ø¨Ø±Ø§ÛŒ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ø¨Ø¹Ø¯ÛŒ)', 'warning');
        });

        // ----- Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ÛŒ ØªØ³Øª -----
        document.getElementById('testGetFailureBtn').addEventListener('click', function() {
            fakeGet('user_1')
                .then(data => refreshUIAfterAction('resultGetFailure', `Ø¯Ø§Ø¯Ù‡ Ø¯Ø±ÛŒØ§ÙØªÛŒ: ${JSON.stringify(data)}`))
                .catch(err => refreshUIAfterAction('resultGetFailure', err.message, true));
        });

        document.getElementById('testSaveFailureBtn').addEventListener('click', function() {
            fakeSave('tempKey', { value: 123 })
                .then(res => refreshUIAfterAction('resultSaveFailure', `Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯: ${JSON.stringify(res)}`))
                .catch(err => refreshUIAfterAction('resultSaveFailure', err.message, true));
        });

        document.getElementById('testDeleteFailureBtn').addEventListener('click', function() {
            fakeDelete('lesson_5')
                .then(res => refreshUIAfterAction('resultDeleteFailure', `Ø­Ø°Ù: ${JSON.stringify(res)}`))
                .catch(err => refreshUIAfterAction('resultDeleteFailure', err.message, true));
        });

        document.getElementById('testTimeoutBtn').addEventListener('click', function() {
            // Ø­ØªÙ…Ø§Ù‹ Ø§Ø² timeout Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŒ Ø§Ú¯Ø± ÙØ¹Ø§Ù„ Ù†Ø¨Ø§Ø´Ø¯ Ø¨Ø¨ÛŒÙ†ÛŒÙ…
            if (failureConfig.timeoutDelay === 0) {
                logToConsole('âš ï¸ timeout ÙØ¹Ø§Ù„ Ù†ÛŒØ³ØªØŒ Ø§Ù…Ø§ ØªØ³Øª Ø¨Ø§ reject ÙÙˆØ±ÛŒ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŸ (Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯ Ø¯Ú©Ù…Ù‡ timeout Ø±Ø§ Ø²Ø¯Ù‡â€ŒØ§ÛŒØ¯)', 'warning');
            }
            fakeGet('anyKey')
                .then(data => refreshUIAfterAction('resultTimeout', `Ø¹Ø§Ø¯ÛŒ: ${JSON.stringify(data)}`))
                .catch(err => refreshUIAfterAction('resultTimeout', `reject Ø¨Ù‡ Ø¯Ù„ÛŒÙ„: ${err.message}`, true));
        });

        document.getElementById('testGetMissingBtn').addEventListener('click', function() {
            fakeGet('ghostKey')
                .then(data => {
                    if (data === null) refreshUIAfterAction('resultMissing', 'null (Ú©Ù„ÛŒØ¯ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª)');
                    else refreshUIAfterAction('resultMissing', `Ø¯Ø§Ø¯Ù‡: ${JSON.stringify(data)}`);
                })
                .catch(err => refreshUIAfterAction('resultMissing', `Ø®Ø·Ø§: ${err.message}`, true));
        });

        document.getElementById('testSaveNullBtn').addEventListener('click', function() {
            fakeSave('nullTest', null)
                .then(res => refreshUIAfterAction('resultSaveNull', `Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯: ${JSON.stringify(res)}`))
                .catch(err => refreshUIAfterAction('resultSaveNull', `Ø®Ø·Ø§: ${err.message}`, true));
        });

        // Ù…Ù‚Ø¯Ø§Ø± Ø§ÙˆÙ„ÛŒÙ‡ Ú©Ù†Ø³ÙˆÙ„
        resetConsoleToDefault();
    })();
</script>
</body>
</html>
