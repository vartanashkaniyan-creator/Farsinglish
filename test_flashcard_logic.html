<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª ÙÙ„Ø´ Ú©Ø§Ø±Øª - Farsinglish</title>
    <style>
        body {
            font-family: 'Vazir', 'Tahoma', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            max-width: 800px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 30px;
            margin: 20px auto;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            font-size: 18px;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        .card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border-right: 4px solid #667eea;
        }
        .flashcard-preview {
            background: #fff;
            border: 2px solid #667eea;
            border-radius: 15px;
            padding: 40px;
            margin: 20px 0;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            color: #333;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
            transition: all 0.3s;
        }
        .flashcard-preview.flipped {
            background: #667eea;
            color: white;
            transform: scale(1.02);
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
            font-family: 'Vazir', 'Tahoma', sans-serif;
        }
        button:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .test-row {
            background: #fff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
        }
        .test-title {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .output {
            background: #272822;
            color: #f8f8f2;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            margin-top: 10px;
            white-space: pre-wrap;
            direction: ltr;
            text-align: left;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background: #667eea;
            color: white;
        }
        .summary {
            background: #28a745;
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ´ ØªØ³Øª ÙÙ„Ø´ Ú©Ø§Ø±Øª - Farsinglish</h1>
        <p style="text-align: center; color: #666; margin-bottom: 30px;">ØªØ³Øª Ø¯Ø³ØªÛŒ Ù…Ù†Ø·Ù‚ ÙÙ„Ø´ Ú©Ø§Ø±Øª Ø¨Ø§ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ÛŒ</p>

        <div class="flashcard-preview" id="previewCard">
            ğŸ‘† Ø¨Ø±Ø§ÛŒ ØªØ³ØªØŒ ÛŒÚ© Ø³Ù†Ø§Ø±ÛŒÙˆ Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯
        </div>

        <!-- FlashCard Class -->
        <div class="card">
            <h2>ğŸ“¦ Ú©Ù„Ø§Ø³ FlashCard</h2>
            <button onclick="runAllTests()">â–¶ Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§</button>
            <button onclick="resetAll()">ğŸ”„ Ø±ÛŒØ³Øª Ù‡Ù…Ù‡</button>
        </div>

        <!-- Test 1: Ø³Ø§Ø®Øª ÙÙ„Ø´ Ú©Ø§Ø±Øª -->
        <div class="test-row" id="test1">
            <div class="test-title">ğŸ§ª ØªØ³Øª Û±: Ø³Ø§Ø®Øª ÙÙ„Ø´ Ú©Ø§Ø±Øª Ù…Ø¹ØªØ¨Ø±</div>
            <button onclick="testCreateValidCard()">Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª</button>
            <button onclick="resetTest(1)">Ø±ÛŒØ²Ø³Øª</button>
            <div id="output1" class="output">Ù…Ù†ØªØ¸Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª...</div>
        </div>

        <!-- Test 2: Flip Ú©Ø§Ø±Øª -->
        <div class="test-row" id="test2">
            <div class="test-title">ğŸ”„ ØªØ³Øª Û²: Flip Ú©Ø§Ø±Øª</div>
            <button onclick="testFlipCard()">Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª</button>
            <button onclick="resetTest(2)">Ø±ÛŒØ²Ø³Øª</button>
            <div id="output2" class="output">Ù…Ù†ØªØ¸Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª...</div>
        </div>

        <!-- Test 3: Reveal Ù¾Ø§Ø³Ø® -->
        <div class="test-row" id="test3">
            <div class="test-title">ğŸ” ØªØ³Øª Û³: Reveal Ù¾Ø§Ø³Ø®</div>
            <button onclick="testRevealAnswer()">Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª</button>
            <button onclick="resetTest(3)">Ø±ÛŒØ²Ø³Øª</button>
            <div id="output3" class="output">Ù…Ù†ØªØ¸Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª...</div>
        </div>

        <!-- Test 4: Reset Ú©Ø§Ø±Øª -->
        <div class="test-row" id="test4">
            <div class="test-title">ğŸ”„ ØªØ³Øª Û´: Reset Ú©Ø§Ø±Øª</div>
            <button onclick="testResetCard()">Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª</button>
            <button onclick="resetTest(4)">Ø±ÛŒØ²Ø³Øª</button>
            <div id="output4" class="output">Ù…Ù†ØªØ¸Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª...</div>
        </div>

        <!-- Test 5: Edge Cases -->
        <div class="test-row" id="test5">
            <div class="test-title">âš ï¸ ØªØ³Øª Ûµ: Edge Cases</div>
            <button onclick="testEdgeCases()">Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª</button>
            <button onclick="resetTest(5)">Ø±ÛŒØ²Ø³Øª</button>
            <div id="output5" class="output">Ù…Ù†ØªØ¸Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª...</div>
        </div>

        <!-- Ø®Ù„Ø§ØµÙ‡ Ù†ØªØ§ÛŒØ¬ -->
        <div id="summary" class="summary">
            âœ… Ù…Ø¬Ù…ÙˆØ¹ ØªØ³Øªâ€ŒÙ‡Ø§: Û° Ø§Ø² Ûµ Ù…ÙˆÙÙ‚
        </div>
    </div>

    <script>
        // FlashCard Class
        class FlashCard {
            constructor(question, answer, options = {}) {
                if (!question || typeof question !== 'string') {
                    throw new Error('Ø³ÙˆØ§Ù„ Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª');
                }
                if (!answer || typeof answer !== 'string') {
                    throw new Error('Ù¾Ø§Ø³Ø® Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª');
                }
                
                this.id = options.id || Date.now() + Math.random().toString(36);
                this.question = question;
                this.answer = answer;
                this.isFlipped = false;
                this.isAnswered = false;
                this.userAnswer = null;
                this.isCorrect = null;
                this.createdAt = new Date();
                this.lastReviewed = null;
            }

            flip() {
                this.isFlipped = !this.isFlipped;
                return this.isFlipped;
            }

            reveal() {
                this.isFlipped = true;
                return this.answer;
            }

            reset() {
                this.isFlipped = false;
                this.isAnswered = false;
                this.userAnswer = null;
                this.isCorrect = null;
                this.lastReviewed = null;
            }

            checkAnswer(userAnswer) {
                this.userAnswer = userAnswer;
                this.isAnswered = true;
                this.lastReviewed = new Date();
                
                // Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø³Ø§Ø¯Ù‡ (Ø¨Ø¯ÙˆÙ† Ø¯Ø± Ù†Ø¸Ø± Ú¯Ø±ÙØªÙ† case Ùˆ space)
                const normalizedUser = userAnswer.trim().toLowerCase();
                const normalizedCorrect = this.answer.trim().toLowerCase();
                this.isCorrect = normalizedUser === normalizedCorrect;
                
                return this.isCorrect;
            }

            getState() {
                return {
                    id: this.id,
                    question: this.question,
                    answer: this.answer,
                    isFlipped: this.isFlipped,
                    isAnswered: this.isAnswered,
                    userAnswer: this.userAnswer,
                    isCorrect: this.isCorrect,
                    createdAt: this.createdAt,
                    lastReviewed: this.lastReviewed
                };
            }
        }

        // Test Results
        let testResults = {
            1: false,
            2: false,
            3: false,
            4: false,
            5: false
        };

        // Helper function for logging
        function log(outputId, message, isSuccess = true) {
            const output = document.getElementById(outputId);
            if (output) {
                const icon = isSuccess ? 'âœ…' : 'âŒ';
                output.innerHTML = `${icon} ${message}`;
            }
        }

        // Update summary
        function updateSummary() {
            const total = Object.values(testResults).filter(v => v).length;
            document.getElementById('summary').innerHTML = `âœ… Ù…Ø¬Ù…ÙˆØ¹ ØªØ³Øªâ€ŒÙ‡Ø§: ${total} Ø§Ø² Ûµ Ù…ÙˆÙÙ‚`;
            
            // Update preview card
            const preview = document.getElementById('previewCard');
            if (total === 5) {
                preview.innerHTML = 'ğŸ‰ Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§ Ù…ÙˆÙÙ‚! ÙÙ„Ø´ Ú©Ø§Ø±Øª Ø³Ø§Ù„Ù… Ø§Ø³Øª';
                preview.classList.add('flipped');
            } else {
                preview.innerHTML = `ğŸ“Š ${total} Ø§Ø² Ûµ ØªØ³Øª Ù…ÙˆÙÙ‚`;
                preview.classList.remove('flipped');
            }
        }

        // Reset single test
        function resetTest(testNumber) {
            testResults[testNumber] = false;
            document.getElementById(`output${testNumber}`).innerHTML = 'Ù…Ù†ØªØ¸Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª...';
            updateSummary();
        }

        // Reset all tests
        function resetAll() {
            for (let i = 1; i <= 5; i++) {
                testResults[i] = false;
                document.getElementById(`output${i}`).innerHTML = 'Ù…Ù†ØªØ¸Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª...';
            }
            updateSummary();
        }

        // Test 1: Create Valid Card
        function testCreateValidCard() {
            try {
                // ØªØ³Øª 1.1: Ø³Ø§Ø®Øª Ø¨Ø§ Ù…Ù‚Ø§Ø¯ÛŒØ± Ù…Ø¹ØªØ¨Ø±
                const card1 = new FlashCard('What is "book" in Persian?', 'Ú©ØªØ§Ø¨');
                if (card1.question !== 'What is "book" in Persian?') throw new Error('Ø³ÙˆØ§Ù„ Ø¯Ø±Ø³Øª Ø°Ø®ÛŒØ±Ù‡ Ù†Ø´Ø¯Ù‡');
                if (card1.answer !== 'Ú©ØªØ§Ø¨') throw new Error('Ù¾Ø§Ø³Ø® Ø¯Ø±Ø³Øª Ø°Ø®ÛŒØ±Ù‡ Ù†Ø´Ø¯Ù‡');
                if (card1.isFlipped !== false) throw new Error('isFlipped Ø¨Ø§ÛŒØ¯ false Ø¨Ø§Ø´Ø¯');
                
                // ØªØ³Øª 1.2: Ø³Ø§Ø®Øª Ø¨Ø§ ID Ø¯Ù„Ø®ÙˆØ§Ù‡
                const card2 = new FlashCard('Q2', 'A2', { id: 'test123' });
                if (card2.id !== 'test123') throw new Error('ID Ø¯Ù„Ø®ÙˆØ§Ù‡ Ø§Ø¹Ù…Ø§Ù„ Ù†Ø´Ø¯Ù‡');
                
                // ØªØ³Øª 1.3: Ø®Ø·Ø§ Ø¨Ø§ ÙˆØ±ÙˆØ¯ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø±
                let error1 = false, error2 = false;
                try { new FlashCard('', 'answer'); } catch(e) { error1 = true; }
                try { new FlashCard('question', ''); } catch(e) { error2 = true; }
                
                if (!error1 || !error2) throw new Error('Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒ Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯');
                
                log('output1', 'Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø®Øª ÙÙ„Ø´ Ú©Ø§Ø±Øª Ù…ÙˆÙÙ‚', true);
                testResults[1] = true;
            } catch (error) {
                log('output1', `Ø®Ø·Ø§: ${error.message}`, false);
                testResults[1] = false;
            }
            updateSummary();
        }

        // Test 2: Flip Card
        function testFlipCard() {
            try {
                const card = new FlashCard('Question', 'Answer');
                
                // ØªØ³Øª 2.1: Flip Ø§ÙˆÙ„
                const result1 = card.flip();
                if (result1 !== true || card.isFlipped !== true) {
                    throw new Error('Flip Ø§ÙˆÙ„ Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯');
                }
                
                // ØªØ³Øª 2.2: Flip Ø¯ÙˆÙ… (Ø¨Ø±Ú¯Ø´ØªÙ†)
                const result2 = card.flip();
                if (result2 !== false || card.isFlipped !== false) {
                    throw new Error('Flip Ø¯ÙˆÙ… (Ø¨Ø±Ú¯Ø´Øª) Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯');
                }
                
                // ØªØ³Øª 2.3: Flip Ù…ØªÙˆØ§Ù„ÛŒ
                card.flip();
                card.flip();
                card.flip();
                if (card.isFlipped !== true) {
                    throw new Error('Flip Ù…ØªÙˆØ§Ù„ÛŒ Ø¯Ø±Ø³Øª Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯');
                }
                
                log('output2', 'Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Flip Ù…ÙˆÙÙ‚', true);
                testResults[2] = true;
            } catch (error) {
                log('output2', `Ø®Ø·Ø§: ${error.message}`, false);
                testResults[2] = false;
            }
            updateSummary();
        }

        // Test 3: Reveal Answer
        function testRevealAnswer() {
            try {
                const card = new FlashCard('Question', 'Secret Answer');
                
                // ØªØ³Øª 3.1: Reveal Ø§ÙˆÙ„ÛŒÙ‡
                const answer = card.reveal();
                if (answer !== 'Secret Answer') {
                    throw new Error('Reveal Ù¾Ø§Ø³Ø® Ø¯Ø±Ø³Øª Ø±Ø§ Ø¨Ø±Ù†Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯');
                }
                if (card.isFlipped !== true) {
                    throw new Error('Reveal Ø¨Ø§ÛŒØ¯ isFlipped Ø±Ø§ true Ú©Ù†Ø¯');
                }
                
                // ØªØ³Øª 3.2: Reveal Ù…Ø¬Ø¯Ø¯
                const answer2 = card.reveal();
                if (answer2 !== 'Secret Answer') {
                    throw new Error('Reveal Ù…Ø¬Ø¯Ø¯ Ù¾Ø§Ø³Ø® Ù…ØªÙØ§ÙˆØª Ù…ÛŒâ€ŒØ¯Ù‡Ø¯');
                }
                
                // ØªØ³Øª 3.3: Check after reveal
                card.checkAnswer('wrong');
                const answer3 = card.reveal();
                if (answer3 !== 'Secret Answer') {
                    throw new Error('Reveal Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø§Ø³Ø® Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯');
                }
                
                log('output3', 'Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Reveal Ù…ÙˆÙÙ‚', true);
                testResults[3] = true;
            } catch (error) {
                log('output3', `Ø®Ø·Ø§: ${error.message}`, false);
                testResults[3] = false;
            }
            updateSummary();
        }

        // Test 4: Reset Card
        function testResetCard() {
            try {
                const card = new FlashCard('Question', 'Answer');
                
                // ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ú©Ø§Ø±Øª
                card.flip();
                card.checkAnswer('wrong');
                
                // ØªØ³Øª 4.1: Reset
                card.reset();
                if (card.isFlipped !== false) {
                    throw new Error('Reset isFlipped Ø±Ø§ false Ù†Ú©Ø±Ø¯Ù‡');
                }
                if (card.isAnswered !== false) {
                    throw new Error('Reset isAnswered Ø±Ø§ false Ù†Ú©Ø±Ø¯Ù‡');
                }
                if (card.userAnswer !== null) {
                    throw new Error('Reset userAnswer Ø±Ø§ Ù¾Ø§Ú© Ù†Ú©Ø±Ø¯Ù‡');
                }
                if (card.isCorrect !== null) {
                    throw new Error('Reset isCorrect Ø±Ø§ Ù¾Ø§Ú© Ù†Ú©Ø±Ø¯Ù‡');
                }
                
                // ØªØ³Øª 4.2: Reset Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø§Ø³Ø® Ø¯Ø±Ø³Øª
                const card2 = new FlashCard('Q2', 'A2');
                card2.checkAnswer('A2');
                card2.reset();
                if (card2.isCorrect !== null) {
                    throw new Error('Reset Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø§Ø³Ø® Ø¯Ø±Ø³Øª Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯');
                }
                
                log('output4', 'Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Reset Ù…ÙˆÙÙ‚', true);
                testResults[4] = true;
            } catch (error) {
                log('output4', `Ø®Ø·Ø§: ${error.message}`, false);
                testResults[4] = false;
            }
            updateSummary();
        }

        // Test 5: Edge Cases
        function testEdgeCases() {
            try {
                // ØªØ³Øª 5.1: CheckAnswer Ø¨Ø§ Ù…Ù‚Ø§Ø¯ÛŒØ± Ù…Ø®ØªÙ„Ù
                const card = new FlashCard('Question', 'Hello');
                
                const test1 = card.checkAnswer('Hello');
                if (test1 !== true || card.isCorrect !== true) throw new Error('Ù¾Ø§Ø³Ø® Ø¯Ø±Ø³Øª ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø¯Ù‡ Ù†Ø´Ø¯Ù‡');
                
                card.reset();
                const test2 = card.checkAnswer('hello');
                if (test2 !== true) throw new Error('Case sensitivity Ù…Ø´Ú©Ù„ Ø¯Ø§Ø±Ø¯');
                
                card.reset();
                const test3 = card.checkAnswer('  Hello  ');
                if (test3 !== true) throw new Error('ÙØ¶Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ø´Ø¯Ù‡');
                
                // ØªØ³Øª 5.2: Ù¾Ø§Ø³Ø® Ø®Ø§Ù„ÛŒ
                card.reset();
                const test4 = card.checkAnswer('');
                if (test4 !== false) throw new Error('Ù¾Ø§Ø³Ø® Ø®Ø§Ù„ÛŒ Ø¨Ø§ÛŒØ¯ false Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯');
                
                // ØªØ³Øª 5.3: getState
                const card2 = new FlashCard('Q', 'A', { id: 'state-test' });
                card2.flip();
                const state = card2.getState();
                
                if (state.id !== 'state-test') throw new Error('state.id Ù…Ø´Ú©Ù„ Ø¯Ø§Ø±Ø¯');
                if (state.question !== 'Q') throw new Error('state.question Ù…Ø´Ú©Ù„ Ø¯Ø§Ø±Ø¯');
                if (state.answer !== 'A') throw new Error('state.answer Ù…Ø´Ú©Ù„ Ø¯Ø§Ø±Ø¯');
                if (state.isFlipped !== true) throw new Error('state.isFlipped Ù…Ø´Ú©Ù„ Ø¯Ø§Ø±Ø¯');
                
                log('output5', 'Ù‡Ù…Ù‡ Edge Cases Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªØ³Øª Ø´Ø¯Ù†Ø¯', true);
                testResults[5] = true;
            } catch (error) {
                log('output5', `Ø®Ø·Ø§: ${error.message}`, false);
                testResults[5] = false;
            }
            updateSummary();
        }

        // Run all tests
        function runAllTests() {
            testCreateValidCard();
            testFlipCard();
            testRevealAnswer();
            testResetCard();
            testEdgeCases();
        }
    </script>
</body>
</html>
