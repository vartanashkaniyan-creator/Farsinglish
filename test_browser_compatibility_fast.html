<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>ØªØ³Øª Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±Ù‡Ø§ - Farsinglish (Ù†Ø³Ø®Ù‡ Ø³Ø±ÛŒØ¹)</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Tahoma', 'Vazir', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 25px;
            padding: 20px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 24px;
        }

        .browser-info {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .browser-name {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px 0;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #5a67d8;
            min-width: 120px;
        }

        button:hover {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button.small {
            padding: 8px 15px;
            font-size: 13px;
            min-width: 80px;
        }

        .test-section {
            background: white;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }

        .test-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 12px;
            border: 2px solid #dee2e6;
        }

        .test-card.pass { border-color: #27ae60; background: #f0fff4; }
        .test-card.fail { border-color: #e74c3c; background: #fff5f5; }

        .test-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #2c3e50;
            font-size: 15px;
        }

        .test-status {
            font-size: 13px;
            padding: 4px 8px;
            border-radius: 20px;
            margin: 8px 0;
            text-align: center;
            background: #e9ecef;
        }

        .test-status.pass { background: #27ae60; color: white; }
        .test-status.fail { background: #e74c3c; color: white; }

        .result-box {
            background: #1a2634;
            color: #0f0;
            padding: 12px;
            border-radius: 10px;
            font-family: monospace;
            margin: 15px 0;
            max-height: 150px;
            overflow-y: auto;
            font-size: 12px;
            direction: ltr;
            text-align: left;
        }

        .summary {
            background: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
            text-align: center;
        }

        .feature-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
            margin-left: 5px;
        }

        .feature-badge.yes { background: #27ae60; color: white; }
        .feature-badge.no { background: #e74c3c; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ Farsinglish - ØªØ³Øª Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±Ù‡Ø§ (Ù†Ø³Ø®Ù‡ Ø³Ø±ÛŒØ¹)</h1>

        <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø±ÙˆØ±Ú¯Ø± -->
        <div class="browser-info" id="browserInfo">
            <div class="browser-name" id="browserName">Ø¯Ø± Ø­Ø§Ù„ ØªØ´Ø®ÛŒØµ...</div>
        </div>

        <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ -->
        <div class="button-group">
            <button onclick="runAllTests()">ğŸ§ª ØªØ³Øª Ù‡Ù…Ù‡ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§</button>
            <button onclick="exportResults()">ğŸ“¥ Ø®Ø±ÙˆØ¬ÛŒ JSON</button>
        </div>

        <!-- Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ -->
        <div class="test-section">
            <h3>ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ</h3>
            <div class="test-grid" id="storageTests"></div>
        </div>

        <!-- ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ -->
        <div class="test-section">
            <h3>âš¡ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</h3>
            <div class="test-grid" id="advancedTests"></div>
        </div>

        <!-- Ø®Ø±ÙˆØ¬ÛŒ -->
        <div class="result-box" id="logOutput"></div>

        <!-- Ø®Ù„Ø§ØµÙ‡ -->
        <div class="summary" id="summary">
            <span id="summaryText">â³ Ù…Ù†ØªØ¸Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª...</span>
        </div>
    </div>

    <script>
        // ========== Ú©Ø´ Ù†ØªØ§ÛŒØ¬ ==========
        const resultsCache = {
            storage: {},
            advanced: {}
        };

        // ========== ØªØ´Ø®ÛŒØµ Ù…Ø±ÙˆØ±Ú¯Ø± ==========
        function detectBrowser() {
            const ua = navigator.userAgent;
            let name = 'Unknown';
            
            if (ua.indexOf('Chrome') > -1 && ua.indexOf('Edg') === -1) name = 'Google Chrome';
            else if (ua.indexOf('Firefox') > -1) name = 'Mozilla Firefox';
            else if (ua.indexOf('Safari') > -1 && ua.indexOf('Chrome') === -1) name = 'Apple Safari';
            else if (ua.indexOf('Edg') > -1) name = 'Microsoft Edge';
            
            document.getElementById('browserName').textContent = name;
            return name;
        }

        // ========== ØªÙˆØ§Ø¨Ø¹ ØªØ³Øª ==========
        function testLocalStorage() {
            try { localStorage.setItem('test', 'test'); localStorage.removeItem('test'); return true; } 
            catch(e) { return false; }
        }

        function testSessionStorage() {
            try { sessionStorage.setItem('test', 'test'); sessionStorage.removeItem('test'); return true; } 
            catch(e) { return false; }
        }

        function testIndexedDB() {
            return 'indexedDB' in window;
        }

        function testWebSQL() {
            return 'openDatabase' in window;
        }

        function testCacheAPI() {
            return 'caches' in window;
        }

        function testPromise() {
            return 'Promise' in window;
        }

        function testFetch() {
            return 'fetch' in window;
        }

        function testWebSocket() {
            return 'WebSocket' in window;
        }

        // ========== Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ Ø¨Ø§ Ú©Ø´ ==========
        function runStorageTests() {
            const tests = [
                { id: 'localStorage', name: 'localStorage', fn: testLocalStorage },
                { id: 'sessionStorage', name: 'sessionStorage', fn: testSessionStorage },
                { id: 'indexedDB', name: 'IndexedDB', fn: testIndexedDB },
                { id: 'webSQL', name: 'WebSQL', fn: testWebSQL },
                { id: 'cacheAPI', name: 'Cache API', fn: testCacheAPI }
            ];

            tests.forEach(test => {
                if (resultsCache.storage[test.id] === undefined) {
                    resultsCache.storage[test.id] = test.fn();
                }
            });

            renderStorageTests();
        }

        function runAdvancedTests() {
            const tests = [
                { id: 'promise', name: 'Promise', fn: testPromise },
                { id: 'fetch', name: 'Fetch API', fn: testFetch },
                { id: 'websocket', name: 'WebSocket', fn: testWebSocket }
            ];

            tests.forEach(test => {
                if (resultsCache.advanced[test.id] === undefined) {
                    resultsCache.advanced[test.id] = test.fn();
                }
            });

            renderAdvancedTests();
        }

        // ========== Ø±Ù†Ø¯Ø± Ú©Ø±Ø¯Ù† ==========
        function renderStorageTests() {
            const container = document.getElementById('storageTests');
            container.innerHTML = '';

            const items = [
                { id: 'localStorage', name: 'localStorage', fa: 'Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù…Ø­Ù„ÛŒ' },
                { id: 'sessionStorage', name: 'sessionStorage', fa: 'Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¬Ù„Ø³Ù‡' },
                { id: 'indexedDB', name: 'IndexedDB', fa: 'Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡' },
                { id: 'webSQL', name: 'WebSQL', fa: 'WebSQL' },
                { id: 'cacheAPI', name: 'Cache API', fa: 'Ú©Ø´' }
            ];

            items.forEach(item => {
                const result = resultsCache.storage[item.id];
                if (result === undefined) return;

                const card = document.createElement('div');
                card.className = `test-card ${result ? 'pass' : 'fail'}`;
                
                card.innerHTML = `
                    <div class="test-title">
                        ${item.fa}
                        <span class="feature-badge ${result ? 'yes' : 'no'}">${result ? 'âœ…' : 'âŒ'}</span>
                    </div>
                    <div class="test-status ${result ? 'pass' : 'fail'}">
                        ${result ? 'Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ú©Ø§Ù…Ù„' : 'Ø¹Ø¯Ù… Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ'}
                    </div>
                    <button class="small" onclick="retestStorage('${item.id}')">ğŸ”„ ØªØ³Øª Ù…Ø¬Ø¯Ø¯</button>
                `;
                
                container.appendChild(card);
            });

            log('âœ… ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯');
            updateSummary();
        }

        function renderAdvancedTests() {
            const container = document.getElementById('advancedTests');
            container.innerHTML = '';

            const items = [
                { id: 'promise', name: 'Promise', fa: 'Promise' },
                { id: 'fetch', name: 'Fetch API', fa: 'Fetch API' },
                { id: 'websocket', name: 'WebSocket', fa: 'WebSocket' }
            ];

            items.forEach(item => {
                const result = resultsCache.advanced[item.id];
                if (result === undefined) return;

                const card = document.createElement('div');
                card.className = `test-card ${result ? 'pass' : 'fail'}`;
                
                card.innerHTML = `
                    <div class="test-title">
                        ${item.fa}
                        <span class="feature-badge ${result ? 'yes' : 'no'}">${result ? 'âœ…' : 'âŒ'}</span>
                    </div>
                    <div class="test-status ${result ? 'pass' : 'fail'}">
                        ${result ? 'Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ú©Ø§Ù…Ù„' : 'Ø¹Ø¯Ù… Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ'}
                    </div>
                    <button class="small" onclick="retestAdvanced('${item.id}')">ğŸ”„ ØªØ³Øª Ù…Ø¬Ø¯Ø¯</button>
                `;
                
                container.appendChild(card);
            });

            log('âœ… ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯');
            updateSummary();
        }

        // ========== ØªØ³Øª Ù…Ø¬Ø¯Ø¯ ØªÚ©ÛŒ ==========
        function retestStorage(id) {
            const testMap = {
                localStorage: testLocalStorage,
                sessionStorage: testSessionStorage,
                indexedDB: testIndexedDB,
                webSQL: testWebSQL,
                cacheAPI: testCacheAPI
            };
            
            resultsCache.storage[id] = testMap[id]();
            renderStorageTests();
            log(`ğŸ”„ ØªØ³Øª Ù…Ø¬Ø¯Ø¯ ${id}: ${resultsCache.storage[id] ? 'Ù…ÙˆÙÙ‚' : 'Ù†Ø§Ù…ÙˆÙÙ‚'}`);
        }

        function retestAdvanced(id) {
            const testMap = {
                promise: testPromise,
                fetch: testFetch,
                websocket: testWebSocket
            };
            
            resultsCache.advanced[id] = testMap[id]();
            renderAdvancedTests();
            log(`ğŸ”„ ØªØ³Øª Ù…Ø¬Ø¯Ø¯ ${id}: ${resultsCache.advanced[id] ? 'Ù…ÙˆÙÙ‚' : 'Ù†Ø§Ù…ÙˆÙÙ‚'}`);
        }

        // ========== Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§ ==========
        function runAllTests() {
            log('ğŸ§ª Ø´Ø±ÙˆØ¹ ØªØ³Øª Ù‡Ù…Ù‡ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§...');
            runStorageTests();
            runAdvancedTests();
            log('âœ… ØªØ³Øª Ù‡Ù…Ù‡ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ Ú©Ø§Ù…Ù„ Ø´Ø¯');
        }

        // ========== Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø®Ù„Ø§ØµÙ‡ ==========
        function updateSummary() {
            const storageResults = Object.values(resultsCache.storage);
            const advancedResults = Object.values(resultsCache.advanced);
            const allResults = [...storageResults, ...advancedResults].filter(r => r !== undefined);
            
            const success = allResults.filter(r => r === true).length;
            const total = allResults.length;
            
            document.getElementById('summaryText').innerHTML = 
                `ğŸ“Š ØªØ³Øªâ€ŒÙ‡Ø§: âœ… ${success} Ù…ÙˆÙÙ‚ | âŒ ${total - success} Ù†Ø§Ù…ÙˆÙÙ‚ | ğŸ“‹ Ú©Ù„: ${total}`;
        }

        // ========== Ø®Ø±ÙˆØ¬ÛŒ JSON ==========
        function exportResults() {
            const data = {
                browser: detectBrowser(),
                timestamp: new Date().toISOString(),
                results: {
                    storage: resultsCache.storage,
                    advanced: resultsCache.advanced
                }
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `browser-test-${Date.now()}.json`;
            a.click();
            log('ğŸ“¥ Ù†ØªØ§ÛŒØ¬ Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ‡ Ø´Ø¯');
        }

        // ========== Ù„Ø§Ú¯ ==========
        function log(message) {
            const logBox = document.getElementById('logOutput');
            const time = new Date().toLocaleTimeString('fa-IR');
            logBox.innerHTML += `<div>â±ï¸ ${time} | ${message}</div>`;
            logBox.scrollTop = logBox.scrollHeight;
        }

        // ========== Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ==========
        window.onload = function() {
            detectBrowser();
            runAllTests();
        };
    </script>
</body>
</html>
