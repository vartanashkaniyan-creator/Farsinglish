<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>ØªØ³Øª RTL Ùˆ Locale - Farsinglish</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Tahoma', 'Vazir', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #43cea2 0%, #185a9d 100%);
            min-height: 100vh;
            padding: 15px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 25px;
            padding: 20px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        h2 {
            color: #34495e;
            margin: 20px 0 15px;
            font-size: 20px;
            border-right: 4px solid #43cea2;
            padding-right: 15px;
        }

        .info-bar {
            background: #f8f9fa;
            border-radius: 50px;
            padding: 15px 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            border: 2px solid #e0e0e0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .locale-badge {
            background: #2c3e50;
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .test-card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            border: 2px solid #e9ecef;
            transition: all 0.2s ease;
        }

        .test-card.rtl-pass {
            border-color: #27ae60;
            background: linear-gradient(145deg, #f0fff4, white);
        }

        .test-card.rtl-fail {
            border-color: #e74c3c;
            background: linear-gradient(145deg, #fff5f5, white);
        }

        .test-title {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        .test-status {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
            font-size: 14px;
        }

        .test-status.pass {
            background: #27ae60;
            color: white;
        }

        .test-status.fail {
            background: #e74c3c;
            color: white;
        }

        button {
            background: #43cea2;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: all 0.2s ease;
            margin: 5px 0;
            border: 1px solid #2c9b7a;
        }

        button:hover {
            background: #3ab390;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(67, 206, 162, 0.3);
        }

        button.small {
            padding: 8px 12px;
            font-size: 13px;
            width: auto;
            margin: 5px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 15px 0;
        }

        .rtl-sample {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 16px;
            line-height: 1.8;
            text-align: right;
            border: 2px dashed #999;
        }

        .sample-text {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-right: 4px solid #43cea2;
        }

        .sample-text.ltr {
            direction: ltr;
            text-align: left;
            border-right: none;
            border-left: 4px solid #e74c3c;
        }

        .result-box {
            background: #1a2634;
            color: #0f0;
            padding: 15px;
            border-radius: 15px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            max-height: 200px;
            overflow-y: auto;
            direction: ltr;
            text-align: left;
            font-size: 13px;
            line-height: 1.6;
        }

        .summary {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 25px;
            border-radius: 20px;
            margin-top: 25px;
            text-align: center;
        }

        .summary-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
            min-width: 100px;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #f1c40f;
        }

        @media (max-width: 600px) {
            .container { padding: 15px; }
            .info-bar { flex-direction: column; }
            .button-group { flex-direction: column; }
        }

        /* ØªØ³Øª RTL Ù¾ÛŒØ´Ø±ÙØªÙ‡ */
        .test-string {
            font-size: 20px;
            padding: 10px;
            background: #fff3e0;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
        }

        .persian-text {
            color: #27ae60;
            font-weight: bold;
        }

        .mixed-text {
            color: #e67e22;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ‡®ğŸ‡· Farsinglish - ØªØ³Øª RTL Ùˆ Locale</h1>
        <p style="text-align: center; color: #666; margin-bottom: 20px;">Right-to-Left & Localization Test</p>

        <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ¹Ù„ÛŒ -->
        <div class="info-bar">
            <div class="locale-badge">
                <span>ğŸŒ Ø²Ø¨Ø§Ù† Ù…Ø±ÙˆØ±Ú¯Ø±:</span>
                <span id="browserLang">---</span>
            </div>
            <div class="locale-badge">
                <span>ğŸ“… ØªØ§Ø±ÛŒØ®:</span>
                <span id="currentDate">---</span>
            </div>
            <div class="locale-badge">
                <span>ğŸ’° Ù‚ÛŒÙ…Øª:</span>
                <span id="currentCurrency">---</span>
            </div>
        </div>

        <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ -->
        <div class="button-group">
            <button onclick="detectLocale()" class="small">ğŸ”„ ØªØ´Ø®ÛŒØµ Ù…Ø¬Ø¯Ø¯ Locale</button>
            <button onclick="testAllRTL()" class="small">ğŸ§ª ØªØ³Øª Ù‡Ù…Ù‡ Ù…ÙˆØ§Ø±Ø¯ RTL</button>
            <button onclick="exportRTLResults()" class="small">ğŸ“¥ Ø®Ø±ÙˆØ¬ÛŒ Ù†ØªØ§ÛŒØ¬</button>
        </div>

        <!-- ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ RTL -->
        <div class="test-grid">
            <!-- Ú©Ø§Ø±Øª Û±: Ø¬Ù‡Øª Ù…ØªÙ† -->
            <div class="test-card" id="cardDirection">
                <div class="test-title">â¡ï¸ Ø¬Ù‡Øª Ù…ØªÙ† (Text Direction)</div>
                <div class="rtl-sample">
                    <p>ğŸ“Œ Ù…ØªÙ† ÙØ§Ø±Ø³ÛŒ: <span class="persian-text">Ø³Ù„Ø§Ù… Ø¯Ù†ÛŒØ§!</span></p>
                    <p>ğŸ“Œ Ù…ØªÙ† Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ: <span class="mixed-text">Hello World!</span></p>
                    <p>ğŸ“Œ ØªØ±Ú©ÛŒØ¨ÛŒ: <span class="mixed-text">Ø³Ù„Ø§Ù… World Û±Û²Û³</span></p>
                </div>
                <div class="test-status" id="directionStatus">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ³Øª...</div>
                <button onclick="testTextDirection()">ğŸ” ØªØ³Øª Ø¬Ù‡Øª Ù…ØªÙ†</button>
            </div>

            <!-- Ú©Ø§Ø±Øª Û²: Ø§Ø¹Ø¯Ø§Ø¯ ÙØ§Ø±Ø³ÛŒ -->
            <div class="test-card" id="cardNumbers">
                <div class="test-title">ğŸ”¢ Ø§Ø¹Ø¯Ø§Ø¯ ÙØ§Ø±Ø³ÛŒ (Persian Numbers)</div>
                <div class="test-string" id="numberDisplay">Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹Û°</div>
                <div class="test-string" id="englishNumber">1234567890 (Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ)</div>
                <div class="test-status" id="numbersStatus">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ³Øª...</div>
                <button onclick="testPersianNumbers()">ğŸ”¢ ØªØ³Øª Ø§Ø¹Ø¯Ø§Ø¯ ÙØ§Ø±Ø³ÛŒ</button>
            </div>

            <!-- Ú©Ø§Ø±Øª Û³: ØªØ§Ø±ÛŒØ® Ùˆ Ø²Ù…Ø§Ù† -->
            <div class="test-card" id="cardDate">
                <div class="test-title">ğŸ“… ØªØ§Ø±ÛŒØ® Ùˆ Ø²Ù…Ø§Ù† (Date/Time)</div>
                <div id="dateDisplay" style="font-size: 18px; margin: 15px 0; padding: 10px; background: #e8f4f8; border-radius: 8px;"></div>
                <div class="test-status" id="dateStatus">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ³Øª...</div>
                <button onclick="testPersianDate()">ğŸ“… ØªØ³Øª ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ</button>
            </div>

            <!-- Ú©Ø§Ø±Øª Û´: Ø§Ø±Ø² Ùˆ ÙˆØ§Ø­Ø¯ Ù¾ÙˆÙ„ -->
            <div class="test-card" id="cardCurrency">
                <div class="test-title">ğŸ’° Ø§Ø±Ø² Ùˆ ÙˆØ§Ø­Ø¯ Ù¾ÙˆÙ„ (Currency)</div>
                <div id="currencyDisplay" style="font-size: 18px; margin: 15px 0; padding: 10px; background: #e8f4f8; border-radius: 8px;"></div>
                <div class="test-status" id="currencyStatus">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ³Øª...</div>
                <button onclick="testCurrency()">ğŸ’° ØªØ³Øª ÙØ±Ù…Øª Ø±ÛŒØ§Ù„</button>
            </div>

            <!-- Ú©Ø§Ø±Øª Ûµ: Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ -->
            <div class="test-card" id="cardSort">
                <div class="test-title">ğŸ”¤ Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ ÙØ§Ø±Ø³ÛŒ (Persian Sort)</div>
                <div id="sortDisplay" style="font-size: 16px; margin: 15px 0; padding: 10px; background: #e8f4f8; border-radius: 8px;"></div>
                <div class="test-status" id="sortStatus">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ³Øª...</div>
                <button onclick="testPersianSort()">ğŸ”¤ ØªØ³Øª Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ</button>
            </div>

            <!-- Ú©Ø§Ø±Øª Û¶: Regex ÙØ§Ø±Ø³ÛŒ -->
            <div class="test-card" id="cardRegex">
                <div class="test-title">ğŸ” ØªØ´Ø®ÛŒØµ Ù…ØªÙ† ÙØ§Ø±Ø³ÛŒ</div>
                <div id="regexDisplay" style="font-size: 16px; margin: 15px 0; padding: 10px; background: #e8f4f8; border-radius: 8px;"></div>
                <div class="test-status" id="regexStatus">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ³Øª...</div>
                <button onclick="testPersianRegex()">ğŸ” ØªØ³Øª Regex</button>
            </div>
        </div>

        <!-- Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ RTL/LTR -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0;">
            <div class="sample-text">
                <strong>ğŸ“ Ø±Ø§Ø³Øªâ€ŒÚ†ÛŒÙ† (RTL):</strong><br>
                Ø§ÛŒÙ† ÛŒÚ© Ù…ØªÙ† ÙØ§Ø±Ø³ÛŒ Ø§Ø³Øª Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ø§Ø² Ø±Ø§Ø³Øª Ø¨Ù‡ Ú†Ù¾ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯. Ø§Ø¹Ø¯Ø§Ø¯ Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹Û° Ùˆ Ø¹Ù„Ø§Ø¦Ù… Ù†Ú¯Ø§Ø±Ø´ÛŒØŒ
            </div>
            <div class="sample-text ltr">
                <strong>ğŸ“ Ú†Ù¾â€ŒÚ†ÛŒÙ† (LTR):</strong><br>
                This is English text that should be displayed left-to-right. Numbers 1234567890 and punctuation.
            </div>
        </div>

        <!-- Ø®Ø±ÙˆØ¬ÛŒ Ù„Ø§Ú¯ -->
        <div class="result-box" id="logOutput">
            â³ Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ ØªØ³ØªØŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯...
        </div>

        <!-- Ø®Ù„Ø§ØµÙ‡ Ù†Ù‡Ø§ÛŒÛŒ -->
        <div class="summary" id="summary">
            <h3>ğŸ“Š Ø®Ù„Ø§ØµÙ‡ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ RTL</h3>
            <div class="summary-stats">
                <div class="stat-item">
                    <div>âœ… Ù…ÙˆÙÙ‚</div>
                    <div class="stat-number" id="successCount">0</div>
                </div>
                <div class="stat-item">
                    <div>âŒ Ù†Ø§Ù…ÙˆÙÙ‚</div>
                    <div class="stat-number" id="failCount">0</div>
                </div>
                <div class="stat-item">
                    <div>ğŸ“‹ Ú©Ù„</div>
                    <div class="stat-number" id="totalCount">6</div>
                </div>
            </div>
            <p id="rtlMessage" style="margin-top: 15px; font-size: 16px;"></p>
        </div>
    </div>

    <script>
        // ---------- Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ ----------
        const testResults = {
            direction: null,
            numbers: null,
            date: null,
            currency: null,
            sort: null,
            regex: null
        };

        // ---------- ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ ----------
        function log(message) {
            const logBox = document.getElementById('logOutput');
            const time = new Date().toLocaleTimeString('fa-IR');
            logBox.innerHTML += `<div>â±ï¸ ${time} | ${message}</div>`;
            logBox.scrollTop = logBox.scrollHeight;
        }

        function updateSummary() {
            let success = 0, fail = 0;
            for (let key in testResults) {
                if (testResults[key] === true) success++;
                else if (testResults[key] === false) fail++;
            }
            
            document.getElementById('successCount').textContent = success;
            document.getElementById('failCount').textContent = fail;
            
            const total = success + fail;
            const message = total === 6 ? 
                (fail === 0 ? 'âœ… ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ RTL Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ú¯Ø°Ø±Ø§Ù†Ø¯Ù‡ Ø´Ø¯Ù†Ø¯' : 
                `âš ï¸ ${fail} ØªØ³Øª RTL Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯`) : 
                'â³ Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§ Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯';
            
            document.getElementById('rtlMessage').textContent = message;
        }

        // ---------- ØªØ´Ø®ÛŒØµ Locale ----------
        function detectLocale() {
            const lang = navigator.language || navigator.userLanguage || 'fa-IR';
            document.getElementById('browserLang').textContent = lang;
            
            try {
                const date = new Date();
                document.getElementById('currentDate').textContent = date.toLocaleDateString('fa-IR');
                document.getElementById('currentCurrency').textContent = 
                    (1250000).toLocaleString('fa-IR', { style: 'currency', currency: 'IRR' });
            } catch(e) {
                document.getElementById('currentDate').textContent = 'Ø®Ø·Ø§ Ø¯Ø± Ù†Ù…Ø§ÛŒØ´';
                document.getElementById('currentCurrency').textContent = 'Ø®Ø·Ø§';
            }
            
            log(`ğŸŒ Ø²Ø¨Ø§Ù† Ù…Ø±ÙˆØ±Ú¯Ø±: ${lang}`);
            return lang;
        }

        // ---------- ØªØ³Øª Û±: Ø¬Ù‡Øª Ù…ØªÙ† ----------
        function testTextDirection() {
            const card = document.getElementById('cardDirection');
            const status = document.getElementById('directionStatus');
            
            try {
                const dir = document.documentElement.dir;
                const computedStyle = window.getComputedStyle(document.body);
                const textAlign = computedStyle.textAlign;
                
                const rtlElements = document.querySelectorAll('.persian-text, .mixed-text');
                let allRTL = true;
                
                rtlElements.forEach(el => {
                    const style = window.getComputedStyle(el);
                    if (style.direction !== 'rtl') allRTL = false;
                });
                
                const passed = (dir === 'rtl' && textAlign === 'right') || allRTL;
                
                testResults.direction = passed;
                status.textContent = passed ? 'âœ… Ø¬Ù‡Øª Ù…ØªÙ† ØµØ­ÛŒØ­ Ø§Ø³Øª' : 'âŒ Ù…Ø´Ú©Ù„ Ø¯Ø± Ø¬Ù‡Øª Ù…ØªÙ†';
                status.className = `test-status ${passed ? 'pass' : 'fail'}`;
                card.className = `test-card ${passed ? 'rtl-pass' : 'rtl-fail'}`;
                
                log(`â¡ï¸ ØªØ³Øª Ø¬Ù‡Øª Ù…ØªÙ†: ${passed ? 'Ù…ÙˆÙÙ‚' : 'Ù†Ø§Ù…ÙˆÙÙ‚'}`);
                updateSummary();
            } catch(e) {
                status.textContent = 'âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª';
                log(`âŒ Ø®Ø·Ø§: ${e.message}`);
            }
        }

        // ---------- ØªØ³Øª Û²: Ø§Ø¹Ø¯Ø§Ø¯ ÙØ§Ø±Ø³ÛŒ ----------
        function testPersianNumbers() {
            const card = document.getElementById('cardNumbers');
            const status = document.getElementById('numbersStatus');
            
            try {
                const persianNumbers = 'Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹Û°';
                const display = document.getElementById('numberDisplay').textContent;
                
                let passed = true;
                for (let i = 0; i < persianNumbers.length; i++) {
                    if (display[i] !== persianNumbers[i]) {
                        passed = false;
                        break;
                    }
                }
                
                testResults.numbers = passed;
                status.textContent = passed ? 'âœ… Ø§Ø¹Ø¯Ø§Ø¯ ÙØ§Ø±Ø³ÛŒ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯' : 'âŒ Ù…Ø´Ú©Ù„ Ø¯Ø± Ù†Ù…Ø§ÛŒØ´ Ø§Ø¹Ø¯Ø§Ø¯ ÙØ§Ø±Ø³ÛŒ';
                status.className = `test-status ${passed ? 'pass' : 'fail'}`;
                card.className = `test-card ${passed ? 'rtl-pass' : 'rtl-fail'}`;
                
                log(`ğŸ”¢ ØªØ³Øª Ø§Ø¹Ø¯Ø§Ø¯ ÙØ§Ø±Ø³ÛŒ: ${passed ? 'Ù…ÙˆÙÙ‚' : 'Ù†Ø§Ù…ÙˆÙÙ‚'}`);
                updateSummary();
            } catch(e) {
                status.textContent = 'âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª';
                log(`âŒ Ø®Ø·Ø§: ${e.message}`);
            }
        }

        // ---------- ØªØ³Øª Û³: ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ ----------
        function testPersianDate() {
            const card = document.getElementById('cardDate');
            const status = document.getElementById('dateStatus');
            const display = document.getElementById('dateDisplay');
            
            try {
                const date = new Date();
                const options = { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    weekday: 'long',
                    calendar: 'persian'
                };
                
                let persianDate;
                try {
                    persianDate = date.toLocaleDateString('fa-IR', options);
                } catch(e) {
                    persianDate = date.toLocaleDateString('fa-IR');
                }
                
                display.textContent = persianDate;
                
                const hasPersianChars = /[Û°-Û¹]/.test(persianDate);
                const passed = hasPersianChars && persianDate.length > 0;
                
                testResults.date = passed;
                status.textContent = passed ? 'âœ… ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯' : 'âŒ Ù…Ø´Ú©Ù„ Ø¯Ø± Ù†Ù…Ø§ÛŒØ´ ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ';
                status.className = `test-status ${passed ? 'pass' : 'fail'}`;
                card.className = `test-card ${passed ? 'rtl-pass' : 'rtl-fail'}`;
                
                log(`ğŸ“… ØªØ³Øª ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ: ${passed ? 'Ù…ÙˆÙÙ‚' : 'Ù†Ø§Ù…ÙˆÙÙ‚'}`);
                updateSummary();
            } catch(e) {
                status.textContent = 'âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª';
                log(`âŒ Ø®Ø·Ø§: ${e.message}`);
            }
        }

        // ---------- ØªØ³Øª Û´: Ø§Ø±Ø² ----------
        function testCurrency() {
            const card = document.getElementById('cardCurrency');
            const status = document.getElementById('currencyStatus');
            const display = document.getElementById('currencyDisplay');
            
            try {
                const amount = 1250000;
                let currency;
                
                try {
                    currency = amount.toLocaleString('fa-IR', { 
                        style: 'currency', 
                        currency: 'IRR',
                        minimumFractionDigits: 0
                    });
                } catch(e) {
                    currency = amount.toLocaleString('fa-IR') + ' Ø±ÛŒØ§Ù„';
                }
                
                display.textContent = currency;
                
                const hasRial = currency.includes('Ø±ÛŒØ§Ù„') || /[Û°-Û¹]/.test(currency);
                const passed = hasRial && currency.length > 0;
                
                testResults.currency = passed;
                status.textContent = passed ? 'âœ… ÙØ±Ù…Øª Ø±ÛŒØ§Ù„ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯' : 'âŒ Ù…Ø´Ú©Ù„ Ø¯Ø± Ù†Ù…Ø§ÛŒØ´ Ø±ÛŒØ§Ù„';
                status.className = `test-status ${passed ? 'pass' : 'fail'}`;
                card.className = `test-card ${passed ? 'rtl-pass' : 'rtl-fail'}`;
                
                log(`ğŸ’° ØªØ³Øª Ø§Ø±Ø²: ${passed ? 'Ù…ÙˆÙÙ‚' : 'Ù†Ø§Ù…ÙˆÙÙ‚'}`);
                updateSummary();
            } catch(e) {
                status.textContent = 'âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª';
                log(`âŒ Ø®Ø·Ø§: ${e.message}`);
            }
        }

        // ---------- ØªØ³Øª Ûµ: Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ ÙØ§Ø±Ø³ÛŒ ----------
        function testPersianSort() {
            const card = document.getElementById('cardSort');
            const status = document.getElementById('sortStatus');
            const display = document.getElementById('sortDisplay');
            
            try {
                const words = ['Ø¨', 'Ù¾', 'Øª', 'Ø«', 'Ø¬', 'Ú†', 'Ø­', 'Ø®', 'Ø¯', 'Ø°', 'Ø±', 'Ø²', 'Ú˜', 'Ø³', 'Ø´', 'Øµ', 'Ø¶', 'Ø·', 'Ø¸', 'Ø¹', 'Øº', 'Ù', 'Ù‚', 'Ú©', 'Ú¯', 'Ù„', 'Ù…', 'Ù†', 'Ùˆ', 'Ù‡', 'ÛŒ'];
                const shuffled = [...words].sort(() => Math.random() - 0.5);
                const sorted = [...shuffled].sort((a, b) => a.localeCompare(b, 'fa'));
                
                display.innerHTML = `
                    <div>ğŸ”€ Ù…Ø±ØªØ¨â€ŒØ´Ø¯Ù‡: ${shuffled.slice(0, 5).join('ØŒ ')} ...</div>
                    <div>âœ… Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ: ${sorted.slice(0, 5).join('ØŒ ')} ...</div>
                `;
                
                let correct = true;
                for (let i = 0; i < words.length; i++) {
                    if (sorted[i] !== words[i]) {
                        correct = false;
                        break;
                    }
                }
                
                testResults.sort = correct;
                status.textContent = correct ? 'âœ… Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ ÙØ§Ø±Ø³ÛŒ ØµØ­ÛŒØ­ Ø§Ø³Øª' : 'âŒ Ù…Ø´Ú©Ù„ Ø¯Ø± Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ ÙØ§Ø±Ø³ÛŒ';
                status.className = `test-status ${correct ? 'pass' : 'fail'}`;
                card.className = `test-card ${correct ? 'rtl-pass' : 'rtl-fail'}`;
                
                log(`ğŸ”¤ ØªØ³Øª Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ ÙØ§Ø±Ø³ÛŒ: ${correct ? 'Ù…ÙˆÙÙ‚' : 'Ù†Ø§Ù…ÙˆÙÙ‚'}`);
                updateSummary();
            } catch(e) {
                status.textContent = 'âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª';
                log(`âŒ Ø®Ø·Ø§: ${e.message}`);
            }
        }

        // ---------- ØªØ³Øª Û¶: Regex ÙØ§Ø±Ø³ÛŒ ----------
        function testPersianRegex() {
            const card = document.getElementById('cardRegex');
            const status = document.getElementById('regexStatus');
            const display = document.getElementById('regexDisplay');
            
            try {
                const persianRegex = /^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF\sÛ°-Û¹]+$/;
                
                const testCases = [
                    { text: 'Ø³Ù„Ø§Ù… Ø¯Ù†ÛŒØ§', expected: true },
                    { text: 'Hello', expected: false },
                    { text: 'Û±Û²Û³Û´Ûµ', expected: true },
                    { text: 'Ø³Ù„Ø§Ù… 123', expected: false },
                    { text: 'ØªØ³Øª ÙØ§Ø±Ø³ÛŒ', expected: true }
                ];
                
                let passed = true;
                let results = [];
                
                testCases.forEach(tc => {
                    const result = persianRegex.test(tc.text);
                    if (result !== tc.expected) passed = false;
                    results.push(`${tc.text}: ${result === tc.expected ? 'âœ…' : 'âŒ'}`);
                });
                
                display.innerHTML = results.join('<br>');
                
                testResults.regex = passed;
                status.textContent = passed ? 'âœ… ØªØ´Ø®ÛŒØµ Ù…ØªÙ† ÙØ§Ø±Ø³ÛŒ ØµØ­ÛŒØ­ Ø§Ø³Øª' : 'âŒ Ù…Ø´Ú©Ù„ Ø¯Ø± ØªØ´Ø®ÛŒØµ Ù…ØªÙ† ÙØ§Ø±Ø³ÛŒ';
                status.className = `test-status ${passed ? 'pass' : 'fail'}`;
                card.className = `test-card ${passed ? 'rtl-pass' : 'rtl-fail'}`;
                
                log(`ğŸ” ØªØ³Øª Regex ÙØ§Ø±Ø³ÛŒ: ${passed ? 'Ù…ÙˆÙÙ‚' : 'Ù†Ø§Ù…ÙˆÙÙ‚'}`);
                updateSummary();
            } catch(e) {
                status.textContent = 'âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª';
                log(`âŒ Ø®Ø·Ø§: ${e.message}`);
            }
        }

        // ---------- ØªØ³Øª Ù‡Ù…Ù‡ Ù…ÙˆØ§Ø±Ø¯ ----------
        function testAllRTL() {
            log('ğŸ§ª Ø´Ø±ÙˆØ¹ ØªØ³Øª Ù‡Ù…Ù‡ Ù…ÙˆØ§Ø±Ø¯ RTL...');
            testTextDirection();
            testPersianNumbers();
            testPersianDate();
            testCurrency();
            testPersianSort();
            testPersianRegex();
            log('âœ… ØªØ³Øª Ù‡Ù…Ù‡ Ù…ÙˆØ§Ø±Ø¯ RTL Ú©Ø§Ù…Ù„ Ø´Ø¯');
        }

        // ---------- Ø®Ø±ÙˆØ¬ÛŒ Ù†ØªØ§ÛŒØ¬ ----------
        function exportRTLResults() {
            const results = {
                timestamp: new Date().toISOString(),
                browser: navigator.userAgent,
                language: navigator.language,
                tests: testResults,
                summary: {
                    success: document.getElementById('successCount').textContent,
                    fail: document.getElementById('failCount').textContent
                }
            };
            
            const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `rtl-test-${Date.now()}.json`;
            a.click();
            
            log('ğŸ“¥ Ù†ØªØ§ÛŒØ¬ RTL Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ‡ Ø´Ø¯');
        }

        // ---------- Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ----------
        window.onload = function() {
            detectLocale();
            // ØªØ³Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø¬Ù‡Øª Ù…ØªÙ† Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
            setTimeout(() => {
                testTextDirection();
            }, 500);
        };
    </script>
</body>
  </html>
