<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª Ø¯Ø³ØªÛŒ: Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù¾Ø³ Ø§Ø² Reload</title>
    <style>
        body {
            font-family: Tahoma, Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 0;
        }
        h2 {
            color: #2c3e50;
            margin-top: 25px;
            font-size: 1.3rem;
        }
        .section {
            background-color: #f8f9fa;
            border-right: 4px solid #3498db;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
            flex: 1 1 auto;
            min-width: 150px;
        }
        button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        button.warning {
            background-color: #e67e22;
        }
        button.warning:hover {
            background-color: #d35400;
        }
        button.danger {
            background-color: #e74c3c;
        }
        button.danger:hover {
            background-color: #c0392b;
        }
        button.success {
            background-color: #27ae60;
        }
        button.success:hover {
            background-color: #229954;
        }
        .log-container {
            background-color: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            height: 250px;
            overflow-y: auto;
            margin: 20px 0;
            font-size: 13px;
            direction: ltr;
            text-align: left;
        }
        .log-entry {
            margin: 3px 0;
            border-bottom: 1px solid #333;
            padding: 3px 0;
        }
        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
            margin: 5px 0;
        }
        .status-active {
            background-color: #27ae60;
            color: white;
        }
        .status-inactive {
            background-color: #95a5a6;
            color: white;
        }
        .card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            background-color: white;
        }
        .info-row {
            display: flex;
            margin: 8px 0;
            padding: 8px;
            background-color: #f1f9ff;
            border-radius: 4px;
        }
        .info-label {
            font-weight: bold;
            width: 120px;
            color: #2c3e50;
        }
        .info-value {
            color: #3498db;
            font-family: monospace;
        }
        .persistence-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        .indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        .dot-green {
            background-color: #27ae60;
            box-shadow: 0 0 8px #27ae60;
        }
        .dot-red {
            background-color: #e74c3c;
            box-shadow: 0 0 8px #e74c3c;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”„ ØªØ³Øª Ø¯Ø³ØªÛŒ: Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù¾Ø³ Ø§Ø² Reload</h1>
        <p>Ø§ÛŒÙ† ØµÙØ­Ù‡ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø±ÙØªØ§Ø± ÙˆØ§Ù‚Ø¹ÛŒ Ú©Ø§Ø±Ø¨Ø± Ù¾Ø³ Ø§Ø² Ø¨Ø³ØªÙ† Ùˆ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù…Ø¬Ø¯Ø¯ Ù…Ø±ÙˆØ±Ú¯Ø± Ø§Ø³Øª.</p>

        <div class="section">
            <div class="status-badge status-active" id="connectionStatus">ğŸŸ¢ Ø¢Ù†Ù„Ø§ÛŒÙ†</div>
            <div class="persistence-indicator">
                <span class="indicator-dot" id="persistenceDot" style="background-color: #e74c3c;"></span>
                <span id="persistenceText">ÙˆØ¶Ø¹ÛŒØª: Ø°Ø®ÛŒØ±Ù‡ Ù†Ø´Ø¯Ù‡</span>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ‘¤ ÙˆØ¶Ø¹ÛŒØª Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª</h2>
            <div class="info-row">
                <span class="info-label">ÙˆØ¶Ø¹ÛŒØª:</span>
                <span class="info-value" id="authStatus">Ø®Ø§Ø±Ø¬ Ø´Ø¯Ù‡</span>
            </div>
            <div class="info-row">
                <span class="info-label">Ú©Ø§Ø±Ø¨Ø±:</span>
                <span class="info-value" id="currentUser">-</span>
            </div>
            <div class="button-group">
                <button onclick="simulateLogin()">ğŸ” ÙˆØ±ÙˆØ¯ (Ø¹Ù„ÛŒ)</button>
                <button class="danger" onclick="simulateLogout()">ğŸšª Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ“š Ù¾ÛŒØ´Ø±ÙØª Ø¯Ø±Ø³</h2>
            <div class="info-row">
                <span class="info-label">Ø¯Ø±Ø³ ÙØ¹Ù„ÛŒ:</span>
                <span class="info-value" id="currentLesson">-</span>
            </div>
            <div class="info-row">
                <span class="info-label">Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø³Øª:</span>
                <span class="info-value" id="correctAnswers">Û°</span>
            </div>
            <div class="info-row">
                <span class="info-label">Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§ÛŒ ØºÙ„Ø·:</span>
                <span class="info-value" id="wrongAnswers">Û°</span>
            </div>
            <div class="button-group">
                <button onclick="loadLesson(1)">ğŸ“– Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø±Ø³ Û±</button>
                <button onclick="loadLesson(2)">ğŸ“– Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø±Ø³ Û²</button>
                <button class="success" onclick="addCorrectAnswer()">âœ… Ù¾Ø§Ø³Ø® Ø¯Ø±Ø³Øª</button>
                <button class="warning" onclick="addWrongAnswer()">âŒ Ù¾Ø§Ø³Ø® ØºÙ„Ø·</button>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ</h2>
            <div class="button-group">
                <button class="success" onclick="saveState()">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø³ØªÛŒ</button>
                <button class="warning" onclick="loadState()">ğŸ“‚ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø³ØªÛŒ</button>
                <button onclick="clearStorage()">ğŸ—‘ï¸ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø­Ø§ÙØ¸Ù‡</button>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ”„ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Reload</h2>
            <div class="button-group">
                <button onclick="simulateReload()">ğŸ”„ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Reload</button>
                <button onclick="hardReload()">âš¡ Hard Reload (ÙˆØ§Ù‚Ø¹ÛŒ)</button>
            </div>
            <p style="color: #7f8c8d; font-size: 0.9rem;">* Hard Reload ØµÙØ­Ù‡ Ø±Ø§ Ú©Ø§Ù…Ù„Ø§Ù‹ Ø¨Ø§Ø²Ø®ÙˆØ§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯</p>
        </div>

        <div class="log-container" id="logContainer">
            <div class="log-entry">â±ï¸ [${new Date().toLocaleTimeString()}] ØµÙØ­Ù‡ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯</div>
        </div>
    </div>

    <script>
        // ---------- ÙˆØ¶Ø¹ÛŒØª Ø§ÙˆÙ„ÛŒÙ‡ (State) ----------
        let appState = {
            auth: {
                isLoggedIn: false,
                username: null,
                token: null
            },
            lesson: {
                currentLessonId: null,
                correctCount: 0,
                wrongCount: 0
            },
            lastSaved: null
        };

        // ---------- Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ DOM ----------
        const authStatusEl = document.getElementById('authStatus');
        const currentUserEl = document.getElementById('currentUser');
        const currentLessonEl = document.getElementById('currentLesson');
        const correctAnswersEl = document.getElementById('correctAnswers');
        const wrongAnswersEl = document.getElementById('wrongAnswers');
        const logContainer = document.getElementById('logContainer');
        const persistenceDot = document.getElementById('persistenceDot');
        const persistenceText = document.getElementById('persistenceText');

        // ---------- ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ ----------
        function addLog(message, type = 'info') {
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            const timestamp = new Date().toLocaleTimeString('fa-IR');
            
            let icon = 'ğŸ“Œ';
            if (type === 'success') icon = 'âœ…';
            if (type === 'error') icon = 'âŒ';
            if (type === 'warning') icon = 'âš ï¸';
            if (type === 'save') icon = 'ğŸ’¾';
            if (type === 'load') icon = 'ğŸ“‚';
            
            logEntry.textContent = `${icon} [${timestamp}] ${message}`;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø¨Ø¹Ø¯ Ø§Ø² reload
            const logs = JSON.parse(localStorage.getItem('test_logs') || '[]');
            logs.push({ message, type, timestamp: new Date().toISOString() });
            localStorage.setItem('test_logs', JSON.stringify(logs.slice(-50))); // Ù†Ú¯Ù‡â€ŒØ¯Ø§Ø´ØªÙ† ÛµÛ° Ù„Ø§Ú¯ Ø¢Ø®Ø±
        }

        function updateUI() {
            // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª
            if (appState.auth.isLoggedIn) {
                authStatusEl.textContent = 'ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡';
                authStatusEl.style.color = '#27ae60';
                currentUserEl.textContent = appState.auth.username;
            } else {
                authStatusEl.textContent = 'Ø®Ø§Ø±Ø¬ Ø´Ø¯Ù‡';
                authStatusEl.style.color = '#e74c3c';
                currentUserEl.textContent = '-';
            }

            // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¯Ø±Ø³
            currentLessonEl.textContent = appState.lesson.currentLessonId ? `Ø¯Ø±Ø³ ${appState.lesson.currentLessonId}` : '-';
            correctAnswersEl.textContent = appState.lesson.correctCount;
            wrongAnswersEl.textContent = appState.lesson.wrongCount;

            // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ø´Ø§Ù†Ú¯Ø± Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ
            const savedState = localStorage.getItem('appState');
            if (savedState) {
                persistenceDot.style.backgroundColor = '#27ae60';
                persistenceText.textContent = 'ÙˆØ¶Ø¹ÛŒØª: Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ Ø¯Ø± localStorage';
            } else {
                persistenceDot.style.backgroundColor = '#e74c3c';
                persistenceText.textContent = 'ÙˆØ¶Ø¹ÛŒØª: Ø°Ø®ÛŒØ±Ù‡ Ù†Ø´Ø¯Ù‡';
            }
        }

        // Ø°Ø®ÛŒØ±Ù‡ ÙˆØ¶Ø¹ÛŒØª Ø¯Ø± localStorage
        function persistState() {
            try {
                const stateToSave = {
                    auth: {
                        isLoggedIn: appState.auth.isLoggedIn,
                        username: appState.auth.username,
                        token: appState.auth.token
                    },
                    lesson: { ...appState.lesson },
                    lastSaved: new Date().toISOString()
                };
                localStorage.setItem('appState', JSON.stringify(stateToSave));
                appState.lastSaved = new Date().toISOString();
                persistenceDot.style.backgroundColor = '#27ae60';
                persistenceText.textContent = `ÙˆØ¶Ø¹ÛŒØª: Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ Ø¯Ø± ${new Date().toLocaleTimeString()}`;
                addLog('ÙˆØ¶Ø¹ÛŒØª Ø¯Ø± localStorage Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯', 'save');
                return true;
            } catch (e) {
                addLog(`Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ: ${e.message}`, 'error');
                return false;
            }
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø§Ø² localStorage
        function loadPersistedState() {
            try {
                const saved = localStorage.getItem('appState');
                if (saved) {
                    const parsed = JSON.parse(saved);
                    appState = {
                        auth: parsed.auth || { isLoggedIn: false, username: null, token: null },
                        lesson: parsed.lesson || { currentLessonId: null, correctCount: 0, wrongCount: 0 },
                        lastSaved: parsed.lastSaved || null
                    };
                    addLog('ÙˆØ¶Ø¹ÛŒØª Ø§Ø² localStorage Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø´Ø¯', 'load');
                    updateUI();
                    return true;
                } else {
                    addLog('Ù‡ÛŒÚ† ÙˆØ¶Ø¹ÛŒØª Ø°Ø®ÛŒØ±Ù‡â€ŒØ´Ø¯Ù‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯', 'warning');
                    return false;
                }
            } catch (e) {
                addLog(`Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª: ${e.message}`, 'error');
                return false;
            }
        }

        // ---------- Ø§Ú©Ø´Ù†â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± ----------
        window.simulateLogin = function() {
            appState.auth.isLoggedIn = true;
            appState.auth.username = 'Ø¹Ù„ÛŒ Ù…Ø­Ù…Ø¯ÛŒ';
            appState.auth.token = 'jwt_token_' + Date.now();
            addLog(`Ú©Ø§Ø±Ø¨Ø± "${appState.auth.username}" ÙˆØ§Ø±Ø¯ Ø´Ø¯`, 'success');
            persistState(); // Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø³ Ø§Ø² ÙˆØ±ÙˆØ¯
            updateUI();
        };

        window.simulateLogout = function() {
            appState.auth.isLoggedIn = false;
            appState.auth.username = null;
            appState.auth.token = null;
            addLog('Ú©Ø§Ø±Ø¨Ø± Ø®Ø§Ø±Ø¬ Ø´Ø¯', 'warning');
            persistState(); // Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø³ Ø§Ø² Ø®Ø±ÙˆØ¬
            updateUI();
        };

        window.loadLesson = function(lessonId) {
            if (!appState.auth.isLoggedIn) {
                addLog('Ø®Ø·Ø§: Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø±Ø³ Ø¨Ø§ÛŒØ¯ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯', 'error');
                return;
            }
            appState.lesson.currentLessonId = lessonId;
            addLog(`Ø¯Ø±Ø³ ${lessonId} Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯`, 'success');
            persistState(); // Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø³ Ø§Ø² Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø±Ø³
            updateUI();
        };

        window.addCorrectAnswer = function() {
            if (!appState.lesson.currentLessonId) {
                addLog('Ø®Ø·Ø§: Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ø¯Ø±Ø³ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯', 'error');
                return;
            }
            appState.lesson.correctCount++;
            addLog(`âœ… Ù¾Ø§Ø³Ø® Ø¯Ø±Ø³Øª Ø«Ø¨Øª Ø´Ø¯ (Ù…Ø¬Ù…ÙˆØ¹: ${appState.lesson.correctCount})`, 'success');
            persistState(); // Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø³ Ø§Ø² Ù‡Ø± Ù¾Ø§Ø³Ø®
            updateUI();
        };

        window.addWrongAnswer = function() {
            if (!appState.lesson.currentLessonId) {
                addLog('Ø®Ø·Ø§: Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ø¯Ø±Ø³ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯', 'error');
                return;
            }
            appState.lesson.wrongCount++;
            addLog(`âŒ Ù¾Ø§Ø³Ø® ØºÙ„Ø· Ø«Ø¨Øª Ø´Ø¯ (Ù…Ø¬Ù…ÙˆØ¹: ${appState.lesson.wrongCount})`, 'warning');
            persistState(); // Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø³ Ø§Ø² Ù‡Ø± Ù¾Ø§Ø³Ø®
            updateUI();
        };

        window.saveState = function() {
            persistState();
        };

        window.loadState = function() {
            loadPersistedState();
        };

        window.clearStorage = function() {
            if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ØªÙ…Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')) {
                localStorage.removeItem('appState');
                localStorage.removeItem('test_logs');
                logContainer.innerHTML = '<div class="log-entry">ğŸ§¹ Ø­Ø§ÙØ¸Ù‡ Ù¾Ø§Ú© Ø´Ø¯</div>';
                appState = {
                    auth: { isLoggedIn: false, username: null, token: null },
                    lesson: { currentLessonId: null, correctCount: 0, wrongCount: 0 },
                    lastSaved: null
                };
                updateUI();
                addLog('Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯', 'warning');
            }
        };

        window.simulateReload = function() {
            addLog('ğŸ”„ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Reload: Ø°Ø®ÛŒØ±Ù‡ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª', 'info');
            persistState();
            setTimeout(() => {
                loadPersistedState();
                addLog('âœ… Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Reload Ú©Ø§Ù…Ù„ Ø´Ø¯', 'success');
            }, 500);
        };

        window.hardReload = function() {
            persistState();
            addLog('âš ï¸ Hard Reload ÙˆØ§Ù‚Ø¹ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§...', 'warning');
            setTimeout(() => {
                window.location.reload();
            }, 1000);
        };

        // ---------- Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± ÙˆØ¶Ø¹ÛŒØª Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ù‡ ----------
        (function initialize() {
            // Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
            loadPersistedState();
            
            // Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ
            const savedLogs = localStorage.getItem('test_logs');
            if (savedLogs) {
                const logs = JSON.parse(savedLogs);
                logs.forEach(log => {
                    const logEntry = document.createElement('div');
                    logEntry.className = 'log-entry';
                    let icon = 'ğŸ“Œ';
                    if (log.type === 'success') icon = 'âœ…';
                    if (log.type === 'error') icon = 'âŒ';
                    if (log.type === 'warning') icon = 'âš ï¸';
                    const time = new Date(log.timestamp).toLocaleTimeString('fa-IR');
                    logEntry.textContent = `${icon} [${time}] ${log.message} (Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø´Ø¯Ù‡)`;
                    logContainer.appendChild(logEntry);
                });
            }
            
            addLog('ØµÙØ­Ù‡ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯ - ÙˆØ¶Ø¹ÛŒØª Ø§Ø² localStorage Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ú¯Ø±Ø¯ÛŒØ¯', 'info');
            updateUI();
        })();

        // Ù†Ø¸Ø§Ø±Ù‡â€ŒÚ¯Ø± ØªØºÛŒÛŒØ±Ø§Øª Ø¢Ù†Ù„Ø§ÛŒÙ†/Ø¢ÙÙ„Ø§ÛŒÙ†
        window.addEventListener('online', () => {
            document.getElementById('connectionStatus').className = 'status-badge status-active';
            document.getElementById('connectionStatus').textContent = 'ğŸŸ¢ Ø¢Ù†Ù„Ø§ÛŒÙ†';
            addLog('Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª Ø¨Ø±Ù‚Ø±Ø§Ø± Ø´Ø¯', 'success');
        });

        window.addEventListener('offline', () => {
            document.getElementById('connectionStatus').className = 'status-badge status-inactive';
            document.getElementById('connectionStatus').textContent = 'ğŸ”´ Ø¢ÙÙ„Ø§ÛŒÙ†';
            addLog('Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª Ù‚Ø·Ø¹ Ø´Ø¯', 'warning');
        });

        // Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ù‚Ø¨Ù„ Ø§Ø² Ø¨Ø³ØªÙ‡ Ø´Ø¯Ù† ØµÙØ­Ù‡
        window.addEventListener('beforeunload', function() {
            persistState();
        });
    </script>
</body>
</html>
