<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª Ø¯Ø³ØªÛŒ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¯Ø±Ø³ | Farsinglish</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Tahoma', 'Vazir', sans-serif;
            background: #f0f2f5;
            padding: 16px;
            max-width: 800px;
            margin: 0 auto;
            color: #1e293b;
        }
        .header {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            color: white;
            padding: 20px;
            border-radius: 24px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }
        .header h1 { font-size: 1.6rem; margin-bottom: 5px; }
        .header h2 { font-size: 1rem; opacity: 0.9; font-weight: normal; }
        .test-card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            border: 1px solid #e9eef2;
        }
        .test-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #2563eb;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .test-title span { background: #2563eb; color: white; padding: 4px 12px; border-radius: 40px; font-size: 0.8rem; }
        .scenario-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        button {
            background: white;
            border: 2px solid #cbd5e1;
            color: #1e293b;
            padding: 12px 16px;
            border-radius: 40px;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            flex: 1 1 auto;
            min-width: 140px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.02);
        }
        button:hover { background: #f8fafc; border-color: #2563eb; }
        button.primary { background: #2563eb; border-color: #2563eb; color: white; }
        button.primary:hover { background: #1d4ed8; }
        .result-box {
            background: #f8fafc;
            border-radius: 16px;
            padding: 16px;
            margin-top: 15px;
            border: 1px solid #e2e8f0;
            font-family: 'Courier New', monospace;
            direction: ltr;
            text-align: left;
            white-space: pre-wrap;
            word-break: break-word;
            max-height: 200px;
            overflow: auto;
        }
        .result-box.pass { border-right: 6px solid #22c55e; background: #f0fdf4; }
        .result-box.fail { border-right: 6px solid #ef4444; background: #fef2f2; }
        .summary {
            background: #1e293b;
            color: white;
            padding: 20px;
            border-radius: 20px;
            margin-top: 25px;
            text-align: center;
        }
        .badge {
            display: inline-block;
            background: #334155;
            padding: 6px 14px;
            border-radius: 40px;
            font-size: 0.85rem;
            margin: 3px;
            color: #e2e8f0;
        }
        hr { border: none; border-top: 1px dashed #cbd5e1; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“‹ Farsinglish Â· Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¯Ø±Ø³</h1>
        <h2>ØªØ³Øª Ø¯Ø³ØªÛŒ Â· Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ÛŒ edge-case Â· Ø§ÙˆÙ„ÙˆÛŒØª A6</h2>
    </div>

    <!-- Ú©Ø§Ø±Øª Ø§ØµÙ„ÛŒ ØªØ³Øª -->
    <div class="test-card" id="mainCard">
        <div class="test-title">
            <span>ğŸ§ª A6</span> ØªØ³Øª Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Lesson (Ø®Ø§Ù„ÛŒØŒ Ù†Ø§Ù‚ØµØŒ ØªÚ©Ø±Ø§Ø±ÛŒØŒ Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡)
        </div>

        <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ù†Ø§Ø±ÛŒÙˆ -->
        <div class="scenario-buttons">
            <button id="btnEmptyTitle" class="primary">ğŸ“­ Ø¹Ù†ÙˆØ§Ù† Ø®Ø§Ù„ÛŒ</button>
            <button id="btnMissingFields" class="primary">ğŸ§© ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ù†Ø§Ù‚Øµ</button>
            <button id="btnDuplicateId" class="primary">ğŸ” Ø´Ù†Ø§Ø³Ù‡ ØªÚ©Ø±Ø§Ø±ÛŒ</button>
            <button id="btnInvalidType" class="primary">âš ï¸ Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡ Ø§Ø´ØªØ¨Ø§Ù‡</button>
            <button id="btnEmptyArray" class="primary">ğŸ“¦ Ø¢Ø±Ø§ÛŒÙ‡ Ø®Ø§Ù„ÛŒ</button>
            <button id="btnNullLesson" class="primary">ğŸš« lesson = null</button>
            <button id="btnValidLesson" class="primary">âœ… Ø¯Ø±Ø³ Ø³Ø§Ù„Ù… (Ú©Ù†ØªØ±Ù„)</button>
            <button id="btnReset" style="background:#e2e8f0;">âŸ² Ø±ÛŒØ³Øª</button>
        </div>

        <!-- Ù†Ù…Ø§ÛŒØ´ Ø¢Ø®Ø±ÛŒÙ† Ù†ØªÛŒØ¬Ù‡ -->
        <div id="resultDisplay" class="result-box pass">
            Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ ÛŒÚ©ÛŒ Ø§Ø² Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯.
        </div>

        <!-- ØªÙˆØ¶ÛŒØ­ Ù…Ø®ØªØµØ± -->
        <div style="margin-top: 16px; background: #e6f7ff; padding: 12px; border-radius: 12px; font-size: 0.9rem; border: 1px solid #91caff;">
            <strong>ğŸ” Ù‡Ø¯Ù:</strong> Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ§Ø¨Ø¹ validateLesson(lesson) â€” ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø¨Ø§ÛŒØ¯ Ø®Ø·Ø§ÛŒ Ù…Ø´Ø®Øµ Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ù†Ø¯.
        </div>
    </div>

    <!-- ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¢Ø®Ø±ÛŒÙ† ØªØ³Øªâ€ŒÙ‡Ø§ -->
    <div class="test-card">
        <div class="test-title">
            <span>ğŸ“œ</span> Ø¢Ø®Ø±ÛŒÙ† Ù†ØªØ§ÛŒØ¬ (ØªØ§ Ûµ ØªØ³Øª)
        </div>
        <div id="historyBox" style="font-size:0.9rem; max-height:150px; overflow-y:auto;">
            <span class="badge">â€”</span>
        </div>
    </div>

    <!-- Ø®Ù„Ø§ØµÙ‡ Ø¯Ø³ØªÛŒ -->
    <div class="summary" id="summary">
        <div style="display: flex; justify-content: space-around; font-size:1.1rem;">
            <span>âœ… Ù…ÙˆÙÙ‚: <span id="passCount">Û°</span></span>
            <span>âŒ Ù†Ø§Ù…ÙˆÙÙ‚: <span id="failCount">Û°</span></span>
            <span>ğŸ“‹ Ú©Ù„: <span id="totalCount">Û°</span></span>
        </div>
        <div style="margin-top: 10px; font-size:0.85rem; opacity:0.8;">
            ØªØ³Øªâ€ŒÙ‡Ø§ Ø¯Ø³ØªÛŒ Ùˆ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¨Ø§Ø²Ø®ÙˆØ±Ø¯ Ø´Ù…Ø§ Ø«Ø¨Øª Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.
        </div>
    </div>

    <script>
        (function() {
            // ---------- Ú©Ù„Ø§Ø³ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¯Ø±Ø³ (Ù…Ø´Ø§Ø¨Ù‡ core) ----------
            class LessonValidator {
                static validate(lesson) {
                    // Ù…Ø±Ø­Ù„Ù‡ 1: ÙˆØ¬ÙˆØ¯ Ø¯Ø±Ø³
                    if (lesson === null || lesson === undefined) {
                        return { isValid: false, error: 'Ø¯Ø±Ø³ null ÛŒØ§ undefined Ø§Ø³Øª' };
                    }
                    if (typeof lesson !== 'object') {
                        return { isValid: false, error: 'Ø¯Ø±Ø³ Ø¨Ø§ÛŒØ¯ ÛŒÚ© Ø´ÛŒØ¡ Ø¨Ø§Ø´Ø¯' };
                    }

                    // Ù…Ø±Ø­Ù„Ù‡ 2: Ø´Ù†Ø§Ø³Ù‡
                    if (!lesson.hasOwnProperty('id')) {
                        return { isValid: false, error: 'ÙÛŒÙ„Ø¯ id ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯' };
                    }
                    if (typeof lesson.id !== 'string' && typeof lesson.id !== 'number') {
                        return { isValid: false, error: 'Ù†ÙˆØ¹ id Ø¨Ø§ÛŒØ¯ string ÛŒØ§ number Ø¨Ø§Ø´Ø¯' };
                    }
                    if (String(lesson.id).trim() === '') {
                        return { isValid: false, error: 'id Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø®Ø§Ù„ÛŒ Ø¨Ø§Ø´Ø¯' };
                    }

                    // Ù…Ø±Ø­Ù„Ù‡ 3: Ø¹Ù†ÙˆØ§Ù†
                    if (!lesson.hasOwnProperty('title')) {
                        return { isValid: false, error: 'ÙÛŒÙ„Ø¯ title ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯' };
                    }
                    if (typeof lesson.title !== 'string') {
                        return { isValid: false, error: 'title Ø¨Ø§ÛŒØ¯ string Ø¨Ø§Ø´Ø¯' };
                    }
                    if (lesson.title.trim() === '') {
                        return { isValid: false, error: 'title Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø®Ø§Ù„ÛŒ Ø¨Ø§Ø´Ø¯' };
                    }

                    // Ù…Ø±Ø­Ù„Ù‡ 4: Ø³Ø·Ø­ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ Ø§Ù…Ø§ Ø§Ú¯Ø± Ø¨Ø§Ø´Ø¯ Ø¨Ø§ÛŒØ¯ number Ù…Ø«Ø¨Øª Ø¨Ø§Ø´Ø¯)
                    if (lesson.hasOwnProperty('level')) {
                        if (typeof lesson.level !== 'number' || lesson.level < 1) {
                            return { isValid: false, error: 'level Ø¨Ø§ÛŒØ¯ Ø¹Ø¯Ø¯ Ù…Ø«Ø¨Øª Ø¨Ø§Ø´Ø¯' };
                        }
                    }

                    // Ù…Ø±Ø­Ù„Ù‡ 5: Ú©Ù„Ù…Ø§Øª (words) Ø¨Ø§ÛŒØ¯ Ø¢Ø±Ø§ÛŒÙ‡ Ø¨Ø§Ø´Ø¯ Ùˆ Ø­Ø¯Ø§Ù‚Ù„ ÛŒÚ© Ú©Ù„Ù…Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯
                    if (!lesson.hasOwnProperty('words')) {
                        return { isValid: false, error: 'ÙÛŒÙ„Ø¯ words ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯' };
                    }
                    if (!Array.isArray(lesson.words)) {
                        return { isValid: false, error: 'words Ø¨Ø§ÛŒØ¯ Ø¢Ø±Ø§ÛŒÙ‡ Ø¨Ø§Ø´Ø¯' };
                    }
                    if (lesson.words.length === 0) {
                        return { isValid: false, error: 'words Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø®Ø§Ù„ÛŒ Ø¨Ø§Ø´Ø¯ (Ø­Ø¯Ø§Ù‚Ù„ ÛŒÚ© Ú©Ù„Ù…Ù‡)' };
                    }

                    // Ø¨Ø±Ø±Ø³ÛŒ Ù‡Ø± Ú©Ù„Ù…Ù‡ (Ø³Ø§Ø¯Ù‡ Ø´Ø¯Ù‡)
                    for (let i = 0; i < lesson.words.length; i++) {
                        const w = lesson.words[i];
                        if (!w || typeof w !== 'object') {
                            return { isValid: false, error: `Ú©Ù„Ù…Ù‡ ${i} Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª` };
                        }
                        if (!w.original || !w.translation) {
                            return { isValid: false, error: `Ú©Ù„Ù…Ù‡ ${i}: original ÛŒØ§ translation Ù†Ø¯Ø§Ø±Ø¯` };
                        }
                    }

                    // Ù…Ø±Ø­Ù„Ù‡ 6: Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² ID ØªÚ©Ø±Ø§Ø±ÛŒ (Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ ÛŒÚ© Set Ø³Ø±Ø§Ø³Ø±ÛŒ)
                    // Ø¨Ø±Ø§ÛŒ ØªØ³ØªØŒ Ø§Ø² ÛŒÚ© static Set Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… (Ø¯Ø± Ù…Ø­ÛŒØ· ÙˆØ§Ù‚Ø¹ÛŒ Ø§Ø² DB Ù…ÛŒâ€ŒØ¢ÛŒØ¯)
                    if (!LessonValidator._idSet) LessonValidator._idSet = new Set();
                    const idStr = String(lesson.id);
                    if (LessonValidator._idSet.has(idStr)) {
                        return { isValid: false, error: `id ØªÚ©Ø±Ø§Ø±ÛŒ: ${idStr}` };
                    }
                    // Ø§Ú¯Ø± valid Ø¨ÙˆØ¯ØŒ id Ø±Ø§ Ø¨Ù‡ Set Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… (Ø¨Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ)
                    LessonValidator._idSet.add(idStr);

                    return { isValid: true, error: null };
                }

                // Ø±ÛŒØ³Øª Set (Ø¨Ø±Ø§ÛŒ ØªØ³Øª)
                static resetIdSet() {
                    LessonValidator._idSet = new Set();
                }
            }
            LessonValidator.resetIdSet(); // Ø´Ø±ÙˆØ¹ Ø¨Ø§ Set Ø®Ø§Ù„ÛŒ

            // ---------- Ù…Ø¯ÛŒØ±ÛŒØª ØªØ³Øª Ùˆ Ù†Ù…Ø§ÛŒØ´ ----------
            const resultDiv = document.getElementById('resultDisplay');
            const historyBox = document.getElementById('historyBox');
            const passSpan = document.getElementById('passCount');
            const failSpan = document.getElementById('failCount');
            const totalSpan = document.getElementById('totalCount');

            let pass = 0, fail = 0;
            let history = []; // Ø°Ø®ÛŒØ±Ù‡ Ø¢Ø®Ø±ÛŒÙ† Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§

            function addToHistory(message, isSuccess) {
                history.unshift({ message, isSuccess, time: new Date().toLocaleTimeString('fa-IR') });
                if (history.length > 5) history.pop();
                renderHistory();
            }

            function renderHistory() {
                let html = '';
                history.forEach(item => {
                    html += `<span class="badge" style="background:${item.isSuccess ? '#14532d' : '#7f1d1d'}">${item.time} - ${item.message.substring(0,35)}...</span>`;
                });
                if (history.length === 0) html = '<span class="badge">ØªØ³ØªÛŒ Ø§Ø¬Ø±Ø§ Ù†Ø´Ø¯Ù‡</span>';
                historyBox.innerHTML = html;
            }

            function updateSummary() {
                passSpan.innerText = pass;
                failSpan.innerText = fail;
                totalSpan.innerText = pass + fail;
            }

            function runTest(description, lessonInput) {
                // Ø±ÛŒØ³Øª result box
                let result;
                try {
                    result = LessonValidator.validate(lessonInput);
                } catch (e) {
                    result = { isValid: false, error: 'Ø§Ø³ØªØ«Ù†Ø§: ' + e.message };
                }

                // Ù†Ù…Ø§ÛŒØ´
                const isSuccess = result.isValid === true; // Ø§Ú¯Ø± isValid:true ÛŒØ¹Ù†ÛŒ Ù…ÙˆÙÙ‚ (Ø¯Ø±Ø³ Ø³Ø§Ù„Ù…)
                let outputText = `ğŸ§ª ${description}\n`;
                outputText += `ÙˆØ±ÙˆØ¯ÛŒ: ${JSON.stringify(lessonInput, null, 2)}\n`;
                outputText += `âœ… Ù…Ø¹ØªØ¨Ø±: ${result.isValid}\n`;
                outputText += `âŒ Ø®Ø·Ø§: ${result.error || 'Ù†Ø¯Ø§Ø±Ø¯'}\n`;
                outputText += `â±ï¸ ${new Date().toLocaleTimeString('fa-IR')}`;

                resultDiv.className = 'result-box ' + (isSuccess ? 'pass' : 'fail');
                resultDiv.innerText = outputText;

                // Ø¢Ù…Ø§Ø±: Ø§Ú¯Ø± isValid true ÛŒØ¹Ù†ÛŒ ØªØ³Øª Ù…ÙˆÙÙ‚ (Ø¯Ø±Ø³ Ø¯Ø±Ø³Øª Ø±Ø§ Ù¾Ø°ÛŒØ±ÙØªÙ‡)
                // Ø§Ù…Ø§ Ø¯Ø± Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø±ØŒ ØªÙˆÙ‚Ø¹ Ø¯Ø§Ø±ÛŒÙ… isValid false Ùˆ Ù¾ÛŒØ§Ù… Ø®Ø·Ø§
                // Ø¨Ù†Ø§Ø¨Ø±Ø§ÛŒÙ† Ù…ÙˆÙÙ‚ÛŒØª ØªØ³Øª Ø±Ø§ Ø®ÙˆØ¯Ù…Ø§Ù† Ø¨Ø§ÛŒØ¯ ØªØ¹ÛŒÛŒÙ† Ú©Ù†ÛŒÙ… (Ø¯Ø³ØªÛŒ)
                // Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ ÙÙ‚Ø· Ù†Ù…Ø§ÛŒØ´ Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ…ØŒ Ú©Ø§Ø±Ø¨Ø± Ø¯Ú©Ù…Ù‡ "Ù…ÙˆÙÙ‚/Ù†Ø§Ù…ÙˆÙÙ‚" Ù…ÛŒâ€ŒØ²Ù†Ø¯.

                // Ø°Ø®ÛŒØ±Ù‡ context Ø¨Ø±Ø§ÛŒ Ø«Ø¨Øª Ø¯Ø³ØªÛŒ
                window._lastTest = { description, lessonInput, result, raw: outputText };
                addToHistory(description, true); // ÙØ¹Ù„Ø§ Ù…ÙˆÙ‚Øª
            }

            // Ø«Ø¨Øª Ø¯Ø³ØªÛŒ Ù†ØªÛŒØ¬Ù‡ ØªÙˆØ³Ø· Ú©Ø§Ø±Ø¨Ø± (Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ + Ùˆ -)
            window.recordTest = function(success) {
                if (!window._lastTest) {
                    alert('Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© ØªØ³Øª Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯');
                    return;
                }
                if (success) {
                    pass++;
                } else {
                    fail++;
                }
                updateSummary();
                // Ø«Ø¨Øª Ø¯Ø± ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¨Ø§ ÙˆØ¶Ø¹ÛŒØª Ù†Ù‡Ø§ÛŒÛŒ
                const msg = window._lastTest.description + (success ? ' âœ“' : ' âœ—');
                addToHistory(msg, success);
                // Ø¢Ù¾Ø¯ÛŒØª Ø±Ù†Ú¯ result box Ù†Ù‡Ø§ÛŒÛŒ
                if (success) {
                    resultDiv.className = 'result-box pass';
                } else {
                    resultDiv.className = 'result-box fail';
                }
            };

            // ---------- Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ÛŒ Ø§Ø² Ù¾ÛŒØ´ ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡ ----------
            const scenarios = {
                emptyTitle: {
                    id: 'L001',
                    title: '   ',
                    words: [{ original: 'hello', translation: 'Ø³Ù„Ø§Ù…' }]
                },
                missingFields: {
                    id: 'L002'
                    // title Ùˆ words Ù†Ø¯Ø§Ø±ÛŒÙ…
                },
                duplicateId: {
                    id: 'duplicate',
                    title: 'Ø¯Ø±Ø³ ØªÚ©Ø±Ø§Ø±ÛŒ',
                    words: [{ original: 'test', translation: 'ØªØ³Øª' }]
                },
                invalidType: {
                    id: 12345,
                    title: 456, // title Ø¨Ø§ÛŒØ¯ string Ø¨Ø§Ø´Ø¯
                    words: ['not an object'] // Ú©Ù„Ù…Ù‡ Ø¨Ø§ÛŒØ¯ Ø´ÛŒØ¡ Ø¨Ø§Ø´Ø¯
                },
                emptyArray: {
                    id: 'L003',
                    title: 'Ø¯Ø±Ø³ Ø¨Ø¯ÙˆÙ† Ú©Ù„Ù…Ù‡',
                    words: []
                },
                nullLesson: null,
                validLesson: {
                    id: 'L999',
                    title: 'Ø¯Ø±Ø³ Ø³Ø§Ù„Ù…',
                    level: 2,
                    words: [
                        { original: 'apple', translation: 'Ø³ÛŒØ¨' },
                        { original: 'book', translation: 'Ú©ØªØ§Ø¨' }
                    ]
                }
            };

            // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† id ØªÚ©Ø±Ø§Ø±ÛŒ Ø¨Ù‡ Set (Ø¨Ø±Ø§ÛŒ ØªØ³Øª duplicate)
            LessonValidator._idSet.add('duplicate'); // Ø§Ù„Ø§Ù† duplicate ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯

            // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
            document.getElementById('btnEmptyTitle').addEventListener('click', () => {
                runTest('Ø¹Ù†ÙˆØ§Ù† Ø®Ø§Ù„ÛŒ', scenarios.emptyTitle);
            });
            document.getElementById('btnMissingFields').addEventListener('click', () => {
                runTest('ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ù†Ø§Ù‚Øµ (Ø¨Ø¯ÙˆÙ† title Ùˆ words)', scenarios.missingFields);
            });
            document.getElementById('btnDuplicateId').addEventListener('click', () => {
                runTest('Ø´Ù†Ø§Ø³Ù‡ ØªÚ©Ø±Ø§Ø±ÛŒ', scenarios.duplicateId);
            });
            document.getElementById('btnInvalidType').addEventListener('click', () => {
                runTest('Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡ Ø§Ø´ØªØ¨Ø§Ù‡', scenarios.invalidType);
            });
            document.getElementById('btnEmptyArray').addEventListener('click', () => {
                runTest('Ø¢Ø±Ø§ÛŒÙ‡ Ú©Ù„Ù…Ø§Øª Ø®Ø§Ù„ÛŒ', scenarios.emptyArray);
            });
            document.getElementById('btnNullLesson').addEventListener('click', () => {
                runTest('Ø¯Ø±Ø³ null', scenarios.nullLesson);
            });
            document.getElementById('btnValidLesson').addEventListener('click', () => {
                runTest('Ø¯Ø±Ø³ Ø³Ø§Ù„Ù… (Ú©Ù†ØªØ±Ù„)', scenarios.validLesson);
            });
            document.getElementById('btnReset').addEventListener('click', () => {
                LessonValidator.resetIdSet();
                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù…Ø¬Ø¯Ø¯ duplicate Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø¨Ø¹Ø¯ÛŒ
                LessonValidator._idSet.add('duplicate');
                resultDiv.innerText = 'Ø±ÛŒØ³Øª Ø´Ø¯. Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªØ³Øª Ú©Ù†ÛŒØ¯.';
                resultDiv.className = 'result-box';
                // Ø¢Ù…Ø§Ø± Ø±Ø§ Ø±ÛŒØ³Øª Ù†Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… (Ø¯Ø³ØªÛŒ)
            });

            // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø«Ø¨Øª Ù…ÙˆÙÙ‚ÛŒØª/Ø´Ú©Ø³Øª (Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¯Ùˆ Ø¯Ú©Ù…Ù‡ Ø¨Ù‡ UI Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯)
            // Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø¯Ú¯ÛŒØŒ Ø¨Ø§ Ø¯Ùˆ Ø¯Ú©Ù…Ù‡ Ø´Ù†Ø§ÙˆØ± Ø¯Ø± Ù¾Ø§ÛŒÛŒÙ† ØµÙØ­Ù‡
            const floatingDiv = document.createElement('div');
            floatingDiv.style.position = 'sticky';
            floatingDiv.style.bottom = '10px';
            floatingDiv.style.display = 'flex';
            floatingDiv.style.gap = '10px';
            floatingDiv.style.justifyContent = 'center';
            floatingDiv.style.marginTop = '20px';
            floatingDiv.style.padding = '10px';
            floatingDiv.style.background = 'white';
            floatingDiv.style.borderRadius = '60px';
            floatingDiv.style.boxShadow = '0 4px 15px rgba(0,0,0,0.2)';
            floatingDiv.style.border = '1px solid #ddd';
            floatingDiv.innerHTML = `
                <button style="background:#22c55e; color:white; border:none; padding:12px 30px; border-radius:40px; font-weight:bold; flex:1;" onclick="recordTest(true)">âœ… Ù…ÙˆÙÙ‚</button>
                <button style="background:#ef4444; color:white; border:none; padding:12px 30px; border-radius:40px; font-weight:bold; flex:1;" onclick="recordTest(false)">âŒ Ù†Ø§Ù…ÙˆÙÙ‚</button>
            `;
            document.body.appendChild(floatingDiv);

            // Ù…Ù‚Ø¯Ø§Ø± Ø§ÙˆÙ„ÛŒÙ‡ summary
            updateSummary();
        })();
    </script>
</body>
</html>
