<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª Ø¯Ø³ØªÛŒ: Ù…ÙˆØªÙˆØ± SRS (SM-2)</title>
    <style>
        body { font-family: system-ui, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
        .container { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; font-size: 1.8rem; margin-bottom: 10px; }
        .card { background: #f8f9fa; border-radius: 8px; padding: 20px; margin: 20px 0; border: 1px solid #dee2e6; }
        button { background: #2c3e50; color: white; border: none; padding: 12px 24px; border-radius: 6px; font-size: 16px; margin: 5px; cursor: pointer; }
        button:hover { background: #34495e; }
        .result { background: #e9ecef; padding: 15px; border-radius: 6px; margin-top: 20px; font-family: monospace; white-space: pre-wrap; }
        .badge { display: inline-block; padding: 4px 8px; border-radius: 4px; background: #28a745; color: white; font-size: 12px; }
        pre { background: #2d2d2d; color: #f8f9fa; padding: 15px; border-radius: 6px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§  ØªØ³Øª Ø¯Ø³ØªÛŒ SRS (Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… SM-2)</h1>
        <p>Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ú©Ù„ÛŒÚ© Ú©Ù† ØªØ§ Ø®Ø±ÙˆØ¬ÛŒ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… Ø±Ø§ Ø¨Ø¨ÛŒÙ†ÛŒ</p>

        <div class="card">
            <h3>ğŸ“Š Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Û±: Ù…Ø±ÙˆØ± Ù…ØªÙˆØ§Ù„ÛŒ Ø¨Ø§ Ú©ÛŒÙÛŒØª Ø¹Ø§Ù„ÛŒ (Ûµ)</h3>
            <button onclick="runScenario1()">Ø§Ø¬Ø±Ø§ÛŒ Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Û±</button>
            <div id="result1" class="result">Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†</div>
        </div>

        <div class="card">
            <h3>ğŸ“‰ Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Û²: Ú©Ø§Ù‡Ø´ Ú©ÛŒÙÛŒØª Ùˆ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ÙØ§ØµÙ„Ù‡ Û±</h3>
            <button onclick="runScenario2()">Ø§Ø¬Ø±Ø§ÛŒ Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Û²</button>
            <div id="result2" class="result">Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†</div>
        </div>

        <div class="card">
            <h3>ğŸ”„ Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Û³: Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø³ØªÛŒ ÙØ§ØµÙ„Ù‡ ØªØµØ§Ø¹Ø¯ÛŒ</h3>
            <button onclick="runScenario3()">Ø§Ø¬Ø±Ø§ÛŒ Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Û³</button>
            <div id="result3" class="result">Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†</div>
        </div>

        <div class="card">
            <h3>ğŸ§ª Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Û´: ØªØ³Øª Ù‡Ù…Ù‡ Ú©ÛŒÙÛŒØ§Øª (Û° ØªØ§ Ûµ)</h3>
            <button onclick="runScenario4()">Ø§Ø¬Ø±Ø§ÛŒ Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Û´</button>
            <div id="result4" class="result">Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†</div>
        </div>
    </div>

    <script>
        // ------------------------------------------------------------
        // srs-engine.js - Ù‡Ø³ØªÙ‡ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… SM-2 (Ù†Ø³Ø®Ù‡ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡)
        // ------------------------------------------------------------
        const SRS = {
            calculateNextReview: function(easeFactor, repetitions, quality) {
                if (quality < 0 || quality > 5) throw new Error('Ú©ÛŒÙÛŒØª Ø¨Ø§ÛŒØ¯ Ø¨ÛŒÙ† Û° ØªØ§ Ûµ Ø¨Ø§Ø´Ø¯');
                
                if (quality < 3) {
                    return {
                        interval: 1,
                        repetitions: 0,
                        easeFactor: Math.max(1.3, easeFactor - 0.2)
                    };
                }

                let interval;
                if (repetitions === 0) interval = 1;
                else if (repetitions === 1) interval = 6;
                else interval = Math.round((repetitions) * easeFactor); // Ø§ØµÙ„Ø§Ø­: repetitions Ù†Ù‡ repetitions-1

                let newEase = easeFactor + (0.1 - (5 - quality) * (0.08 + (5 - quality) * 0.02));
                newEase = Math.max(1.3, Math.min(2.5, newEase));

                return {
                    interval: interval,
                    repetitions: repetitions + 1,
                    easeFactor: newEase
                };
            }
        };

        // ------------------------------------------------------------
        // Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ÛŒ ØªØ³Øª Ø¯Ø³ØªÛŒ
        // ------------------------------------------------------------
        function runScenario1() {
            let state = { easeFactor: 2.5, repetitions: 0, interval: 0 };
            let log = 'âœ… Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Û±: Ûµ Ø¨Ø§Ø± Ù…Ø±ÙˆØ± Ø¨Ø§ Ú©ÛŒÙÛŒØª Ûµ\n\n';
            
            for (let i = 1; i <= 5; i++) {
                const result = SRS.calculateNextReview(state.easeFactor, state.repetitions, 5);
                log += `Ù…Ø±ÙˆØ± ${i}: ÙØ§ØµÙ„Ù‡=${result.interval} Ø±ÙˆØ², EF=${result.easeFactor.toFixed(3)}, ØªÚ©Ø±Ø§Ø±=${result.repetitions}\n`;
                state = result;
            }
            
            document.getElementById('result1').innerText = log;
            console.log(log);
        }

        function runScenario2() {
            let state = { easeFactor: 2.5, repetitions: 2, interval: 6 };
            let log = 'ğŸ“‰ Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Û²: Ú©Ø§Ù‡Ø´ Ú©ÛŒÙÛŒØª Ø¯Ø± Ù…Ø±ÙˆØ± Ø³ÙˆÙ…\n\n';
            
            log += `Ù…Ø±ÙˆØ± Û± (Ú©ÛŒÙÛŒØª Ûµ): ÙØ§ØµÙ„Ù‡=Û¶, EF=Û².Ûµ, ØªÚ©Ø±Ø§Ø±=Û²\n`;
            
            let r2 = SRS.calculateNextReview(state.easeFactor, state.repetitions, 5);
            log += `Ù…Ø±ÙˆØ± Û² (Ú©ÛŒÙÛŒØª Ûµ): ÙØ§ØµÙ„Ù‡=${r2.interval}, EF=${r2.easeFactor.toFixed(3)}, ØªÚ©Ø±Ø§Ø±=${r2.repetitions}\n`;
            
            let r3 = SRS.calculateNextReview(r2.easeFactor, r2.repetitions, 2);
            log += `Ù…Ø±ÙˆØ± Û³ (Ú©ÛŒÙÛŒØª Û²): ÙØ§ØµÙ„Ù‡=${r3.interval}, EF=${r3.easeFactor.toFixed(3)}, ØªÚ©Ø±Ø§Ø±=${r3.repetitions} âš ï¸ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Û±\n`;
            
            document.getElementById('result2').innerText = log;
        }

        function runScenario3() {
            let log = 'ğŸ”„ Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Û³: Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙØ§ØµÙ„Ù‡ ØªØµØ§Ø¹Ø¯ÛŒ (Ø¨Ø§ EF=Û².Ûµ)\n\n';
            let intervals = [];
            let state = { easeFactor: 2.5, repetitions: 0, interval: 0 };
            
            for (let i = 1; i <= 7; i++) {
                const result = SRS.calculateNextReview(state.easeFactor, state.repetitions, 5);
                intervals.push(result.interval);
                log += `Ù…Ø±ÙˆØ± ${i}: ÙØ§ØµÙ„Ù‡=${result.interval} Ø±ÙˆØ², EF=${result.easeFactor.toFixed(3)}\n`;
                state = result;
            }
            
            log += `\nğŸ“ˆ Ø¯Ù†Ø¨Ø§Ù„Ù‡ ÙÙˆØ§ØµÙ„: ${intervals.join(' â†’ ')}`;
            log += `\nâœ… ØªØ£ÛŒÛŒØ¯: ÙÙˆØ§ØµÙ„ Ø¨Ù‡ ØµÙˆØ±Øª ØªØµØ§Ø¹Ø¯ÛŒ Ø§ÙØ²Ø§ÛŒØ´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ù†Ø¯`;
            
            document.getElementById('result3').innerText = log;
        }

        function runScenario4() {
            let log = 'ğŸ§ª Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Û´: ØªØ£Ø«ÛŒØ± Ú©ÛŒÙÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø¨Ø± EF\n\n';
            log += 'Ú©ÛŒÙÛŒØª | EF Ø¬Ø¯ÛŒØ¯ | ØªÙˆØ¶ÛŒØ­\n';
            log += 'â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
            
            for (let quality = 0; quality <= 5; quality++) {
                const result = SRS.calculateNextReview(2.5, 2, quality);
                const emoji = quality >= 4 ? 'ğŸŸ¢' : quality >= 3 ? 'ğŸŸ¡' : 'ğŸ”´';
                log += `  ${quality}   â”‚  ${result.easeFactor.toFixed(3)}  â”‚ ${emoji} ${quality < 3 ? 'ÙØ§ØµÙ„Ù‡=Û±' : 'Ø§ÙØ²Ø§ÛŒØ´ EF'}\n`;
            }
            
            document.getElementById('result4').innerText = log;
        }
    </script>
</body>
</html>
