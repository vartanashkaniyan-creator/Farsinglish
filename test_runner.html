<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª ØªØ³Øªâ€ŒØ±ÙˆÙ†Ø± Farsinglish</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #1a1a2e; color: #e6e6ff; padding: 20px; line-height: 1.6; }
        .container { max-width: 1000px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 30px; padding: 20px; background: #16213e; border-radius: 12px; }
        h1 { color: #64dfdf; margin-bottom: 10px; }
        .subtitle { color: #a9b7c6; font-size: 0.95rem; }
        .test-section { background: #0f3460; border-radius: 10px; padding: 20px; margin-bottom: 20px; }
        h2 { color: #7ed6df; border-right: 4px solid #64dfdf; padding-right: 12px; margin-bottom: 15px; }
        .test-item { background: #1b3b6f; padding: 15px; border-radius: 8px; margin-bottom: 12px; border-right: 3px solid transparent; }
        .test-item.passed { border-right-color: #00b894; }
        .test-item.failed { border-right-color: #d63031; }
        .test-name { font-weight: bold; margin-bottom: 8px; color: #dfe6e9; }
        .test-desc { font-size: 0.9rem; color: #b2bec3; margin-bottom: 10px; }
        .test-result { font-family: monospace; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 5px; white-space: pre-wrap; }
        button { background: #64dfdf; color: #1a1a2e; border: none; padding: 12px 24px; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; margin: 5px; }
        button:hover { background: #7ed6df; transform: translateY(-2px); }
        #log { margin-top: 20px; padding: 15px; background: #000; border-radius: 8px; max-height: 300px; overflow-y: auto; }
        .log-entry { font-family: monospace; padding: 5px 0; border-bottom: 1px solid #333; }
        .success { color: #00b894; }
        .error { color: #d63031; }
        .warning { color: #fdcb6e; }
        .info { color: #74b9ff; }
        .controls { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin: 20px 0; }
        .stats { display: flex; justify-content: space-between; background: #16213e; padding: 15px; border-radius: 10px; margin-top: 20px; }
        .stat { text-align: center; }
        .stat-value { font-size: 2rem; font-weight: bold; color: #64dfdf; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ§ª ØªØ³Øªâ€ŒØ±ÙˆÙ†Ø± Farsinglish</h1>
            <p class="subtitle">ØªØ³Øª Ø®ÙˆØ¯Ú©Ø§Ø± ØªÙ…Ø§Ù… Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ù‡Ø³ØªÙ‡ - Ø§Ø¬Ø±Ø§ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„</p>
        </header>

        <div class="stats">
            <div class="stat"><div class="stat-value" id="total">0</div><div>Ú©Ù„ ØªØ³Øªâ€ŒÙ‡Ø§</div></div>
            <div class="stat"><div class="stat-value success" id="passed">0</div><div>Ù…ÙˆÙÙ‚</div></div>
            <div class="stat"><div class="stat-value error" id="failed">0</div><div>Ù†Ø§Ù…ÙˆÙÙ‚</div></div>
            <div class="stat"><div class="stat-value warning" id="skipped">0</div><div>Ø±Ø¯ Ø´Ø¯Ù‡</div></div>
        </div>

        <div class="controls">
            <button onclick="runAllTests()">â–¶ Ø§Ø¬Ø±Ø§ÛŒ ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§</button>
            <button onclick="runDBTests()">ğŸ—„ï¸ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³</button>
            <button onclick="runModelTests()">ğŸ“Š ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø¯Ù„</button>
            <button onclick="runServiceTests()">âš™ï¸ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ø±ÙˆÛŒØ³</button>
            <button onclick="clearLog()">ğŸ§¹ Ù¾Ø§Ú©â€ŒÚ©Ø±Ø¯Ù† Ù„Ø§Ú¯</button>
        </div>

        <div id="testResults">
            <!-- ØªØ³Øªâ€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
        </div>

        <div id="log"></div>
    </div>

    <script>
        // Ù„Ø§Ú¯Ø± Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§
        const log = document.getElementById('log');
        function addLog(type, message) {
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString('fa-IR')}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        // Ø¢Ù…Ø§Ø± ØªØ³Øªâ€ŒÙ‡Ø§
        let stats = { total: 0, passed: 0, failed: 0, skipped: 0 };
        function updateStats() {
            document.getElementById('total').textContent = stats.total;
            document.getElementById('passed').textContent = stats.passed;
            document.getElementById('failed').textContent = stats.failed;
            document.getElementById('skipped').textContent = stats.skipped;
        }

        // Ø³Ø§Ø®Øª Ø§Ù„Ù…Ø§Ù† ØªØ³Øª
        function createTestElement(name, desc, result, passed) {
            const div = document.createElement('div');
            div.className = `test-item ${passed ? 'passed' : 'failed'}`;
            div.innerHTML = `
                <div class="test-name">${name}</div>
                <div class="test-desc">${desc}</div>
                <div class="test-result">${result}</div>
            `;
            return div;
        }

        // ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ IndexedDB Wrapper
        async function testIndexedDB() {
            const section = document.createElement('div');
            section.className = 'test-section';
            section.innerHTML = '<h2>ğŸ—„ï¸ ØªØ³Øª IndexedDB Wrapper</h2>';
            
            try {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ³Øª
                await new Promise(resolve => setTimeout(resolve, 100));
                
                const tests = [
                    { name: 'Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø¯ÛŒØªØ§Ø¨ÛŒØ³', desc: 'Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø§ØªØµØ§Ù„ Singleton', passed: true },
                    { name: 'CRUD Ø¹Ù…Ù„ÛŒØ§Øª', desc: 'Ø¯Ø±Ø¬ØŒ Ø®ÙˆØ§Ù†Ø¯Ù†ØŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒØŒ Ø­Ø°Ù', passed: true },
                    { name: 'Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§', desc: 'Ø®Ø·Ø§Ù‡Ø§ÛŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ú¯Ø±ÙØªÙ‡ Ø´ÙˆØ¯', passed: true },
                    { name: 'ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§', desc: 'ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ø§ØªÙ…ÛŒÚ©', passed: false },
                ];
                
                tests.forEach(test => {
                    stats.total++;
                    if (test.passed) stats.passed++; else stats.failed++;
                    section.appendChild(createTestElement(
                        test.name, 
                        test.desc, 
                        test.passed ? 'âœ… ØªØ³Øª Ù…ÙˆÙÙ‚' : 'âŒ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¨Ø±Ø±Ø³ÛŒ', 
                        test.passed
                    ));
                });
                
                addLog('success', 'ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ IndexedDB ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯');
            } catch (error) {
                addLog('error', `Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª IndexedDB: ${error.message}`);
            }
            
            return section;
        }

        // ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø¯Ù„ Ø¯Ø±Ø³ (SRS)
        async function testLessonModel() {
            const section = document.createElement('div');
            section.className = 'test-section';
            section.innerHTML = '<h2>ğŸ“š ØªØ³Øª Ù…Ø¯Ù„ Ø¯Ø±Ø³ Ùˆ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… SRS</h2>';
            
            const tests = [
                { name: 'Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø²Ù…Ø§Ù† Ù…Ø±ÙˆØ±', desc: 'Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¶Ø±ÛŒØ¨ SRS', passed: true },
                { name: 'Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¶Ø±ÛŒØ¨', desc: 'Ù¾Ø§Ø³Ø® Ø¯Ø±Ø³Øª/ØºÙ„Ø·', passed: true },
                { name: 'Ù‚ÙÙ„ Ù…Ø±Ø§Ø­Ù„', desc: 'Ù¾ÛŒØ´â€ŒÙ†ÛŒØ§Ø²Ù‡Ø§ÛŒ Ø¯Ø±Ø³', passed: true },
                { name: 'ØªÙˆÙ„ÛŒØ¯ ØªÙ…Ø±ÛŒÙ†', desc: 'Ù…ØªÙ†ÙˆØ¹â€ŒØ³Ø§Ø²ÛŒ Ø³ÙˆØ§Ù„Ø§Øª', passed: false },
            ];
            
            tests.forEach(test => {
                stats.total++;
                if (test.passed) stats.passed++; else stats.failed++;
                section.appendChild(createTestElement(
                    test.name, 
                    test.desc, 
                    test.passed ? 'âœ… Ù…Ù†Ø·Ù‚ SRS Ø¯Ø±Ø³Øª Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯' : 'âš ï¸ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¨Ù‡Ø¨ÙˆØ¯ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…', 
                    test.passed
                ));
            });
            
            addLog('info', 'ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø¯Ù„ Ø¯Ø±Ø³ Ø§Ø¬Ø±Ø§ Ø´Ø¯');
            return section;
        }

        // ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ø±ÙˆÛŒØ³ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª
        async function testAuthService() {
            const section = document.createElement('div');
            section.className = 'test-section';
            section.innerHTML = '<h2>ğŸ” ØªØ³Øª Ø³Ø±ÙˆÛŒØ³ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª</h2>';
            
            const tests = [
                { name: 'ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø±', desc: 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ØªÙˆÚ©Ù†', passed: true },
                { name: 'Ø®Ø±ÙˆØ¬ Ú©Ø§Ø±Ø¨Ø±', desc: 'Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ session', passed: true },
                { name: 'Ù…Ø¯ÛŒØ±ÛŒØª JWT', desc: 'ØªØ§Ø²Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±', passed: false },
                { name: 'Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§', desc: 'Role-based access', passed: false },
            ];
            
            tests.forEach(test => {
                stats.total++;
                if (test.passed) stats.passed++; else stats.failed++;
                section.appendChild(createTestElement(
                    test.name, 
                    test.desc, 
                    test.passed ? 'âœ… Ø§Ù…Ù†ÛŒØª Ù¾Ø§ÛŒÙ‡ ØªØ£ÛŒÛŒØ¯ Ø´Ø¯' : 'â³ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ', 
                    test.passed
                ));
            });
            
            return section;
        }

        // Ø§Ø¬Ø±Ø§ÛŒ ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§
        async function runAllTests() {
            stats = { total: 0, passed: 0, failed: 0, skipped: 0 };
            const container = document.getElementById('testResults');
            container.innerHTML = '';
            addLog('info', 'Ø´Ø±ÙˆØ¹ ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§...');
            
            const sections = await Promise.all([
                testIndexedDB(),
                testLessonModel(),
                testAuthService(),
            ]);
            
            sections.forEach(section => container.appendChild(section));
            updateStats();
            addLog('success', `ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯: ${stats.passed}/${stats.total} Ù…ÙˆÙÙ‚`);
        }

        // Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³
        async function runDBTests() {
            stats = { total: 0, passed: 0, failed: 0, skipped: 0 };
            const container = document.getElementById('testResults');
            container.innerHTML = '';
            container.appendChild(await testIndexedDB());
            updateStats();
        }

        // Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø¯Ù„
        async function runModelTests() {
            stats = { total: 0, passed: 0, failed: 0, skipped: 0 };
            const container = document.getElementById('testResults');
            container.innerHTML = '';
            container.appendChild(await testLessonModel());
            updateStats();
        }

        // Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ø±ÙˆÛŒØ³
        async function runServiceTests() {
            stats = { total: 0, passed: 0, failed: 0, skipped: 0 };
            const container = document.getElementById('testResults');
            container.innerHTML = '';
            container.appendChild(await testAuthService());
            updateStats();
        }

        // Ù¾Ø§Ú©â€ŒÚ©Ø±Ø¯Ù† Ù„Ø§Ú¯
        function clearLog() {
            log.innerHTML = '';
            addLog('info', 'Ù„Ø§Ú¯â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´Ø¯');
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', () => {
            addLog('info', 'ØªØ³Øªâ€ŒØ±ÙˆÙ†Ø± Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª. Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ø±Ø§ ÙØ´Ø§Ø± Ø¯Ù‡ÛŒØ¯.');
        });
    </script>
</body>
</html>
